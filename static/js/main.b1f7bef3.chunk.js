(window["webpackJsonphidden-leaf-rl"]=window["webpackJsonphidden-leaf-rl"]||[]).push([[0],{123:function(e,t,r){e.exports=r(268)},128:function(e,t,r){},268:function(e,t,r){"use strict";r.r(t);var n=r(5),a=r.n(n),c=r(71),i=r.n(c),o=(r(128),r(0)),s=r(1),u=r(3),l=r(2),p=r(4),h=(r(74),r(8)),f=r(122),g=r.n(f),y={TITLE:0,LEVEL:1},b=r(11),d=r(10),m=r.n(d),v=r(16),O=r(12),j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return new Promise(function(t){return setTimeout(t,e)})},k=function(e){return e[Math.floor(Math.random()*e.length)]},w=function(e){return"".concat(e.x,",").concat(e.y)},P=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4,a=e.map,c=function(e,t){return!!a[e+","+t]&&"GROUND"===a[e+","+t].type},i=new O.e.AStar(t.x,t.y,c,{topology:n}),o=[];return i.compute(r.x,r.y,function(e,t){o.push({x:e,y:t})}),o.slice(1)},A=function(e,t,r,n,a){return P(e,t,r,n).slice(0,a+1)},x=function(e){var t=Object.keys(e),r=k(t).split(",");return{coordinates:{x:parseInt(r[0]),y:parseInt(r[1])},text:r}},E=function(e){return e.filter(function(e){return e.hasOwnProperty("durability")})},D=function(e){return 2/3*(Math.pow(e,3)-9*Math.pow(e,2)+32*e-18)},S=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,n=D(r),a=[],c=0;c<n;c++){var i=Math.round(e+Math.cos(2*Math.PI/n*c)*r),o=Math.round(t+Math.sin(2*Math.PI/n*c)*r);a.push({x:i,y:o})}return a},C=r(9),T=r(28),N=r(7),I=r(29),M=r.n(I),R=r(13),L=r.n(R),q=function(e){if(e.energy=0,e.pos){var t=e.game.map[w(e.pos)];e.game.map[w(e.pos)].entities=t.entities.filter(function(t){return t.id!==e.id})}e.game.engine.actors=e.game.engine.actors.filter(function(t){return t.id!==e.id}),e.game.engine.removeStatusEffectByActorId(e.id),e.game.draw(),e.game.engine.currentActor=e.game.engine.currentActor%e.game.engine.actors.length},_="#424242",B="#606b79",G={GROUND:{background:_,foreground:B,character:".",passable:!0},WALL:{background:_,foreground:B,character:"#",passable:!1},WATER:{animation:[{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#8aa",character:"\u2592",passable:!1},{background:"#424242",foreground:"#8aa",character:"\u2593",passable:!1}],background:"#9dc3d3",character:"\u2591",passable:!1},WIN:{background:"white",foreground:"black",character:"W",passable:!0}},W={Power:{type:"Power",name:"Rin",description:"Strength of mind, body, spirit"},Energy:{type:"Energy",name:"Pyo",description:"energy direction"},Harmony:{type:"Harmony",name:"To",description:"one- ness with the universe or self"},Healing:{type:"Healing",name:"Sha",description:"of self and others"},Intuition:{type:"Intuition",name:"Kai",description:"premonition of danger, feeling others intent"},Awareness:{type:"Awareness",name:"Jin",description:"feeling thoughts of others, perhaps hiding your own"},Dimension:{type:"Dimension",name:"Retsu",description:"control of time and space"},Creation:{type:"Creation",name:"Zai",description:"understanding nature"},Absolute:{type:"Absolute",name:"Zen",description:"enlightenment"}},F={N:[0,-1],NE:[1,-1],W:[-1,0],NW:[-1,-1],SW:[-1,1],S:[0,1],SE:[1,1],E:[1,0],NONE:[0,0]},H={HEAD:"HEAD",TORSO:"TORSO",BACK:"BACK",HAND:"HAND",FEET:"FEET"},U={human:function(){return[{type:H.HEAD,name:"head",item:null},{type:H.TORSO,name:"torso",item:null},{type:H.BACK,name:"back",item:null},{type:H.HAND,name:"left_hand",item:null},{type:H.HAND,name:"right_hand",item:null},{type:H.FEET,name:"feet",item:null}]}},K={verticalLine:{x_offset:1,y_offset:1,positions:[{x:0,y:0,taken:!1},{x:0,y:1,taken:!1},{x:0,y:-1,taken:!1}]},smallSquare:{x_offset:1,y_offset:1,positions:[{x:0,y:0,taken:!1},{x:0,y:1,taken:!1},{x:1,y:1,taken:!1},{x:1,y:0,taken:!1}]},square:{x_offset:2,y_offset:2,positions:[{x:0,y:0,taken:!1},{x:0,y:1,taken:!1},{x:1,y:1,taken:!1},{x:1,y:0,taken:!1},{x:1,y:-1,taken:!1},{x:0,y:-1,taken:!1},{x:-1,y:-1,taken:!1},{x:-1,y:0,taken:!1},{x:-1,y:1,taken:!1}]},bigSquare:{x_offset:2,y_offset:2,positions:[{x:0,y:0,taken:!1},{x:0,y:1,taken:!1},{x:1,y:1,taken:!1},{x:1,y:0,taken:!1},{x:1,y:-1,taken:!1},{x:0,y:-1,taken:!1},{x:-1,y:-1,taken:!1},{x:-1,y:0,taken:!1},{x:-1,y:1,taken:!1},{x:0,y:1,taken:!1},{x:2,y:2,taken:!1},{x:2,y:0,taken:!1},{x:2,y:-2,taken:!1},{x:0,y:-2,taken:!1},{x:-2,y:-2,taken:!1},{x:-2,y:0,taken:!1},{x:-2,y:2,taken:!1}]},circle:{x_offset:0,y_offset:0,positions:[].concat(Object(b.a)(S(0,0,2)),Object(b.a)(S(0,0,3)))}},V={default:{renderer:{character:"*",color:"black",background:"white"}},fail:{renderer:{character:"x",color:"black",background:"red"}},damage:{renderer:{character:"*",color:"darkred",background:"red"}},leaf:{renderer:{character:"\u2724",color:"#36635b",background:"#F0D8C0"}}},z={directional:0,path:1},J=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],Y=r(23);function Q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function X(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Q(r,!0).forEach(function(t){Object(h.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var Z=function(){function e(t){var r=t.game,n=t.actor,a=t.energyCost,c=void 0===a?100:a,i=t.processDelay,s=void 0===i?50:i,u=t.particles,l=void 0===u?[]:u,p=t.particleTemplate,h=void 0===p?V.default:p,f=t.onBefore,g=void 0===f?function(){return null}:f,y=t.onAfter,b=void 0===y?function(){return null}:y,d=t.onSuccess,m=void 0===d?function(){return null}:d,v=t.onFailure,O=void 0===v?function(){return null}:v;Object(o.a)(this,e),this.actor=n,this.game=r,this.energyCost=c,this.processDelay=s,this.particles=l,this.particleTemplate=h,this.onBefore=g,this.onAfter=b,this.onSuccess=m,this.onFailure=O}return Object(s.a)(e,[{key:"addParticle",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:X({},this.particleTemplate.renderer),a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:z.directional,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,i=new Fe({game:this.game,name:"particle",passable:!0,life:e,pos:t,direction:r,energy:100,renderer:n,type:a,path:c});this.particles.push(i)}},{key:"removeDeadParticles",value:function(){this.particles=this.particles.filter(function(e){return e.life>0})}},{key:"perform",value:function(){return console.log("".concat(this.actor.name," performs")),this.actor.energy-=this.energyCost,{success:!0,alternative:null}}}]),e}(),$=function(e){function t(e){var r,n=e.effect,a=e.processDelay,c=void 0===a?0:a,i=Object(N.a)(e,["effect","processDelay"]);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,X({},i)))).effect=n,r.processDelay=c,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"perform",value:function(){var e=this,t=this.game.engine.addStatusEffect(this.effect);return S(this.actor.pos.x,this.actor.pos.y,2).forEach(function(t){e.addParticle(5,X({},t),{x:Math.sign(t.x-e.actor.pos.x),y:Math.sign(t.y-e.actor.pos.y)})}),t&&(this.actor.energy-=this.energyCost),{success:t,alternative:null}}}]),t}(Z),ee=function(e){function t(e){var r,n=e.message,a=e.processDelay,c=void 0===a?50:a,i=Object(N.a)(e,["message","processDelay"]);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,X({},i)))).message=n,r.processDelay=c,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"perform",value:function(){return console.log("".concat(this.actor.name," says ").concat(this.message)),this.actor.energy-=this.energyCost,{success:!0,alternative:null}}}]),t}(Z),te=function(e){function t(e){var r,n=e.item,a=Object(N.a)(e,["item"]);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,X({},a)))).item=n,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"perform",value:function(){var e=!1;if(this.item.equipmentType){var t=this.actor.getItemInSlot(this.item.equipmentType);t&&(this.actor.addToContainer(t),this.actor.unequip(t)),this.actor.removeFromContainer(this.item),this.actor.equip(this.item.equipmentType,this.item),console.log("".concat(this.actor.name," equips ").concat(this.item.name,".")),e=!0}return this.actor.energy-=this.energyCost,{success:e,alternative:null}}}]),t}(Z),re=function(e){function t(e){var r,n=e.item,a=Object(N.a)(e,["item"]);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,X({},a)))).item=n,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"perform",value:function(){return console.log("".concat(this.actor.name," puts ").concat(this.item.name," away.")),this.actor.unequip(this.item),this.actor.addToContainer(this.item),this.actor.energy-=this.energyCost,{success:!0,alternative:null}}}]),t}(Z),ne=function(e){function t(e){var r,n=e.item,a=Object(N.a)(e,["item"]);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,X({},a)))).item=n,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"perform",value:function(){return console.log("".concat(this.actor.name," drops ").concat(this.item.name,".")),this.actor.removeFromContainer(this.item),this.game.map[w(this.actor.pos)].entities.push(this.item),this.actor.energy-=this.energyCost,{success:!0,alternative:null}}}]),t}(Z),ae=function(e){function t(e){var r,n=e.item,a=Object(N.a)(e,["item"]);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,X({},a)))).item=n,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"perform",value:function(){var e=this;console.log("".concat(this.actor.name," picks up ").concat(this.item.name,".")),this.actor.addToContainer(this.item);var t=this.game.map[w(this.actor.pos)].entities;return this.game.map[w(this.actor.pos)].entities=t.filter(function(t){return t.id!==e.item.id}),this.actor.energy-=this.energyCost,{success:!0,alternative:null}}}]),t}(Z),ce=function(e){function t(e){var r,n=e.processDelay,a=void 0===n?0:n,c=Object(N.a)(e,["processDelay"]);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,X({},c)))).processDelay=a,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"perform",value:function(){return this.actor.energy-=this.energyCost,this.actor.destroy(),{success:!0,alternative:null}}}]),t}(Z),ie=function(e){function t(e){var r,n=e.cloneArgs,a=void 0===n?[]:n,c=Object(N.a)(e,["cloneArgs"]);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,X({},c)))).cloneArgs=a,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"perform",value:function(){var e=!1;return this.actor.createClone(this.cloneArgs)&&(e=!0,this.actor.energy-=this.energyCost,console.log("".concat(this.actor.name," is cloning itself"))),{success:e,alternative:null}}}]),t}(Z),oe=function(e){function t(e){var r,n=e.chargeAmount,a=Object(N.a)(e,["chargeAmount"]);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,X({},a)))).chargeAmount=n,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"perform",value:function(){return console.log("".concat(this.actor.name," is charging up!")),this.actor.energy-=this.energyCost,this.actor.increaseCharge(this.chargeAmount),{success:!0,alternative:null}}}]),t}(Z),se=function(e){function t(e){var r,n=e.sign,a=Object(N.a)(e,["sign"]);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,X({},a)))).sign=n,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"perform",value:function(){return console.log("".concat(this.actor.name," threw a ").concat(this.sign.name," sign.")),this.actor.addSign(this.sign),this.actor.energy-=this.energyCost,{success:!0,alternative:null}}}]),t}(Z),ue=function(e){function t(e){var r,n=e.requiredSequence,a=void 0===n?[]:n,c=Object(N.a)(e,["requiredSequence"]);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,X({},c)))).requiredSequence=a,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"requiredSequenceIsFulfilled",value:function(){var e=this.actor.signHistory.concat(),t=e.slice(Math.max(e.length-this.requiredSequence.length,0));return JSON.stringify(t)===JSON.stringify(this.requiredSequence)}},{key:"perform",value:function(){var e=!1;return this.requiredSequenceIsFulfilled()&&(console.log("".concat(this.actor.name," is releasing the power of ").concat(this.requiredSequence.map(function(e){return e.type}).join(" and "),"!")),this.actor.energy-=this.energyCost,e=!0,this.actor.clearSigns()),{success:e,alternative:null}}}]),t}(Z),le=function(e){function t(e){var r,n=e.targetPos,a=e.processDelay,c=void 0===a?0:a,i=Object(N.a)(e,["targetPos","processDelay"]);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,X({},i)))).targetPos=n,r.processDelay=c,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"perform",value:function(){var e=this,t=!1;if(this.game.cursorCanOccupyPosition(this.targetPos)){var r=this.game.map[w(this.actor.pos)];this.game.map[w(this.actor.pos)]=X({},r,{entities:r.entities.filter(function(t){return t.id!==e.actor.id})}),this.actor.pos=this.targetPos,this.game.map[w(this.targetPos)].entities.push(this.actor),t=!0}return{success:t,alternative:null}}}]),t}(Z),pe=function(e){function t(e){var r,n=e.targetPositions,a=void 0===n?[]:n,c=Object(N.a)(e,["targetPositions"]);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,X({},c)))).targetPositions=a,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"perform",value:function(){var e=this,t=!1;return console.log("actor ",this.actor.pos),this.targetPositions.forEach(function(r){if(console.log("target ",r),e.game.canOccupyPosition(r,e.entity)){var n=Object(Y.cloneDeep)(e.entity);n.game=e.game,n.id=M()(),n.pos=r,e.game.placeActorOnMap(n)&&(t=!0)}}),t&&(this.actor.energy-=this.energyCost),{success:t,alternative:null}}}]),t}(function(e){function t(e){var r,n=e.targetPos,a=e.entity,c=e.processDelay,i=void 0===c?25:c,s=Object(N.a)(e,["targetPos","entity","processDelay"]);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,X({},s)))).targetPos=n,r.processDelay=i,r.entity=a,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"perform",value:function(){var e=!1;return this.game.canOccupyPosition(this.targetPos,this.entity)&&(this.entity.pos=this.targetPos,e=this.game.placeActorOnMap(this.entity)),e&&(this.actor.energy-=this.energyCost),{success:e,alternative:null}}}]),t}(Z)),he=function(e){function t(e){var r,n=e.targetPos,a=e.processDelay,c=void 0===a?25:a,i=Object(N.a)(e,["targetPos","processDelay"]);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,X({},i)))).targetPos=n,r.processDelay=c,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"perform",value:function(){var e=!1,t=null;return this.actor.move(this.targetPos)?(this.actor.energy-=this.energyCost,e=!0):(e=!0,t=new de({targetPos:this.targetPos,game:this.game,actor:this.actor,energyCost:100})),{success:e,alternative:t}}}]),t}(Z),fe=function(e){function t(e){var r,n=e.targetPos,a=e.damageToSelf,c=void 0===a?1:a,i=e.processDelay,s=void 0===i?25:i,p=Object(N.a)(e,["targetPos","damageToSelf","processDelay"]);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,X({},p)))).targetPos=n,r.processDelay=s,r.damageToSelf=c,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"perform",value:function(){var e=!1,t=null;return this.actor.move(this.targetPos)?(this.actor.energy-=this.energyCost,e=!0):(e=!0,t=new me({targetPos:this.targetPos,game:this.game,actor:this.actor,energyCost:100,damageToSelf:this.damageToSelf})),{success:e,alternative:t}}}]),t}(Z),ge=function(e){function t(e){var r,n=e.direction,a=e.stepCount,c=e.processDelay,i=void 0===c?25:c,s=Object(N.a)(e,["direction","stepCount","processDelay"]);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,X({},s)))).direction=n,r.stepCount=a,r.processDelay=i,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"perform",value:function(){var e=!1,t=null,r={x:this.actor.pos.x+this.direction[0],y:this.actor.pos.y+this.direction[1]};return this.stepCount>0&&this.actor.move(r)?(this.stepCount-=1,this.actor.energy-=this.energyCost,this.actor.setNextAction(this),e=!0):(e=!0,t=new de({targetPos:r,game:this.game,actor:this.actor,energyCost:100})),{success:e,alternative:t}}}]),t}(Z),ye=function(e){function t(e){var r,n=e.targetPos,a=e.direction,c=Object(N.a)(e,["targetPos","direction"]);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,X({},c)))).targetPos=n,r.direction=a,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"perform",value:function(){var e=!1,t=null;return this.actor.shove(this.targetPos,this.direction)?(this.actor.energy-=this.energyCost,e=!0):(e=!0,t=new de({targetPos:this.targetPos,game:this.game,actor:this.actor,energyCost:100})),{success:e,alternative:t}}}]),t}(Z),be=function(e){function t(e){var r,n=e.direction,a=e.stepCount,c=e.additionalAttackDamage,i=void 0===c?0:c,s=e.processDelay,p=void 0===s?25:s,h=Object(N.a)(e,["direction","stepCount","additionalAttackDamage","processDelay"]);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,X({},h)))).direction=n,r.stepCount=a,r.additionalAttackDamage=i,r.processDelay=p,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"perform",value:function(){var e=!1,t={x:this.actor.pos.x+this.direction[0],y:this.actor.pos.y+this.direction[1]};if(this.stepCount>0&&this.actor.shove(t,this.direction)){this.stepCount-=1,this.actor.energy-=this.energyCost,this.actor.setNextAction(this);for(var r=0;r<3;r++)this.addParticle(1,{x:this.actor.pos.x-this.direction[0]*r,y:this.actor.pos.y-this.direction[1]*r},{x:0,y:0});e=!0}else e=!0,this.actor.attack(t,this.additionalAttackDamage);return{success:e,alternative:null}}}]),t}(ge),de=function(e){function t(e){var r,n=e.targetPos,a=e.processDelay,c=void 0===a?100:a,i=Object(N.a)(e,["targetPos","processDelay"]);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,X({},i)))).targetPos=n,r.processDelay=c,r.particleTemplate=V.damage,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"perform",value:function(){var e;return this.actor.entityTypes.includes("ATTACKING")?((e=this.actor.attack(this.targetPos))&&(this.addParticle(1,X({},this.targetPos),{x:0,y:0}),this.actor.energy-=this.energyCost),{success:e,alternative:null}):{success:!0,alternative:new ee({message:"Ooh I don't know how to attack",game:this.game,actor:this.actor})}}}]),t}(Z),me=function(e){function t(e){var r,n=e.damageToSelf,a=Object(N.a)(e,["damageToSelf"]);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,X({},a)))).damageToSelf=n,r.onSuccess=function(){return r.actor.decreaseDurabilityWithoutDefense(n)},r.onFailure=function(){return r.actor.destroy()},r}return Object(p.a)(t,e),t}(de),ve=function(e){function t(e){var r,n=e.targetPositions,a=e.processDelay,c=void 0===a?25:a,i=Object(N.a)(e,["targetPositions","processDelay"]);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,X({},i)))).targetPositions=n,r.processDelay=c,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"perform",value:function(){var e=this,t=!1;if(!this.actor.entityTypes.includes("ATTACKING"))return{success:!0,alternative:new ee({message:"Ooh I don't know how to attack",game:this.game,actor:this.actor})};var r=[],n={x:this.actor.pos.x,y:this.actor.pos.y},a=this.particleTemplate.renderer;return this.targetPositions.forEach(function(n){var a=e.actor.attack(n);r.push(n),a&&(t=!0)}),this.addParticle(r.length+1,n,null,a,z.path,r),t&&(this.actor.energy-=this.energyCost),{success:t,alternative:null}}}]),t}(Z),Oe=function(e){function t(e){var r=Object(T.a)({},e);return Object(o.a)(this,t),Object(u.a)(this,Object(l.a)(t).call(this,X({},r)))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"perform",value:function(){var e=!1,r=null;this.actor.passable=!1;var n=Object(C.a)(Object(l.a)(t.prototype),"perform",this).call(this);(n.success&&(this.actor.path.shift(),e=!0),0===this.actor.path.length&&(e=!0,r=new ce({game:this.game,actor:this.actor,energyCost:100,processDelay:0})),n.alternative)&&(this.actor.attack(this.targetPos)&&(r=new ce({game:this.game,actor:this.actor,energyCost:100,processDelay:0})));return{success:e,alternative:r}}}]),t}(he),je=function(e){function t(e){var r,n=Object(T.a)({},e);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,X({},n)))).processDelay=0,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"perform",value:function(){var e=!1,r=null;this.actor.passable=!1;var n=Object(C.a)(Object(l.a)(t.prototype),"perform",this).call(this);return n.success&&(this.actor.path.shift(),e=!0),0===this.actor.path.length&&(e=!0,r=new ce({game:this.game,actor:this.actor,energyCost:100,processDelay:0})),n.alternative&&this.actor.attack(this.targetPos),{success:e,alternative:r}}}]),t}(he),ke=function(e){function t(e){var r,n=e.engine,a=Object(N.a)(e,["engine"]);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,X({},a)))).engine=n,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"perform",value:function(){var e=Object(v.a)(m.a.mark(function e(){var t,r;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=!0,r=null,console.log("".concat(this.actor.name," is cranking its engine.")),e.prev=3,e.next=6,this.engine.start();case 6:this.actor.energy-=this.energyCost,e.next=14;break;case 9:e.prev=9,e.t0=e.catch(3),console.log("CrankEngine"),console.log(e.t0),r=new ce({game:this.game,actor:this.actor,energyCost:100});case 14:return e.abrupt("return",{success:t,alternative:r});case 15:case"end":return e.stop()}},e,this,[[3,9]])}));return function(){return e.apply(this,arguments)}}()}]),t}(Z);function we(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Pe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?we(r,!0).forEach(function(t){Object(h.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):we(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var Ae=function e(t){var r=t.game,n=void 0===r?null:r,a=t.passable,c=void 0!==a&&a;Object(o.a)(this,e);var i=M()();this.entityTypes=["Entity"],this.id=i,this.game=n,this.passable=c},xe=function(e){return function(e){function t(e){var r,n=e.children,a=void 0===n?[]:n,c=e.engine,i=void 0===c?new Ht({}):c,s=Object(N.a)(e,["children","engine"]);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,Pe({},s)))).entityTypes=r.entityTypes.concat("PARENT"),r.children=a,r.engine=i,r.isInitialized=!1,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"destroyChild",value:function(e){e.energy=0;var t=this.game.map[w(e.pos)];this.game.map[w(e.pos)].entities=t.entities.filter(function(t){return t.id!==e.id}),this.engine.actors=this.engine.actors.filter(function(t){return t.id!==e.id}),this.game.draw()}},{key:"canAttack",value:function(e){return!this.children.map(function(e){return e.id}).includes(e.id)}},{key:"initialize",value:function(){var e=this;this.isInitialized=!0,this.engine.game=this.game,this.engine.actors=this.children,this.engine.actors.forEach(function(t){t.game=e.game,t.destroy=function(){e.destroyChild(t)},t.canAttack=e.canAttack.bind(e),e.game.placeActorOnMap(t),e.engine.addActor(t),e.game.draw()})}},{key:"getAction",value:function(e){return this.isInitialized||this.initialize(),new ke({game:e,actor:this,engine:this.engine,energyCost:100,processDelay:10})}}]),t}(e)},Ee=function(e){return function(e){function t(e){var r,n=e.attackDamage,a=void 0===n?1:n,c=Object(N.a)(e,["attackDamage"]);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,Pe({},c)))).entityTypes=r.entityTypes.concat("ATTACKING"),r.attackDamage=a,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"getAttackDamage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.attackDamage+e}},{key:"canAttack",value:function(e){return!0}},{key:"attack",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=!1,n=this.game.map[w(e)];if(!n)return r;var a=E(n.entities);if(a.length>0){var c=a[0];if(this.canAttack(c)){var i=this.getAttackDamage(t);this.entityTypes.includes("EQUIPING")&&this.equipment.forEach(function(e){e.item&&e.item.entityTypes.includes("ATTACKING")&&(i+=e.item.getAttackDamage())}),console.log("".concat(this.name," does ").concat(i," to ").concat(c.name)),c.decreaseDurability(i),r=!0}}return r}}]),t}(e)},De=function(e){return function(e){function t(e){var r,n=e.name,a=e.actions,c=void 0===a?[]:a,i=e.speed,s=void 0===i?100:i,p=(e.energy,Object(N.a)(e,["name","actions","speed","energy"]));return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,Pe({},p)))).entityTypes=r.entityTypes.concat("ACTING"),r.name=n,r.actions=c,r.speed=s,r.energy=s,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"getAction",value:function(){var e=k(this.actions);if(e)return e}},{key:"gainEnergy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.speed;this.energy+=e}},{key:"hasEnoughEnergy",value:function(){return this.energy>0}}]),t}(e)},Se=function(e){return function(e){function t(e){var r,n=e.pos,a=void 0===n?{x:0,y:0}:n,c=e.renderer,i=Object(N.a)(e,["pos","renderer"]);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,Pe({},i)))).entityTypes=r.entityTypes.concat("RENDERING"),r.pos=a,r.renderer=Pe({},c),r.currentFrame=0,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"getPosition",value:function(){return this.pos}},{key:"move",value:function(e){var t=this,r=!1;if(this.game.canOccupyPosition(e,this)){var n=this.game.map[w(this.pos)];this.game.map[w(this.pos)]=Pe({},n,{entities:n.entities.filter(function(e){return e.id!==t.id})}),this.pos=e,this.game.map[w(e)].entities.push(this),r=!0}return r}},{key:"shove",value:function(e,t){var r=this.game.map[w(e)];return r&&r.entities.map(function(e){if(!e.passable){var r={x:e.pos.x+t[0],y:e.pos.y+t[1]};e.move(r)}}),this.move(e)}}]),t}(e)},Ce=function(e){return function(e){function t(e){var r,n=e.keymap,a=void 0===n?{}:n,c=Object(N.a)(e,["keymap"]);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,Pe({},c)))).entityTypes=r.entityTypes.concat("PLAYING"),r.nextAction=null,r.keymap=a,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"setNextAction",value:function(e){this.nextAction=e}},{key:"getAction",value:function(){var e=this.nextAction;return this.nextAction=null,e}}]),t}(e)},Te=function(e){return function(e){function t(e){var r,n=e.targetEntity,a=void 0===n?null:n,c=Object(N.a)(e,["targetEntity"]);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,Pe({},c)))).entityTypes=r.entityTypes.concat("CHASING"),r.targetEntity=a,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"getAction",value:function(e){var t=P(e,this.targetEntity.pos,this.pos),r=t.length>0?t[0]:this.pos;return new he({targetPos:r,game:e,actor:this,energyCost:100})}}]),t}(e)},Ne=function(e){return function(e){function t(e){var r,n=e.durability,a=void 0===n?1:n,c=e.defense,i=void 0===c?0:c,s=e.onDestroy,p=void 0===s?function(){return null}:s,h=Object(N.a)(e,["durability","defense","onDestroy"]);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,Pe({},h)))).entityTypes=r.entityTypes.concat("DESTRUCTABLE"),r.durability=a,r.defense=i,r.onDestroy=p,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"getDefense",value:function(){return this.defense}},{key:"decreaseDurabilityWithoutDefense",value:function(e){this.durability-=e,this.durability<=0&&this.destroy()}},{key:"decreaseDurability",value:function(e){var t=this.durability,r=t-(e-this.getDefense());this.durability=Math.min(t,r),this.durability<=0&&this.destroy()}},{key:"increaseDurability",value:function(e){this.durability+=e}},{key:"destroy",value:function(){this.onDestroy(),q(this)}}]),t}(e)},Ie=L()(De,Se,Ce,function(e){return function(e){function t(e){var r,n=e.initiatedBy,a=void 0===n?null:n,c=Object(N.a)(e,["initiatedBy"]);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,Pe({},c)))).entityTypes=r.entityTypes.concat("UI"),r.initiatedBy=a,r.active=!0,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"hasEnoughEnergy",value:function(){return this.active}}]),t}(e)})(Ae),Me=(L()(De,Se)(Ae),L()(Se,Ne)(Ae)),Re=L()(De,Se,function(e){return function(e){function t(e){var r,n=e.path,a=void 0!==n&&n,c=e.direction,i=void 0===c?{x:0,y:0}:c,s=e.range,p=void 0===s?3:s,h=Object(N.a)(e,["path","direction","range"]);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,Pe({},h)))).entityTypes=r.entityTypes.concat("DIRECTIONAL_PUSHING"),r.path=a,r.direction=i,r.range=p,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"getAction",value:function(e){var t=this,r={x:this.pos.x+this.direction[0],y:this.pos.y+this.direction[1]};return this.passable=!1,this.range>0?new ye({targetPos:r,direction:this.direction,game:e,actor:this,energyCost:100,onSuccess:function(){return t.range-=1}}):new ce({game:e,actor:this,energyCost:0})}}]),t}(e)},Ne)(Ae),Le=(L()(De,Se,Te,Ne)(Ae),L()(De,Se,Te,Ne,Ee)(Ae)),qe=L()(De,Se,function(e){return function(e){function t(e){var r,n=e.charge,a=void 0===n?10:n,c=Object(N.a)(e,["charge"]);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,Pe({},c)))).entityTypes=r.entityTypes.concat("CHARGING"),r.charge=a,r.chargeMax=a,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"decreaseCharge",value:function(e){this.charge=Math.max(0,this.charge-e)}},{key:"increaseCharge",value:function(e){this.charge=Math.min(this.chargeMax,this.charge+e)}}]),t}(e)},function(e){return function(e){function t(e){var r,n=Object(T.a)({},e);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,Pe({},n)))).entityTypes=r.entityTypes.concat("SIGNING"),r.signHistory=[],r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"addSign",value:function(e){this.signHistory.length>=4&&this.signHistory.shift(),this.signHistory.push(e)}},{key:"clearSigns",value:function(){this.signHistory=[]}}]),t}(e)},function(e){return function(e){function t(e){var r,n=e.container,a=void 0===n?[]:n,c=Object(N.a)(e,["container"]);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,Pe({},c)))).entityTypes=r.entityTypes.concat("CONTAINING"),r.container=a,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"contains",value:function(e){var t=this.container.filter(function(t){return t.name===e});return t.length>0&&t[0]}},{key:"addToContainer",value:function(e){this.container.push(e)}},{key:"removeFromContainer",value:function(e){this.container=this.container.filter(function(t){return t.id!==e.id})}}]),t}(e)},function(e){return function(e){function t(e){var r,n=e.equipment,a=void 0===n?U.human():n,c=Object(N.a)(e,["equipment"]);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,Pe({},c)))).entityTypes=r.entityTypes.concat("EQUIPING"),r.equipment=a,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"getItemInSlot",value:function(e){if(this.equipment.filter(function(t){return null===t.item&&t.type===e}).length>0)return!1;var t=this.equipment.find(function(t){return t.type===e});return!!t&&(!!t.item&&t.item)}},{key:"equip",value:function(e,t){var r=!1;this.equipment=this.equipment.map(function(n){return r||n.type!==e||null!==n.item||(n.item=t,r=!0),n})}},{key:"unequip",value:function(e){this.equipment=this.equipment.map(function(t){return t.item&&t.item.id===e.id&&(t.item=null),t})}}]),t}(e)},Ee,function(e){return function(e){function t(e){var r,n=e.currentGate,a=void 0===n?null:n,c=(e.gates,Object(N.a)(e,["currentGate","gates"]));return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,Pe({},c)))).entityTypes=r.entityTypes.concat("HAS_INNER_GATES"),r.currentGate=a,r.gates=[{name:"Gate of Opening",damageBuff:1,speedBuff:100,durabilityDebuff:1,character:"1"},{name:"Gate of Healing",damageBuff:1,speedBuff:100,durabilityDebuff:1,character:"2"},{name:"Gate of Life",damageBuff:1,speedBuff:100,durabilityDebuff:1,character:"3"},{name:"Gate of Pain",damageBuff:1,speedBuff:100,durabilityDebuff:1,character:"4"},{name:"Gate of Limit",damageBuff:1,speedBuff:100,durabilityDebuff:1,character:"5"}],r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"setNextGate",value:function(){var e=this.currentGate,t=null;if(e){var r=this.gates.findIndex(function(t){return e.name===t.name})+1;console.log("next gate index ",r),this.gates.length>r&&(t=this.gates[r],this.currentGate=Pe({},t))}else t=this.gates[0],this.currentGate=Pe({},t);return t}},{key:"getNextGate",value:function(){var e=this.currentGate,t=null;if(e){var r=this.gates.findIndex(function(t){return e.name===t.name})+1;console.log("next gate index ",r),this.gates.length>r&&(t=this.gates[r])}else t=this.gates[0];return t}}]),t}(e)},Ne,function(e){return function(e){function t(e){var r,n=e.cloneLimit,a=void 0===n?1:n,c=Object(N.a)(e,["cloneLimit"]);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,Pe({},c)))).entityTypes=r.entityTypes.concat("CLONING"),r.cloneLimit=a,r.clones=[],r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"destroy",value:function(){this.clones&&this.clones.map(function(e){q(e)}),q(this)}},{key:"destroyClone",value:function(e){var t=this.clones.findIndex(function(t){return t.id==e});t>=0&&(this.clones[t].super__destroy(),this.clones.splice(t,1))}},{key:"createClone",value:function(e){var t=this;if(this.clones.length<this.cloneLimit){var r=Object(Y.cloneDeep)(this);if(r.name+=" Clone ".concat(this.clones.length),r.game=this.game,r.id=M()(),delete r.clones,r.super__destroy=r.destroy,r.destroy=function(){t.destroyClone(r.id)},e.forEach(function(e){r[e.attribute]=e.value}),this.game.placeActorOnMap(r))return this.game.engine.addActorAsNext(r),this.game.draw(),this.clones.push(r),!0}return!1}}]),t}(e)},Ce)(Ae),_e=L()(Se,function(e){return function(e){function t(e){var r,n=e.name,a=void 0===n?"nameless":n,c=e.equipmentType,i=void 0===c?H.HAND:c,s=Object(N.a)(e,["name","equipmentType"]);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,Pe({},s)))).entityTypes=r.entityTypes.concat("EQUIPABLE"),r.name=a,r.equipmentType=i,r}return Object(p.a)(t,e),t}(e)},Ee)(Ae),Be=L()(De,Se,Ee,function(e){return function(e){function t(e){var r,n=e.path,a=void 0!==n&&n,c=e.targetPos,i=void 0===c?null:c,s=e.attackDamage,p=void 0===s?1:s,h=e.range,f=void 0===h?3:h,g=Object(N.a)(e,["path","targetPos","attackDamage","range"]);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,Pe({},g)))).entityTypes=r.entityTypes.concat("DESTRUCTIVE_PROJECTING"),r.path=a,r.targetPos=i,r.attackDamage=p,r.range=f,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"createPath",value:function(e){var t=A(e,this.targetPos,this.pos,8,this.range);this.path=t}},{key:"getAction",value:function(e){this.path||this.createPath(e);var t=this.path.length>0?this.path[0]:this.pos;return new Oe({targetPos:t,game:e,actor:this,energyCost:100})}}]),t}(e)},Ne)(Ae),Ge=L()(De,Se,Ee,function(e){return function(e){function t(e){var r,n=e.path,a=void 0!==n&&n,c=e.direction,i=void 0===c?{x:0,y:0}:c,s=e.attackDamage,p=void 0===s?1:s,h=e.range,f=void 0===h?3:h,g=Object(N.a)(e,["path","direction","attackDamage","range"]);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,Pe({},g)))).entityTypes=r.entityTypes.concat("DIRECTIONAL_PROJECTING"),r.path=a,r.direction=i,r.attackDamage=p,r.range=f,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"getAction",value:function(e){var t=this,r={x:this.pos.x+this.direction[0],y:this.pos.y+this.direction[1]};return this.passable=!1,this.range>0?new fe({targetPos:r,game:e,actor:this,energyCost:100,damageToSelf:1,onSuccess:function(){return t.range-=1}}):new ce({game:e,actor:this,energyCost:0})}}]),t}(e)},Ne)(Ae),We=(L()(De,Se,Ee,function(e){return function(e){function t(e){var r,n=e.owner_id,a=void 0===n?null:n,c=e.path,i=void 0!==c&&c,s=e.targetPos,p=void 0===s?null:s,h=e.attackDamage,f=void 0===h?1:h,g=e.range,y=void 0===g?3:g,b=Object(N.a)(e,["owner_id","path","targetPos","attackDamage","range"]);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,Pe({},b)))).entityTypes=r.entityTypes.concat("GASEOUS_DESTRUCTIVE_PROJECTING"),r.path=i,r.targetPos=p,r.attackDamage=f,r.range=y,r.owner_id=a,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"canAttack",value:function(e){var r=Object(C.a)(Object(l.a)(t.prototype),"canAttack",this).call(this);return r&&(r=null===this.owner_id||e.owner_id!==this.owner_id),r}},{key:"createPath",value:function(e){var t=A(e,this.targetPos,this.pos,8,this.range);this.path=t}},{key:"getAction",value:function(e){this.path||this.createPath(e);var t=this.path.length>0?this.path[0]:this.pos;return new je({targetPos:t,game:e,actor:this,energyCost:100})}}]),t}(e)},Ne,function(e){return function(e){function t(e){var r,n=e.isClone,a=void 0!==n&&n,c=e.cloneCount,i=void 0===c?0:c,s=e.clonePattern,p=void 0===s?K.square:s,h=Object(N.a)(e,["isClone","cloneCount","clonePattern"]);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,Pe({},h)))).entityTypes=r.entityTypes.concat("GASEOUS"),r.isClone=a,r.cloneCount=i,r.clonePattern=Object(Y.cloneDeep)(p),r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"getAction",value:function(e){var r=this.clonePattern.positions.find(function(e){return!e.taken});if(!this.isClone&&r){r.taken=!0;var n=Object(Y.cloneDeepWith)(this,function(e,t){switch(t){case"id":case"game":case"engine":case"clones":return null;default:return}});if(n.game=e,n.id=M()(),this.hasOwnProperty("pos")){var a=this.pos;n.pos={x:a.x+r.x,y:a.y+r.y}}n.hasOwnProperty("path")&&(n.path=n.path.map(function(e){return{x:e.x+r.x,y:e.y+r.y}})),n.isClone=!0,this.cloneCount+=1,e.placeActorOnMap(n),e.engine.addActor(n),e.draw()}return Object(C.a)(Object(l.a)(t.prototype),"getAction",this).call(this,e)}}]),t}(e)})(Ae),L()(De,Ne,xe)(Ae)),Fe=L()(De,Se,function(e){return function(e){function t(e){var r,n=e.pos,a=void 0===n?{x:1,y:1}:n,c=e.direction,i=void 0===c?{x:0,y:0}:c,s=e.life,p=void 0===s?1:s,h=e.speed,f=void 0===h?1:h,g=e.type,y=void 0===g?z.directional:g,b=e.path,d=void 0===b?null:b,m=Object(N.a)(e,["pos","direction","life","speed","type","path"]);return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,Pe({},m)))).pos=a,r.direction=i,r.life=p,r.speed=f,r.type=y,r.path=d,r.entityTypes=r.entityTypes.concat("PARTICLE"),r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"getNextPos",value:function(e){switch(this.type){case z.directional:return{x:this.pos.x+this.direction.x*this.speed*e,y:this.pos.y+this.direction.y*this.speed*e};case z.path:var t=this.path.shift();return Pe({},t||this.pos)}}},{key:"update",value:function(e){this.life-=e,this.life>0&&(this.pos=this.getNextPos(e))}}]),t}(e)})(Ae),He=(L()(De,Ne,xe)(Ae),"Kunai"),Ue="Directional Kunai",Ke="Sword",Ve="Barrier",ze=function(e){return function(e){var t=e.engine,r=(e.actor,e.targetPos),n=e.speed,a=e.structureType,c=e.createProjectile,i=K[a],o=i.positions.map(function(e){var n={x:r.x+e.x+i.x_offset,y:r.y+e.y+i.y_offset},a={x:r.x,y:r.y};return c(t,n,a)});return new We({game:t.game,passable:!0,speed:n,children:o})}({engine:e.engine,actor:e.actor,targetPos:e.targetPos,speed:100,structureType:"circle",createProjectile:Qe})},Je=function(e,t,r){return new Be({game:e.game,targetPos:r,passable:!0,pos:{x:t.x,y:t.y},renderer:{character:">",color:"white",background:"",animation:[{background:"",foreground:"white",character:">"},{background:"",foreground:"white",character:"v"},{background:"",foreground:"white",character:"<"},{background:"",foreground:"white",character:"^"},{background:"",foreground:"white",character:">"}]},name:He,speed:600,energy:0,range:30})},Ye=function(e,t,r,n){return new Re({game:e.game,passable:!1,pos:{x:t.x,y:t.y},targetPos:r,renderer:{character:"]",color:"#A89078",background:"#D8C0A8"},name:He,durability:3,range:n,speed:300})},Qe=function(e,t,r){return new Be({game:e.game,targetPos:r,passable:!0,pos:{x:t.x,y:t.y},renderer:{character:"\u2726\ufe0f",color:"#A89078",background:"#D8C0A8"},name:He,speed:600,energy:0,range:30})},Xe=function(e){return new _e({game:e.game,name:Ke,passable:!0,attackDamage:1,equipmentType:H.HAND,renderer:{character:"\ud83d\udde1\ufe0f",color:"white",background:""}})},Ze=function(e,t){var r=J.filter(function(t){return!Object.keys(e).includes(t)});e[r[0]]=t},$e=function(e,t){var r=e.actors[e.currentActor];e.game.removeActor(r),e.game[t]=null},et=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"move";return{w:{activate:function(){return e(F.N,t)},label:"".concat(r," N")},e:{activate:function(){return e(F.NE,t)},label:"".concat(r," NE")},d:{activate:function(){return e(F.E,t)},label:"".concat(r," E")},c:{activate:function(){return e(F.SE,t)},label:"".concat(r," SE")},x:{activate:function(){return e(F.S,t)},label:"".concat(r," S")},z:{activate:function(){return e(F.SW,t)},label:"".concat(r," SW")},a:{activate:function(){return e(F.W,t)},label:"".concat(r," W")},q:{activate:function(){return e(F.NW,t)},label:"".concat(r," NW")}}};function tt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function rt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?tt(r,!0).forEach(function(t){Object(h.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tt(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var nt=function(e){var t=e.actors[e.currentActor];e.game.visibleInventory=t.container;var r=new Ie({initiatedBy:t,pos:rt({},t.pos),renderer:{character:"D",color:"white",background:""},name:"Drop",game:e.game});e.addActorAsPrevious(r),e.game.placeActorOnMap(r),e.game.draw(),r.keymap=function(e,t){var r={Escape:{activate:function(){return $e(e,"visibleInventory")},label:"Close"}};return t.container.map(function(n,a){var c={activate:null,label:""};return c.activate=function(){console.log("setting action for ".concat(t.name," to drop ").concat(n.name)),t.setNextAction(new ne({item:n,game:e.game,actor:t,energyCost:100})),$e(e,"visibleInventory")},c.label="Drop ".concat(n.name),Ze(r,c),!0}),r}(e,t)};function at(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function ct(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?at(r,!0).forEach(function(t){Object(h.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):at(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var it=function(e){var t=e.actors[e.currentActor];e.game.visibleEquipment=t.equipment;var r=new Ie({initiatedBy:t,pos:ct({},t.pos),renderer:{character:"E",color:"white",background:""},name:"Equipment",game:e.game});e.addActorAsPrevious(r),e.game.placeActorOnMap(r),e.game.draw(),r.keymap=function(e,t){var r={Escape:{activate:function(){return $e(e,"visibleEquipment")},label:"Close"}};return t.equipment.filter(function(e){return e.item}).map(function(n){var a={activate:null,label:""};return a.activate=function(){console.log("setting action for ".concat(t.name," to unequip ").concat(n.item.name)),t.setNextAction(new re({item:n.item,game:e.game,actor:t})),$e(e,"visibleEquipment")},a.label="Unequip ".concat(n.name),Ze(r,a),!0}),r}(e,t)};function ot(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function st(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ot(r,!0).forEach(function(t){Object(h.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ot(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var ut=function(e){var t=e.actors[e.currentActor];e.game.visibleInventory=t.container;var r=new Ie({initiatedBy:t,pos:st({},t.pos),renderer:{character:"I",color:"white",background:""},name:"Inventory",game:e.game});e.addActorAsPrevious(r),e.game.placeActorOnMap(r),e.game.draw(),r.keymap=function(e,t){var r={Escape:{activate:function(){return $e(e,"visibleInventory")},label:"Close"}};return t.container.map(function(n,a){var c={activate:null,label:""};return c.activate=function(){console.log("setting action for ".concat(t.name," to equip ").concat(n.name)),t.setNextAction(new te({item:n,game:e.game,actor:t})),$e(e,"visibleInventory")},c.label="Equip ".concat(n.name),Ze(r,c),!0}),r}(e,t)};function lt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}var pt=function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?lt(r,!0).forEach(function(t){Object(h.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lt(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},et(function(e,r){return function(e,t,r){var n=t.actors[t.currentActor];n.active=!1;var a=Math.sign(n.pos.x-r.pos.x),c=Math.sign(n.pos.y-r.pos.y);t.game.removeActor(n);var i=r.contains(Ue);i?(i.game=t.game,i.pos={x:r.pos.x+a,y:r.pos.y+c},i.direction=e,r.removeFromContainer(i),t.addActorAsPrevious(i),t.game.placeActorsOnMap(),t.game.draw(),r.setNextAction(new ee({message:"I'll get you with this kunai!",game:t.game,actor:r,energyCost:100}))):console.log("I have no kunais left")}(e,r,t)},e,"throw"))},ht=function(e){var t=e.game,r=e.actors[t.engine.currentActor],n=r.pos,a=new Ie({initiatedBy:r,pos:n,renderer:{character:"\u2588",color:"white",background:""},name:"Cursor",game:t,keymap:pt(e,r)});e.addActorAsPrevious(a),e.game.placeActorOnMap(a),e.game.draw()},ft=function(e,t){var r=t.actors[t.currentActor],n=r.pos.x+e[0],a=r.pos.y+e[1];r.setNextAction(new he({targetPos:{x:n,y:a},game:t.game,actor:r,energyCost:100}))},gt=function(e){var t=e.engine.actors[e.engine.currentActor],r=x(e.map).coordinates,n=function(){var e=[{name:"Ross",renderer:{character:k(["\u25c9"]),color:"#ced5dd",background:""},durability:1,attackDamage:1,speed:100},{name:"Kevin",renderer:{character:k(["\u25c9"]),color:"#3fc072",background:""},durability:2,attackDamage:1,speed:100},{name:"Jacob",renderer:{character:k(["\u25c9"]),color:"#67a1d7",background:""},durability:3,attackDamage:1,speed:100},{name:"Jarod",renderer:{character:k(["\u25c9"]),color:"#e16264",background:""},durability:1,attackDamage:5,speed:300},{name:"Bigii",renderer:{character:k(["\u25c9"]),color:"#9f62e1",background:""},durability:15,attackDamage:10,speed:100}];return k(e)}(),a=new Le({targetEntity:t,pos:r,renderer:n.renderer,name:n.name,game:e,actions:[],attackDamage:n.attackDamage,durability:n.durability,speed:n.speed});e.randomlyPlaceActorOnMap(a)&&(e.engine.addActor(a),e.draw())},yt=function(e,t){var r=t.actors[t.currentActor],n=r.pos.x+e[0],a=r.pos.y+e[1];r.setNextAction(new le({targetPos:{x:n,y:a},game:t.game,actor:r,energyCost:0}))},bt=function(e){var t=e.actors[e.currentActor],r=e.game.map[w(t.pos)].entities.filter(function(e){return e.id!==t.id});r.length>0?t.setNextAction(new ae({item:k(r),game:e.game,actor:t,energyCost:100})):console.log("nothing to pickup.")},dt=function(e,t){var r=t.actors[t.currentActor];r.setNextAction(new se({sign:e,game:t.game,actor:r,energyCost:100}))};function mt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function vt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?mt(r,!0).forEach(function(t){Object(h.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mt(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var Ot=function(e,t,r){var n=Math.floor(50),a=Math.floor(t.energy/n)-1,c=a,i=function(){return t.keymap=r};return vt({Escape:{activate:i,label:"Close"}},function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"move";return{w:{activate:function(){return e(F.N,t)},label:"".concat(r," N")},d:{activate:function(){return e(F.E,t)},label:"".concat(r," E")},x:{activate:function(){return e(F.S,t)},label:"".concat(r," S")},a:{activate:function(){return e(F.W,t)},label:"".concat(r," W")}}}(function(e,t){!function(e,t,r,n,a){var c=a.actors[a.currentActor];c.setNextAction(new be({direction:e,stepCount:t,game:a.game,actor:c,additionalAttackDamage:n,energyCost:r,particleTemplate:V.leaf}))}(e,a,n,c,t),i()},e,"activate"))},jt=function e(t){var r=t.game,n=t.actor,a=t.name,c=void 0===a?"Effect":a,i=t.lifespan,s=void 0===i?100:i,u=t.stepInterval,l=void 0===u?100:u,p=t.allowDuplicates,h=void 0===p||p,f=t.onStart,g=void 0===f?function(){return null}:f,y=t.onStep,b=void 0===y?function(){return null}:y,d=t.onStop,m=void 0===d?function(){return null}:d;Object(o.a)(this,e),this.game=r,this.actor=n,this.name=c,this.lifespan=s,this.timeToLive=s,this.stepInterval=l,this.allowDuplicates=h,this.timeSinceLastStep=0,this.onStart=g,this.onStep=b,this.onStop=m},kt=function(e,t){var r=t.actors[t.currentActor],n=Object(b.a)(e);if(Math.random()<.5){console.log("drunk misstep");for(var a=100;e[0]===n[0]&&e[1]===n[1]||a<0;)a-=1,e=F[k(Object.keys(F))];console.log(a)}var c=r.pos.x+e[0],i=r.pos.y+e[1];r.setNextAction(new he({targetPos:{x:c,y:i},game:t.game,actor:r,energyCost:100}))};function wt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Pt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?wt(r,!0).forEach(function(t){Object(h.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wt(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function At(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function xt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?At(r,!0).forEach(function(t){Object(h.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):At(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var Et=function(e,t,r){var n=function(){var t=e.actors[e.currentActor];t.active=!1,e.game.removeActor(t)};return xt({Escape:{activate:n,label:"Close"}},et(yt,e),{k:{activate:function(){!function(e,t){var r=e.actors[e.currentActor],n=ze({engine:e,actor:t,targetPos:xt({},r.pos)});n&&(e.addActorAsNext(n),t.setNextAction(new ee({game:e.game,actor:t,message:"I'll crush you!",energyCost:100})))}(e,t),n()},label:"activate"}})};function Dt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}var St=function(e,t,r){var n=t.actors[t.currentActor];n.active=!1,t.game.removeActor(n);var a=Ye(t,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Dt(r,!0).forEach(function(t){Object(h.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Dt(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},r.pos),e,10);a?(a.game=t.game,a.direction=e,r.removeFromContainer(a),t.addActorAsPrevious(a),t.game.placeActorsOnMap(),t.game.draw(),r.setNextAction(new ee({message:"I'll get you with this kunai!",game:t.game,actor:r,energyCost:100}))):console.log("I have no kunais left")},Ct=function(e,t){return{w:{activate:function(){return St(F.N,e,t)},label:"throw N"},e:{activate:function(){return St(F.NE,e,t)},label:"throw NE"},d:{activate:function(){return St(F.E,e,t)},label:"throw E"},c:{activate:function(){return St(F.SE,e,t)},label:"throw SE"},x:{activate:function(){return St(F.S,e,t)},label:"throw S"},z:{activate:function(){return St(F.SW,e,t)},label:"throw SW"},a:{activate:function(){return St(F.W,e,t)},label:"throw W"},q:{activate:function(){return St(F.NW,e,t)},label:"throw NW"}}};function Tt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Nt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Tt(r,!0).forEach(function(t){Object(h.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Tt(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var It=function(e,t){return new Me({game:e.game,passable:!1,pos:{x:t.x,y:t.y},renderer:{character:"\u2726\ufe0f",color:"#A89078",background:"#D8C0A8"},name:Ve,durability:3})},Mt=function(e,t){var r=t.actors[t.currentActor],n=[];switch(function(e){var t="".concat(e),r=Object.keys(F),n=!1;return r.forEach(function(e){"".concat(F[e])===t&&(n=e)}),n}(e)){case"N":n=n.concat([{x:r.pos.x-1,y:r.pos.y-1},{x:r.pos.x,y:r.pos.y-1},{x:r.pos.x+1,y:r.pos.y-1}]);break;case"S":n=n.concat([{x:r.pos.x-1,y:r.pos.y+1},{x:r.pos.x,y:r.pos.y+1},{x:r.pos.x+1,y:r.pos.y+1}]);break;case"E":n=n.concat([{x:r.pos.x+1,y:r.pos.y-1},{x:r.pos.x+1,y:r.pos.y},{x:r.pos.x+1,y:r.pos.y+1}]);break;case"W":n=n.concat([{x:r.pos.x-1,y:r.pos.y-1},{x:r.pos.x-1,y:r.pos.y},{x:r.pos.x-1,y:r.pos.y+1}])}r.setNextAction(new pe({targetPositions:n,entity:It(t,Nt({},r.pos)),game:t.game,actor:r,energyCost:100}))},Rt=function(e){var t=e.actors[e.currentActor];t.keymap=function(e,t,r){var n=function(){return t.keymap=r};return{Escape:{activate:n,label:"Close"},w:{activate:function(){Mt(F.N,e),n()},label:"activate N"},d:{activate:function(){Mt(F.E,e),n()},label:"activate E"},s:{activate:function(){Mt(F.S,e),n()},label:"activate S"},a:{activate:function(){Mt(F.W,e),n()},label:"activate W"}}}(e,t,Nt({},t.keymap))},Lt=function(e){var t=e.actors[e.currentActor];t.setNextAction(new ee({message:"standing still...",game:e.game,actor:t,energyCost:100}))};function qt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function _t(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?qt(r,!0).forEach(function(t){Object(h.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qt(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var Bt=function(e){var t=new qe({pos:{x:23,y:7},renderer:{character:"R",color:"#e6e6e6",background:"#36635b"},name:"Rock Lee",actions:[],speed:400,durability:20,keymap:function(e){return _t({},et(ft,e),{s:{activate:function(){return Lt(e)},label:"stay"},l:{activate:function(){return function(e){var t=e.actors[e.currentActor];t.keymap=Ot(e,t,vt({},t.keymap))}(e)},label:"Flying Lotus"},k:{activate:function(){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:600,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=e.actors[e.currentActor],a=new jt({game:e.game,actor:n,name:"Removed wraps (weights)",lifespan:1e3,stepInterval:100,allowDuplicates:!1,onStart:function(){n.speed+=t,n.attackDamage=Math.max(0,n.attackDamage-r),n.energy+=t,n.renderer.character="\u3023",console.log("".concat(n.name," removed weighted wraps."))},onStop:function(){n.speed-=t,n.attackDamage+=r,n.renderer.character="R",console.log("".concat(n.name," rewrapped weights."))}});n.setNextAction(new $({effect:a,actor:n,game:e.game,particleTemplate:{renderer:{color:"#424242",background:"#e6e6e6",character:"\u3023"}}}))}(e,200)},label:"Remove wraps"},j:{activate:function(){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=e.actors[e.currentActor],n=new jt({game:e.game,actor:r,name:"Drunk",lifespan:1e3,stepInterval:100,allowDuplicates:!1,onStart:function(){r.attackDamage+=t,r.renderer.character="?",console.log("".concat(r.name," took a sip of sake.")),r.keymap.w={activate:function(){return kt(F.N,e)},label:"drunken walk"},r.keymap.a={activate:function(){return kt(F.W,e)},label:"drunken walk"},r.keymap.s={activate:function(){return kt(F.S,e)},label:"drunken walk"},r.keymap.d={activate:function(){return kt(F.E,e)},label:"drunken walk"}},onStop:function(){r.attackDamage-=t,r.renderer.character="R",console.log("".concat(r.name," recovered from drunkeness.")),r.keymap.w={activate:function(){return ft(F.N,e)},label:"walk"},r.keymap.a={activate:function(){return ft(F.W,e)},label:"walk"},r.keymap.s={activate:function(){return ft(F.S,e)},label:"walk"},r.keymap.d={activate:function(){return ft(F.E,e)},label:"walk"}}});r.setNextAction(new $({effect:n,actor:r,game:e.game,processDelay:100,particleTemplate:{renderer:{color:"#c45ffd",background:"#424242",character:"?"}}}))}(e)},label:"Sip Sake"},h:{activate:function(){return function(e){var t=e.actors[e.currentActor],r=[{x:t.pos.x-1,y:t.pos.y},{x:t.pos.x-1,y:t.pos.y-1},{x:t.pos.x,y:t.pos.y-1},{x:t.pos.x+1,y:t.pos.y-1},{x:t.pos.x+1,y:t.pos.y},{x:t.pos.x+1,y:t.pos.y+1},{x:t.pos.x,y:t.pos.y+1},{x:t.pos.x-1,y:t.pos.y+1}];t.setNextAction(new ve({targetPositions:r,game:e.game,actor:t,energyCost:800,particleTemplate:V.leaf}))}(e)},label:"Leaf Whirlwind"},g:{activate:function(){return function(e){var t=e.actors[e.currentActor],r=t.setNextGate();if(r){var n=new jt({game:e.game,actor:t,name:r.name,lifespan:-1,stepInterval:100,allowDuplicates:!1,onStart:function(){t.speed+=r.speedBuff,t.energy+=r.speedBuff,t.attackDamage+=r.damageBuff,t.renderer.character=r.character,console.log("".concat(t.name," opened the ").concat(r.name,".")),t.decreaseDurability(r.durabilityDebuff),t.decreaseDurability(0),console.log("".concat(t.name," suffers ").concat(r.durabilityDebuff," damage from physical stress."));var e=t.getNextGate();e?t.keymap.o.label=e.name:delete t.keymap.g}});t.setNextAction(new $({effect:n,actor:t,game:e.game,processDelay:25,particleTemplate:{renderer:{color:"#3cc2bb",background:"#24fe88",character:"#"}}}))}}(e)},label:"Gate of Opening"},i:{activate:function(){return ut(e)},label:"Open Inventory"},o:{activate:function(){return it(e)},label:"Open Equipment"},u:{activate:function(){return nt(e)},label:"Drop Item"},p:{activate:function(){return bt(e)},label:"Pickup"},t:{activate:function(){return ht(e)},label:"Throw"},y:{activate:function(){return gt(e.game)},label:"Add NPC"}})}(e)});return t.container=[].concat(Object(b.a)(Array(100).fill("").map(function(){return Je(e,_t({},t.pos))})),Object(b.a)(Array(100).fill("").map(function(){return function(e,t,r,n){return new Ge({game:e.game,direction:r,passable:!0,pos:{x:t.x,y:t.y},renderer:{character:">",color:"white",background:"",animation:[{background:"lightgrey",foreground:"grey",character:">"},{background:"lightgrey",foreground:"grey",character:"v"},{background:"lightgrey",foreground:"grey",character:"<"},{background:"lightgrey",foreground:"grey",character:"^"},{background:"lightgrey",foreground:"grey",character:">"}]},name:Ue,speed:600,energy:0,range:n})}(e,_t({},t.pos),null,10)}))),t};function Gt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Wt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Gt(r,!0).forEach(function(t){Object(h.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Gt(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var Ft=function(){function e(t){var r=t.statusEffects,n=void 0===r?[]:r,a=t.actors,c=void 0===a?[]:a,i=t.currentActor,s=void 0===i?0:i,u=t.isRunning,l=void 0!==u&&u,p=t.game,h=void 0===p?null:p;Object(o.a)(this,e),this.statusEffects=n,this.actors=c,this.currentActor=s,this.isRunning=l,this.game=h}return Object(s.a)(e,[{key:"processV1",value:function(){var e=Object(v.a)(m.a.mark(function e(){var t,r,n;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((t=this.actors[this.currentActor]).gainEnergy(t.speed),!t.hasEnoughEnergy()){e.next=18;break}if(r=t.getAction(this.game)){e.next=6;break}return e.abrupt("return",!1);case 6:return n=r.perform(),this.game.draw(),e.next=11,j(r.processDelay);case 11:if(n.success){e.next=13;break}return e.abrupt("return",!1);case 13:if(null!==n.alternative){e.next=15;break}return e.abrupt("break",18);case 15:r=n.alternative,e.next=6;break;case 18:return this.currentActor=(this.currentActor+1)%this.actors.length,e.abrupt("return",!0);case 20:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"processV2",value:function(){var e=Object(v.a)(m.a.mark(function e(){var t,r,n,a,c;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.actors[this.currentActor],r=!0;case 2:if(!r){e.next=38;break}if(t){e.next=5;break}return e.abrupt("return",!1);case 5:if(n=0,!t.hasEnoughEnergy()){e.next=34;break}if(a=t.getAction(this.game)){e.next=10;break}return e.abrupt("return",!1);case 10:n+=a.energyCost;case 11:return a.onBefore(),e.next=15,a.perform();case 15:return(c=e.sent).success?a.onSuccess():a.onFailure(),a.onAfter(),e.next=20,this.processActionFX(a,c.success);case 20:if(e.sent){e.next=24;break}return e.next=23,j(a.processDelay);case 23:this.game.draw();case 24:if(c.success){e.next=26;break}return e.abrupt("return",!1);case 26:if(null!==c.alternative){e.next=28;break}return e.abrupt("break",31);case 28:a=c.alternative,e.next=11;break;case 31:this.processStatusEffects(n),e.next=36;break;case 34:t.gainEnergy(t.speed),r=!1;case 36:e.next=2;break;case 38:return this.currentActor=(this.currentActor+1)%this.actors.length,e.abrupt("return",!0);case 40:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"processV3",value:function(){var e=Object(v.a)(m.a.mark(function e(){var t,r,n,a;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.actors[this.currentActor]){e.next=3;break}return e.abrupt("return",!1);case 3:if(r=0,!t.hasEnoughEnergy()){e.next=29;break}if(n=t.getAction(this.game)){e.next=8;break}return e.abrupt("return",!1);case 8:r+=n.energyCost;case 9:return e.next=12,n.perform();case 12:return a=e.sent,e.next=15,this.processActionFX(n,a.success);case 15:if(e.sent){e.next=19;break}return e.next=18,j(n.processDelay);case 18:this.game.draw();case 19:if(a.success){e.next=21;break}return e.abrupt("return",!1);case 21:if(null!==a.alternative){e.next=23;break}return e.abrupt("break",26);case 23:n=a.alternative,e.next=9;break;case 26:this.processStatusEffects(r),e.next=30;break;case 29:t.gainEnergy(t.speed);case 30:return this.currentActor=(this.currentActor+1)%this.actors.length,0===this.currentActor&&this.sortActorsByEnergy(),e.abrupt("return",!0);case 33:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"start",value:function(){var e=Object(v.a)(m.a.mark(function e(){var t;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.isRunning=!0;case 1:if(!this.isRunning){e.next=7;break}return e.next=4,this.processV2();case 4:this.isRunning=e.sent,e.next=1;break;case 7:if(t=this.actors[this.currentActor]){e.next=11;break}return this.game.backToTitle(),e.abrupt("return",!1);case 11:return t.keymap&&(this.game.visibleKeymap=t.keymap),this.game.updateMode(),e.next=15,this.game.updateReact(this.game);case 15:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){this.isRunning=!1}},{key:"sortActorsByEnergy",value:function(){this.actors=this.actors.sort(function(e,t){return t.energy-e.energy}),console.log(this.actors)}},{key:"addStatusEffect",value:function(e){return!e.allowDuplicates&&this.statusEffects.filter(function(t){return t.actor.id===e.actor.id&&t.name===e.name}).length>0?(console.log("".concat(e.name," cannot be applied twice to ").concat(e.actor.name)),!1):(e.onStart(),this.statusEffects.push(e),!0)}},{key:"removeStatusEffectById",value:function(e){this.statusEffects=this.statusEffects.filter(function(t){return t.id!==e||(t.onStop(),!1)})}},{key:"removeStatusEffectByActorId",value:function(e){this.statusEffects=this.statusEffects.filter(function(t){return t.actor.id!==e||(t.onStop(),!1)})}},{key:"removeDeadStatusEffects",value:function(){this.statusEffects=this.statusEffects.filter(function(e){return!(e.lifespan>=0&&e.timeToLive<=0)||(e.onStop(),!1)})}},{key:"processStatusEffects",value:function(e){this.statusEffects.forEach(function(t){t.timeSinceLastStep+=e,t.timeToLive-=e,t.timeSinceLastStep>=t.stepInterval&&(t.onStep(),t.timeSinceLastStep=0)}),this.removeDeadStatusEffects()}},{key:"processActionFX",value:function(){var e=Object(v.a)(m.a.mark(function e(t,r){var n,a=this;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=11;break}return n=new Fe({game:this.game,name:"particle",passable:!0,pos:Wt({},t.actor.pos),renderer:V.fail.renderer}),this.game.placeActorOnMap(n),this.game.draw(),e.next=6,j(100);case 6:return this.game.removeActorFromMap(n),n.update(1),this.game.draw(),t.removeDeadParticles(),e.abrupt("return",!0);case 11:if(!t.particles.length){e.next=23;break}case 12:if(!(t.particles.length>0)){e.next=22;break}return t.particles.forEach(function(e){a.game.placeActorOnMap(e)}),this.game.draw(),e.next=17,j(t.processDelay);case 17:t.particles.forEach(function(e){a.game.removeActorFromMap(e),e.update(1)}),this.game.draw(),t.removeDeadParticles(),e.next=12;break;case 22:return e.abrupt("return",!0);case 23:return e.abrupt("return",!1);case 24:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"addActor",value:function(e){this.actors.push(e)}},{key:"addActorAsPrevious",value:function(e){this.actors.splice(this.currentActor,0,e)}},{key:"addActorAsNext",value:function(e){this.actors.splice(this.currentActor+1,0,e)}},{key:"setActorToPrevious",value:function(e){this.currentActor-=1,this.currentActor<=-1&&(this.currentActor=this.actors.length-1)}},{key:"setActorToNext",value:function(e){this.currentActor=(this.currentActor+1)%this.actors.length}}]),e}(),Ht=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"process",value:function(){var e=Object(v.a)(m.a.mark(function e(){var t,r,n,a;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.actors[this.currentActor],r=!0;case 2:if(!r){e.next=26;break}if(!t.hasEnoughEnergy()){e.next=23;break}if(n=t.getAction(this.game)){e.next=7;break}return e.abrupt("return",!1);case 7:return this.game.draw(),e.next=11,n.perform();case 11:return a=e.sent,e.next=14,j(n.processDelay);case 14:if(a.success){e.next=16;break}return e.abrupt("return",!1);case 16:if(null!==a.alternative){e.next=18;break}return e.abrupt("break",21);case 18:n=a.alternative,e.next=7;break;case 21:e.next=24;break;case 23:r=!1;case 24:e.next=2;break;case 26:if(this.currentActor+=1,!(this.currentActor+1>=this.actors.length)){e.next=31;break}return this.currentActor=0,this.actors.forEach(function(e){return e.gainEnergy(e.speed)}),e.abrupt("return",!1);case 31:return e.abrupt("return",!0);case 32:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"start",value:function(){var e=Object(v.a)(m.a.mark(function e(){var t;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.isRunning=!0;case 1:if(!this.isRunning){e.next=7;break}return e.next=4,this.process();case 4:this.isRunning=e.sent,e.next=1;break;case 7:return(t=this.actors[this.currentActor]).keymap&&(this.game.visibleKeymap=t.keymap),this.game.updateMode(),e.next=12,this.game.updateReact(this.game);case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),t}(Ft);function Ut(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Kt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ut(r,!0).forEach(function(t){Object(h.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ut(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var Vt={WAVE:0},zt=function(){function e(t){var r=t.engine,n=void 0===r?null:r,a=t.map,c=void 0===a?{}:a,i=t.display,s=void 0===i?new O.b({width:90,fontSize:24,bg:"#424242"}):i,u=t.tileKey,l=void 0===u?G:u,p=t.mode,h=void 0===p?{type:Vt.WAVE,data:{level:1,highestLevel:null}}:p;Object(o.a)(this,e),this.engine=n,this.map=c,this.display=s,this.tileKey=l,this.mode=h}return Object(s.a)(e,[{key:"initializeMode",value:function(){if(this.mode.type===Vt.WAVE){var e=localStorage.getItem("hidden_leaf_rl__highestLevel");e=e?Math.max(e,this.mode.data.level):this.mode.data.level,localStorage.setItem("hidden_leaf_rl__highestLevel",e),this.mode.data.highestLevel=e;for(var t=0;t<Math.pow(this.mode.data.level,2);t++)gt(this)}}},{key:"updateMode",value:function(){this.mode.type===Vt.WAVE&&(this.engine.actors.filter(function(e){return!e.entityTypes.includes("PLAYING")}).length||(this.nextModeLevel(),this.initializeMode()))}},{key:"setModeLevel",value:function(e){this.mode.data.level=e}},{key:"nextModeLevel",value:function(){this.setModeLevel(this.mode.data.level+1)}},{key:"resetMode",value:function(){this.setModeLevel(1),this.initializeMode()}},{key:"randomlyPlaceActorOnMap",value:function(e){for(var t=0,r=!1;!r;){var n=x(this.map).coordinates;if(this.canOccupyPosition(n,e)){var a=this.map[w(n)];e.pos=Kt({},n),a.entities.push(e),r=!0}(t+=1)>=100&&(r=!0)}return r}},{key:"randomlyPlaceAllActorsOnMap",value:function(){var e=this;this.engine.actors.forEach(function(t){e.randomlyPlaceActorOnMap(t)})}},{key:"placeActorsOnMap",value:function(){var e=this;this.engine.actors.forEach(function(t){var r=e.map[w(t.pos)];r?r.entities.push(t):console.log("could not place ".concat(t.id,": ").concat(t.name," on map"))})}},{key:"placeActorOnMap",value:function(e){var t=this.map[w(e.pos)];return t?(t.entities.push(e),!0):(console.log("could not place ".concat(e.id,": ").concat(e.name," on map")),!1)}},{key:"removeActorFromMap",value:function(e){var t=this.map[w(e.pos)];return!!t&&(this.map[w(e.pos)].entities=t.entities.filter(function(t){return t.id!==e.id}),!0)}},{key:"createLevel",value:function(){var e=new O.d.Digger,t=[];e.create(function(e,r,n){var a,c,i=e+","+r,o="GROUND",s=0;n&&(o="WALL"),G[o].animation&&(a=0,c=G[o].animation.length,a=Math.ceil(a),c=Math.floor(c),s=Math.floor(Math.random()*(c-a))+a),this.map[i]={type:o,currentFrame:s,entities:[]},t.push(i)}.bind(this)),this.randomlyPlaceAllActorsOnMap()}},{key:"canOccupyPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{passable:!1},r=!1,n=this.map[w(e)];if(n){var a=n.entities.filter(function(e){return!e.passable}).length>0;if(!a||t.passable){var c=this.map[w(e)];this.tileKey[c.type].passable&&(r=!0)}}return r}},{key:"cursorCanOccupyPosition",value:function(e){var t=!1;return this.map[w(e)]&&(t=!0),t}},{key:"show",value:function(){document.getElementById("display").appendChild(this.display.getContainer())}},{key:"draw",value:function(){for(var e in this.map){var t=e.split(","),r=parseInt(t[0]),n=parseInt(t[1]),a=this.map[e],c=this.tileKey[a.type],i=c.character,o=c.foreground,s=c.background,u=this.tileKey[a.type],l=this.animateTile(a,u);if(i=l.character,o=l.foreground,s=l.background,a.entities.length>0){var p=a.entities[a.entities.length-1];i=(l=this.animateEntity(p)).character,o=l.foreground,l.background&&(s=l.background)}this.display.draw(r,n,i,o,s)}}},{key:"animateEntity",value:function(e){var t=e.renderer,r=Kt({},t),n=r.character,a=r.color,c=r.background;if(t.animation){var i=t.animation[e.currentFrame];n=i.character,a=i.foreground,c=i.background,e.currentFrame=(e.currentFrame+1)%t.animation.length}return{character:n,foreground:a,background:c}}},{key:"animateTile",value:function(e,t){var r=Kt({},t),n=r.character,a=r.foreground,c=r.background;if(t.animation){var i=t.animation[e.currentFrame];n=i.character,a=i.foreground,c=i.background,e.currentFrame=(e.currentFrame+1)%t.animation.length}return{character:n,foreground:a,background:c}}},{key:"addActor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.engine,r=this.placeActorOnMap(e);return!!r&&(t.actors.push(e),this.draw(),!0)}},{key:"placeAndDrawActor",value:function(e){this.placeActorsOnMap(),this.draw()}},{key:"removeActor",value:function(e){this.engine.actors=this.engine.actors.filter(function(t){return t.id!==e.id}),this.removeActorFromMap(e),this.draw()}},{key:"initialize",value:function(e){var t=this;this.engine.game=this,this.engine.actors.forEach(function(e){e.game=t}),this.show(),this.createLevel(),this.draw(),e.current.focus(),this.initializeMode()}}]),e}(),Jt=function(e,t){if(!t.isRunning){var r=t.actors[t.currentActor].keymap,n=e.key;if(!(n in r))return;r[n].activate(),t.start()}};var Yt=function(e){var t=e.color;return t||(t="grey"),a.a.createElement("button",{onClick:e.onClick,className:"Button btn ".concat(t," darken-3")},e.children)},Qt=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return a.a.createElement("div",{className:"Information UI"},a.a.createElement("div",{className:"flow-text"},"Information"),this.props.data&&this.props.data.map(function(e,t){return a.a.createElement(Yt,{key:t,color:e.color,onClick:function(){return null}},"".concat(e.label,": ").concat(e.value))}))}}]),t}(a.a.Component),Xt=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return a.a.createElement("div",{className:"Equipment UI"},this.props.equipment&&a.a.createElement("div",null,a.a.createElement("div",{className:"flow-text"},"Equipment"),a.a.createElement("div",null,this.props.equipment.map(function(e,t){return a.a.createElement(Yt,{key:t,onClick:function(){return null}},e.name," ",e.item?e.item.renderer.character:"")}))))}}]),t}(a.a.Component),Zt=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return a.a.createElement("div",{className:"Inventory UI"},this.props.inventory&&a.a.createElement("div",null,a.a.createElement("div",{className:"flow-text"},"Inventory"),a.a.createElement("div",null,this.props.inventory.map(function(e,t){return a.a.createElement(Yt,{key:t,onClick:function(){return null}},t," ",e.name," ",e.renderer.character)}))))}}]),t}(a.a.Component),$t=r(17),er=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return a.a.createElement("div",{className:"Keymap UI"},a.a.createElement("div",{className:"flow-text"},"Keymap"),this.props.keymap&&Object.entries(this.props.keymap).map(function(e,t){var r=Object($t.a)(e,2),n=r[0],c=r[1];return a.a.createElement(Yt,{key:t,onClick:function(){return null}},n," ",c.label)}))}}]),t}(a.a.Component),tr=function(e){function t(e){var r;Object(o.a)(this,t),r=Object(u.a)(this,Object(l.a)(t).call(this,e));var n=new Ft({}),c=r.props.selectedCharacter.initialize(n);n.actors.push(c);var i=new zt({engine:n});return r.state={game:i,activeTab:0},r.presserRef=a.a.createRef(),r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=Object(v.a)(m.a.mark(function e(){var t=this;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.state.game.initialize(this.presserRef),this.state.game.backToTitle=function(){return t.props.setActiveScreen(y.TITLE)},this.state.game.updateReact=function(e){t.setState({game:e})},this.state.game.engine.start();case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t,r,n=this,c=(this.state.game.engine.actors[this.state.game.engine.currentActor],[{label:"Wave",value:"Current: ".concat(this.state.game.mode.data.level,", Highest: ").concat(this.state.game.mode.data.highestLevel)}]);return c=c.concat(Object(b.a)(this.state.game.engine.actors.map(function(e,t){var r=Object(h.a)({label:e.name,value:t},"value","HP: ".concat(e.durability,", En/Sp: ").concat(e.energy,"/").concat(e.speed));return t===n.state.game.engine.currentActor&&(r.color="red"),r}))),a.a.createElement("div",{className:"Level"},a.a.createElement("div",{className:"flow-text"},"Chunin Exams"),a.a.createElement("button",{className:"btn",onClick:function(){return n.props.setActiveScreen(y.TITLE)}},"Quit"),a.a.createElement("div",{className:"row"},a.a.createElement("div",{className:"col s8 game_display_container"},(e=this.presserRef,t=Jt,r=this.state.game.engine,a.a.createElement("div",{id:"display",ref:e,onKeyDown:function(e){return t(e,r)},tabIndex:"0"})),a.a.createElement(Qt,{data:c})),a.a.createElement("div",{className:"col s2"},a.a.createElement(er,{keymap:this.state.game.visibleKeymap})),a.a.createElement("div",{className:"col s2"},a.a.createElement(Xt,{equipment:this.state.game.visibleEquipment}),a.a.createElement(Zt,{inventory:this.state.game.visibleInventory}))))}}]),t}(a.a.Component),rr=function(e){return a.a.createElement("div",{className:"CharacterSelect"},e.characters.map(function(t,r){var n="";return e.selectedCharacter&&(n=e.selectedCharacter.name===t.name?"red":""),a.a.createElement("button",{key:r,className:"CharacterSelect__button btn ".concat(n),onClick:function(){e.setSelectedCharacter(t),e.setActiveScreen(y.LEVEL)}},t.name)}))},nr=function(e){function t(e){var r;return Object(o.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return a.a.createElement("div",{className:"Title"},a.a.createElement("div",{style:{width:"100vw",height:"100vh",backgroundColor:"#e2e2e2"}},a.a.createElement("div",{class:"flow-text grey-text"},"Hidden Leaf RL"),a.a.createElement(rr,{characters:this.props.characters,selectedCharacter:this.props.selectedCharacter,setSelectedCharacter:this.props.setSelectedCharacter,setActiveScreen:this.props.setActiveScreen}),a.a.createElement("button",{class:"btn",onClick:function(){return e.props.setActiveScreen(y.LEVEL)},disabled:!this.props.selectedCharacter},"Play")))}}]),t}(a.a.Component);function ar(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function cr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ar(r,!0).forEach(function(t){Object(h.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ar(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var ir=function(e){var t=new qe({pos:{x:23,y:7},renderer:{character:"G",color:"#F0D8C0",background:"#603030"},name:"Gaara",actions:[],speed:200,durability:15,cloneLimit:3,keymap:function(e){return cr({},et(ft,e),{s:{activate:function(){return Lt(e)},label:"stay"},l:{activate:function(){return function(e){var t=e.actors[e.currentActor],r=Object(Y.cloneDeep)(t.keymap);delete r.j,delete r.k,delete r.l;var n=[{attribute:"renderer",value:Pt({},t.renderer,{background:"#A89078"})},{attribute:"keymap",value:r}];t.setNextAction(new ie({game:e.game,actor:t,cloneArgs:n}))}(e)},label:"Sand Clone"},k:{activate:function(){return function(e){var t=e.actors[e.currentActor],r=e.game,n=t.pos,a=new Ie({initiatedBy:t,pos:n,renderer:{character:"\u2588",color:"white",background:""},name:"Cursor",game:r,keymap:Et(e,t,xt({},t.keymap))});e.addActorAsPrevious(a),r.placeActorOnMap(a),r.draw()}(e)},label:"Sand Tomb"},j:{activate:function(){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=e.actors[e.currentActor],n=new jt({game:e.game,actor:r,name:"Sand Skin",lifespan:1e3,stepInterval:100,allowDuplicates:!1,onStart:function(){r.defense+=t,console.log("".concat(r.name," was enveloped in hardened sand.")),r.renderer.background="#A89078"},onStop:function(){r.defense=Math.max(0,r.defense-t),console.log("".concat(r.name,"'s hardened sand skin fell away.")),r.renderer.background="#603030"}});r.setNextAction(new $({effect:n,actor:r,game:e.game,particleTemplate:{renderer:{character:"\u2726\ufe0f",color:"#A89078",background:"#D8C0A8"}}}))}(e,2)},label:"Sand Skin"},h:{activate:function(){return Rt(e)},label:"Sand Wall"},g:{activate:function(){return function(e){var t=e.game,r=e.actors[t.engine.currentActor],n=r.pos,a=new Ie({initiatedBy:r,pos:n,renderer:{character:"\u2588",color:"white",background:""},name:"Cursor",game:t,keymap:Ct(e,r)});e.addActorAsPrevious(a),e.game.placeActorOnMap(a),e.game.draw()}(e)},label:"Sand Pulse"},i:{activate:function(){return ut(e)},label:"Open Inventory"},o:{activate:function(){return it(e)},label:"Open Equipment"},u:{activate:function(){return nt(e)},label:"Drop Item"},p:{activate:function(){return bt(e)},label:"Pickup"},t:{activate:function(){return ht(e)},label:"Throw"},y:{activate:function(){return gt(e.game)},label:"Add NPC"}})}(e),defense:2});return t.container=[Xe(e)].concat(Object(b.a)(Array(100).fill("").map(function(){return function(e,t,r,n){return new Ge({game:e.game,direction:r,passable:!0,pos:{x:t.x,y:t.y},renderer:{character:"\u2726\ufe0f",color:"#A89078",background:"#D8C0A8"},name:Ue,speed:600,energy:0,range:n})}(e,cr({},t.pos),null,20)}))),t};function or(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function sr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?or(r,!0).forEach(function(t){Object(h.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):or(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var ur=function(e){return sr({},et(ft,e),{i:{activate:function(){return ut(e)},label:"Open Inventory"},q:{activate:function(){return it(e)},label:"Open Equipment"},k:{activate:function(){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=e.actors[e.currentActor];r.setNextAction(new ie({game:e.game,actor:r,cloneArgs:t}))}(e)},label:"Clone Self"},g:{activate:function(){return nt(e)},label:"Drop Item"},p:{activate:function(){return bt(e)},label:"Pickup"},t:{activate:function(){return ht(e)},label:"Throw"},y:{activate:function(){return gt(e.game)},label:"Add NPC"},c:{activate:function(){return function(e,t){var r=e.actors[e.currentActor];r.setNextAction(new oe({chargeAmount:t,game:e.game,actor:r,energyCost:100}))}(e,1)},label:"Charge"},1:{activate:function(){return dt(W.Power,e)},label:"Sign - Power"},2:{activate:function(){return dt(W.Healing,e)},label:"Sign - Healing"},3:{activate:function(){return dt(W.Absolute,e)},label:"Sign - Absolution"},r:{activate:function(){return function(e){var t=e.actors[e.currentActor];t.setNextAction(new ue({requiredSequence:[W.Power,W.Healing],game:e.game,actor:t,energyCost:100}))}(e)},label:"Release"}})},lr=function(e){var t=new qe({pos:{x:23,y:7},renderer:{character:"N",color:"black",background:"orange"},name:"Naruto Uzumaki",actions:[],speed:600,durability:1,keymap:ur(e)});return t.container=[Xe(e),Xe(e),Xe(e)].concat(Object(b.a)(Array(10).fill("").map(function(){return Je(e,sr({},t.pos))}))),t},pr=function(){return{RockLee:Bt,Gaara:ir,NarutoUzumaki:lr}};function hr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function fr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?hr(r,!0).forEach(function(t){Object(h.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hr(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var gr=function(e){function t(){var e;Object(o.a)(this,t),e=Object(u.a)(this,Object(l.a)(t).call(this));var r=pr(),n=Object.keys(r).map(function(e,t){return{initialize:r[e],selected:!1,name:e}});return e.state={activeScreen:y.TITLE,characters:n,selectedCharacter:null},e}return Object(p.a)(t,e),Object(s.a)(t,[{key:"setActiveScreen",value:function(e){this.setState({activeScreen:e})}},{key:"setSelectedCharacter",value:function(e){this.setState({selectedCharacter:fr({},e)})}},{key:"getActiveScreen",value:function(){var e=a.a.createElement(nr,{key:y.TITLE,setActiveScreen:this.setActiveScreen.bind(this),setSelectedCharacter:this.setSelectedCharacter.bind(this),selectedCharacter:this.state.selectedCharacter,characters:this.state.characters}),t=a.a.createElement(tr,{key:y.LEVEL,setActiveScreen:this.setActiveScreen.bind(this),selectedCharacter:this.state.selectedCharacter});switch(this.state.activeScreen){case y.TITLE:return e;case y.LEVEL:return t;default:return e}}},{key:"render",value:function(){var e=this.getActiveScreen();return a.a.createElement("div",{className:"Nystrum"},a.a.createElement(g.a,{transitionName:"fade",transitionAppear:!0,transitionEnter:!0,transitionLeave:!0,transitionAppearTimeout:500,transitionEnterTimeout:500,transitionLeaveTimeout:300},e))}}]),t}(a.a.Component),yr=function(e,t){for(var r in e){var n=r.split(","),a=parseInt(n[0]),c=parseInt(n[1]),i=e[r],o={GROUND:{background:"#974",foreground:"#aaa",character:".",passable:!0}}[i.type],s=o.character,u=o.foreground,l=o.background;if(i.entities.length>0){var p=i.entities[i.entities.length-1];s=p.components.renderer.character,u=p.components.renderer.color,p.components.renderer.background&&(l=p.components.renderer.background)}t.draw(a,c,s,u,l)}},br=function(e){return"".concat(e.x,",").concat(e.y)},dr=function(e){return e.filter(function(e){return e.components.hasOwnProperty("impasse")&&!e.components.impasse.passable})},mr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return new Promise(function(t){return setTimeout(t,e)})};function vr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Or(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?vr(r,!0).forEach(function(t){Object(h.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vr(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var jr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Empty",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3?arguments[3]:void 0,a={id:e,name:t,components:r,world:n,sendEvent:function(e,t,r){return kr(e,t,r,n)}};return a},kr=function(){var e=Object(v.a)(m.a.mark(function e(){var t,r,n,a,c,i,o,s=arguments;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=s.length>0&&void 0!==s[0]?s[0]:null,r=s.length>1&&void 0!==s[1]?s[1]:null,n=s.length>2&&void 0!==s[2]?s[2]:null,a=s.length>3&&void 0!==s[3]?s[3]:null,c=!1,e.t0=m.a.keys(t.components);case 6:if((e.t1=e.t0()).done){e.next=19;break}if(i=e.t1.value,!(o=t.components[i]).hasOwnProperty(r)){e.next=17;break}if(console.log("SUCCESSFUL EVENT: ",r),c=!0,"PREPARE_RENDER"===r){e.next=15;break}return e.next=15,mr();case 15:o[r](Or({},n,{self:t,component:o})),yr(a.map,a.display);case 17:e.next=6;break;case 19:c||console.log("FAILED EVENT");case 20:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();function wr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Pr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?wr(r,!0).forEach(function(t){Object(h.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wr(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var Ar=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{passable:e,MAKE_PASSABLE:function(e){e.component.passable=!0},MAKE_IMPASSABLE:function(e){e.component.passable=!1}}},xr=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0};return e?{pos:t,MOVE:function(t){var r=t.self,n=t.component,a=t.currentPos,c=t.targetPos;if(e.canOccupy(e.map,c)){n.pos=c;var i=e.map[br(a)];e.map[br(a)]=Pr({},i,{entities:[]}),r.sendEvent(r,"PREPARE_RENDER")}else console.log("can't move there")}}:(console.log("No world to occupy"),{})},Er=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return{durability:t,DECREASE_DURABILITY:function(e){var t=e.self,r=e.component,n=e.value;r.durability-=n,r.durability<=0&&t.sendEvent(t,"DESTROY")},INCREASE_DURABILITY:function(e){var t=e.component,r=e.value;t.durability+=r},DESTROY:function(t){var r=t.self,n=(t.component,t.value,e.map[br(r.components.body.pos)]);e.map[br(r.components.body.pos)].entities=n.entities.filter(function(e){return e.id!==r.id})}}},Dr=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"white",n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return{character:t,color:r,background:n,PREPARE_RENDER:function(t){var r=t.self;r.components.hasOwnProperty("body")&&e.map[br(r.components.body.pos)].entities.push(r)}}};function Sr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Cr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Sr(r,!0).forEach(function(t){Object(h.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Sr(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var Tr,Nr,Ir=new O.g.Simple,Mr={canAct:!0,scheduler:Ir,engine:new O.c(Ir),map:{},display:new O.b({fontSize:24,bg:"#099"}),canOccupy:function(e,t){if(!e.hasOwnProperty(br(t)))return!1;var r=e[br(t)];return!(!{GROUND:{background:"#974",foreground:"#aaa",character:".",passable:!0}}[r.type].passable||0!==dr(r.entities).length)||void 0}},Rr=Cr({},jr(1,"Naruto",{reciever:(Tr={x:10,y:30},{responded:!1,RECIEVE:function(e){var t=e.self,r=e.component,n=e.message;console.log(n,Tr.x,Tr.y),r.responded||(r.responded=!0,t.sendEvent(e.sender,"hello","RECIEVE",{message:"copy",sender:t}))}}),body:xr(Mr,{x:19,y:21}),renderer:Dr(Mr,"N","orange","black")},Mr)),Lr=Cr({},jr(2,"Box",{body:xr(Mr,{x:22,y:21}),renderer:Dr(Mr,"#","black"),impasse:Ar(),destructible:Er(Mr)},Mr)),qr=Cr({},jr(2,"Box",{body:xr(Mr,{x:22,y:19}),renderer:Dr(Mr,"#","black"),impasse:Ar(),destructible:Er(Mr)},Mr)),_r=Cr({},jr(2,"Box",{body:xr(Mr,{x:22,y:17}),renderer:Dr(Mr,"#","black"),impasse:Ar(),destructible:Er(Mr)},Mr)),Br=Cr({},jr(3,"Kunai",{body:xr(Mr,{x:20,y:21}),renderer:Dr(Mr,"<>","black"),destructible:Er(Mr),attack:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return{damage:e}}(),throwable:(Nr=Mr,{THROW:function(e){var t=e.self,r=(e.component,e.direction),n=t.components.body.pos,a={x:n.x+r.x,y:n.y+r.y},c=Nr.map[br(a)];if(Nr.canOccupy(Nr.map,a))t.sendEvent(t,"MOVE",{currentPos:n,targetPos:a}),t.sendEvent(t,"THROW",{direction:r});else{if(Nr.map.hasOwnProperty(br(a))){var i=dr(c.entities).filter(function(e){return e.components.hasOwnProperty("destructible")});i.length>0&&t.sendEvent(i[0],"DECREASE_DURABILITY",{value:1})}t.sendEvent(t,"DECREASE_DURABILITY",{value:1})}}})},Mr)),Gr=(a.a.Component,function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return a.a.createElement("div",{className:"App container-fluid"},a.a.createElement(gr,null))}}]),t}(a.a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(a.a.createElement(Gr,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},74:function(e,t,r){}},[[123,1,2]]]);
//# sourceMappingURL=main.b1f7bef3.chunk.js.map