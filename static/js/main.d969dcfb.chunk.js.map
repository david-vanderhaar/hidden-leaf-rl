{"version":3,"sources":["nystrum/Screen/constants.js","helper.js","nystrum/Entities/helper.js","nystrum/constants.js","nystrum/actions.js","nystrum/entites.js","nystrum/items.js","nystrum/Keymap/helper.js","nystrum/Keymap/KeyActions/activateDropItem.js","nystrum/Keymap/KeyActions/activateEquipment.js","nystrum/Keymap/KeyActions/activateInventory.js","nystrum/Keymap/KeyActions/activateThrow.js","nystrum/Keymap/KeyActions/walk.js","nystrum/Keymap/KeyActions/addActor.js","nystrum/Keymap/KeyActions/moveCursor.js","nystrum/Keymap/KeyActions/pickupRandom.js","nystrum/Keymap/KeyActions/signing.js","nystrum/Keymap/KeyActions/activateFlyingLotus.js","nystrum/statusEffects.js","nystrum/Keymap/KeyActions/drunkenFist.js","nystrum/Keymap/KeyActions/sandTomb.js","nystrum/Keymap/KeyActions/sandPulse.js","nystrum/Keymap/KeyActions/sandWall.js","nystrum/Keymap/KeyActions/none.js","nystrum/Characters/RockLee.js","nystrum/Keymap/KeyActions/removeWeights.js","nystrum/Keymap/KeyActions/leafWhirlwind.js","nystrum/Keymap/KeyActions/openInnerGate.js","nystrum/engine.js","nystrum/game.js","nystrum/UI/Button.js","nystrum/UI/Information.js","nystrum/UI/Equipment.js","nystrum/UI/Inventory.js","nystrum/UI/Keymap.js","nystrum/Characters/NarutoUzumaki.js","nystrum/Keymap/KeyActions/cloneSelf.js","nystrum/Keymap/KeyActions/charging.js","nystrum/Characters/Gaara.js","nystrum/Keymap/KeyActions/sandClone.js","nystrum/Keymap/KeyActions/sandSkin.js","nystrum/Screen/Level.js","nystrum/Screen/Title.js","nystrum/Characters/index.js","nystrum/Nystrum.js","original/lib/helper.js","original/lib/entity.js","original/components/index.js","original/Original.js","App.js","serviceWorker.js","index.js"],"names":["SCREENS","TITLE","LEVEL","delay","timeDelayed","Promise","resolve","setTimeout","getRandomInArray","array","Math","floor","random","length","coordsToString","coords","x","y","calculatePath","game","targetPos","currentPos","topology","map","isPassable","type","astar","ROT","AStar","path","compute","push","slice","calculatePathWithRange","range","getRandomPos","keys","Object","key","split","coordinates","parseInt","text","getDestructableEntities","entites","filter","entity","hasOwnProperty","getGranularity","radius","pow","getPointsOnCircumference","centerX","centerY","r","n","list","i","round","cos","PI","sin","destroyEntity","energy","pos","tile","Helper","entities","e","id","engine","actors","removeStatusEffectByActorId","draw","currentActor","COLORS","TILE_KEY","background","foreground","character","passable","animation","HAND_SIGNS","Power","name","description","Energy","Harmony","Healing","Intuition","Awareness","Dimension","Creation","Absolute","DIRECTIONS","N","NE","W","NW","SW","S","SE","E","NONE","EQUIPMENT_TYPES","HEAD","TORSO","BACK","HAND","FEET","EQUIPMENT_LAYOUTS","human","item","CLONE_PATTERNS","verticalLine","x_offset","y_offset","positions","taken","smallSquare","square","bigSquare","circle","PARTICLE_TEMPLATES","default","renderer","color","fail","damage","leaf","PARTICLE_TYPE","directional","ALPHABET","Base","actor","energyCost","processDelay","particles","particleTemplate","Constant","onBefore","onAfter","onSuccess","onFailure","this","life","direction","particle","Particle","console","log","success","alternative","AddStatusEffect","effect","args","addStatusEffect","forEach","addParticle","sign","Say","message","EquipItemFromContainer","equipmentType","itemInSlot","getItemInSlot","addToContainer","unequip","removeFromContainer","equip","UnequipItem","DropItem","PickupItem","it","DestroySelf","destroy","CloneSelf","cloneArgs","createClone","Charge","chargeAmount","increaseCharge","Sign","addSign","SignRelease","requiredSequence","signHistory","concat","relevantHistory","max","JSON","stringify","requiredSequenceIsFulfilled","join","clearSigns","CursorMove","cursorCanOccupyPosition","PlaceItems","targetPositions","canOccupyPosition","clone","cloneDeep","uuid","placeActorOnMap","Move","move","Action","ProjectileMove","damageToSelf","MoveMultiple","stepCount","setNextAction","Shove","shove","Tackle","additionalAttackDamage","attack","Attack","entityTypes","includes","SelfDestructiveAttack","decreaseDurabilityWithoutDefense","MultiTargetAttack","particlePath","particlePos","attackSuccess","ThrowProjectile","move_result","shift","ThrowProjectileGas","CrankEngine","start","Entity","Parent","superclass","children","Engine","isInitialized","child","destroyChild","canAttack","bind","addActor","initialize","Attacking","attackDamage","additional","targets","target","getAttackDamage","equipment","slot","decreaseDurability","Acting","actions","speed","action","value","Rendering","targetTile","newPos","Playing","keymap","nextAction","Chasing","targetEntity","Destructable","durability","defense","onDestroy","current","newDurability","getDefense","min","UI_Actor","pipe","initiatedBy","active","Wall","MovingWall","createPath","result","Bandit","Player","charge","chargeMax","container","itemType","items","slotName","find","foundSlot","currentGate","gates","damageBuff","speedBuff","durabilityDebuff","nextGate","nextGateIndex","findIndex","gate","cloneLimit","clones","index","c","super__destroy","splice","destroyClone","arg","attribute","addActorAsNext","Weapon","DestructiveProjectile","DirectionalProjectile","DestructiveCloudProjectileV2","owner_id","isClone","cloneCount","clonePattern","offset","cloneDeepWith","referencePos","step","nextPos","getNextPos","TYPE","createProjectileCloud","throwDirection","structureType","createProjectile","structure","position","targetPosition","sandTomb","createProjectileSingularity","sandShuriken","kunai","movingSandWall","sword","addAlphabeticallyToKeymap","obj","alphabetAllowed","letter","deactivateUIKeymap","visibleUIKey","currentUiActor","removeActor","activateDropItem","visibleInventory","ui","addActorAsPrevious","Escape","activate","label","keymapDropFromInventory","activateEquipment","visibleEquipment","keymapEquipment","activateInventory","keymapEquipFromInventory","throwDirectionalKunai","cursor","contains","placeActorsOnMap","keymapCursorToThrowItem","w","d","z","a","q","activateThrow","walk","newX","newY","banditStats","banditLevels","getBanditStats","randomlyPlaceActorOnMap","moveCursor","pickupRandom","flyingLotus","activateFlyingLotus","previousKeymap","ENERGY_THRESHOLD","goToPreviousKeymap","s","keymapFlyingLotus","lifespan","stepInterval","allowDuplicates","onStart","onStep","onStop","timeToLive","timeSinceLastStep","drunkWalk","originalDirection","count","keymapSandTomb","k","cloud","Item","triggerSandTomb","triggerSandPulse","sandWallPulse","sandPulse","keymapSandPulse","createSandWall","triggerSandWall","directionString","getDirectionKey","sandWall","keymapSandWall","none","Keymap","l","speedBoost","damageDebuff","StatusEffect","j","h","g","setNextGate","nextGateToLabel","getNextGate","o","u","p","t","Array","fill","statusEffects","isRunning","gainEnergy","hasEnoughEnergy","getAction","perform","acting","timePassed","processActionFX","processStatusEffects","sortActorsByEnery","processV2","backToTitle","visibleKeymap","updateMode","updateReact","sort","b","newEffect","actorId","removeDeadStatusEffects","actionSuccess","removeActorFromMap","update","removeDeadParticles","process","GAME_MODE_TYPES","WAVE","Game","display","width","fontSize","bg","tileKey","mode","data","level","highestLevel","localStorage","getItem","setItem","addWaveEnemy","nextModeLevel","initializeMode","setModeLevel","kill","placed","ac","digger","Arena","freeCells","create","currentFrame","ceil","randomlyPlaceAllActorsOnMap","hasImpassableEntity","document","getElementById","appendChild","getContainer","parts","tileRenderer","frame","isPlaced","presserRef","show","createLevel","focus","handleKeyPress","event","code","Button","props","onClick","className","Information","React","Component","Equipment","Inventory","inventory","entries","cloneOverrides","cloneKeymap","defenseBuff","Level","ENGINE","selectedCharacter","state","createRef","setActiveScreen","newGameState","setState","ref","onKeyDown","tabIndex","CharacterSelect","characters","setSelectedCharacter","Title","style","height","backgroundColor","class","disabled","Characters","RockLee","Gaara","NarutoUzumaki","Nystrum","characterKey","selected","activeScreen","titleScreen","levelScreen","getActiveScreen","transitionName","transitionAppear","transitionEnter","transitionLeave","transitionAppearTimeout","transitionEnterTimeout","transitionLeaveTimeout","DRAW","components","getImpassableEntities","impasse","createEntity","world","sendEvent","eventType","parameters","component","self","MAKE_PASSABLE","MAKE_IMPASSABLE","body","MOVE","canOccupy","destructible","DECREASE_DURABILITY","INCREASE_DURABILITY","DESTROY","PREPARE_RENDER","scheduler","Simple","canAct","naruto","reciever","responded","RECIEVE","sender","Components","box","box2","box3","throwable","THROW","nextTile","impassable_and_destructable_entities","App","Boolean","window","location","hostname","match","ReactDOM","render","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.d969dcfb.chunk.js","sourcesContent":["export const SCREENS = {\n  TITLE: 0,\n  LEVEL: 1,\n}","import * as ROT from 'rot-js';\n\nexport const delay = (timeDelayed = 100) => {\n  return new Promise(resolve => setTimeout(resolve, timeDelayed));\n}\n\nexport const getRandomInArray = (array) => {\n  return array[Math.floor(Math.random() * array.length)];\n}\n\nexport const getRandomInt = (min, max) => {\n  min = Math.ceil(min);\n  max = Math.floor(max);\n  return Math.floor(Math.random() * (max - min)) + min;\n}\n\nexport const getRandomIntInclusive = (min, max) => {\n  min = Math.ceil(min);\n  max = Math.floor(max);\n  return Math.floor(Math.random() * (max - min + 1)) + min;\n}\n\nexport const coordsToString = (coords) => `${coords.x},${coords.y}`\n\nexport const calculatePath = (game, targetPos, currentPos, topology = 4) => {\n  let map = game.map\n  let isPassable = function (x, y) {\n    if (map[x + \",\" + y]) {\n      return (map[x + \",\" + y].type === 'GROUND');\n    } else {\n      return false\n    }\n  }\n  let astar = new ROT.Path.AStar(targetPos.x, targetPos.y, isPassable, { topology });\n  let path = [];\n  astar.compute(currentPos.x, currentPos.y, function (x, y) {\n    path.push({ x, y })\n  });\n\n  return path.slice(1);\n}\n\nexport const calculatePathWithRange = (game, targetPos, currentPos, topology, range) => {\n  let path = calculatePath(game, targetPos, currentPos, topology);\n  return path.slice(0, range + 1);\n}\n\nexport const getRandomPos = (map) => {\n  let keys = Object.keys(map);\n  let key = getRandomInArray(keys).split(',');\n  let pos = { x: parseInt(key[0]), y: parseInt(key[1])}\n  return {coordinates: pos, text: key}\n}\n\nexport const getDestructableEntities = (entites) => {\n  return entites.filter((entity) => entity.hasOwnProperty('durability'));\n}\n\nconst getGranularity = (radius) => {\n  let result = (2 / 3) * (Math.pow(radius, 3) - (9 * Math.pow(radius, 2)) + (32 * radius) - 18)\n  return result\n}\n\nexport const getPointsOnCircumference = (centerX = 0, centerY = 0, r = 3) => {\n  const n = getGranularity(r);\n  let list = [];\n  for (let i = 0; i < n; i++) {\n    let x = Math.round(centerX + (Math.cos(2 * Math.PI / n * i) * r))\n    let y = Math.round(centerY + (Math.sin(2 * Math.PI / n * i) * r))\n    list.push({ x, y });\n  }\n  return list\n}\n","import * as Helper from '../../helper';\n\nexport const destroyEntity = (entity) => {\n  entity.energy = 0;\n  if (entity.pos) {\n    let tile = entity.game.map[Helper.coordsToString(entity.pos)];\n    entity.game.map[Helper.coordsToString(entity.pos)].entities = tile.entities.filter((e) => e.id !== entity.id);\n  }\n  entity.game.engine.actors = entity.game.engine.actors.filter((e) => e.id !== entity.id);\n  entity.game.engine.removeStatusEffectByActorId(entity.id);\n  entity.game.draw()\n  entity.game.engine.currentActor = entity.game.engine.currentActor % entity.game.engine.actors.length; \n\n}","import * as Helper from '../helper'\n\nexport const ENERGY_THRESHOLD = 100;\n\nexport const COLORS = {\n  black_1: '#424242',\n  gray_1: '#262d37',\n  gray_2: '#606b79',\n  green_1: '#1d533c',\n  green_2: '#227743',\n  green_3: '#2d9c59',\n}\n\nexport const TILE_KEY = {\n  'GROUND': {\n    background: COLORS.black_1,\n    foreground: COLORS.gray_2,\n    character: '.',\n    passable: true,\n  },\n  'WALL': {\n    background: COLORS.black_1,\n    foreground: COLORS.gray_2,\n    character: '#',\n    passable: false,\n  },\n  'WATER': {\n    animation: [\n      { background: '#424242', foreground: '#9dc3d3', character: '', passable: false,},\n      { background: '#424242', foreground: '#9dc3d3', character: '', passable: false,},\n      { background: '#424242', foreground: '#9dc3d3', character: '', passable: false,},\n      { background: '#424242', foreground: '#9dc3d3', character: '', passable: false,},\n      { background: '#424242', foreground: '#9dc3d3', character: '', passable: false,},\n      { background: '#424242', foreground: '#9dc3d3', character: '', passable: false,},\n      { background: '#424242', foreground: '#9dc3d3', character: '', passable: false,},\n      { background: '#424242', foreground: '#9dc3d3', character: '', passable: false,},\n      { background: '#424242', foreground: '#9dc3d3', character: '', passable: false,},\n      { background: '#424242', foreground: '#9dc3d3', character: '', passable: false,},\n      { background: '#424242', foreground: '#9dc3d3', character: '', passable: false,},\n      { background: '#424242', foreground: '#8aa', character: '', passable: false, },\n      { background: '#424242', foreground: '#8aa', character: '', passable: false, },\n    ],\n    background: '#9dc3d3',\n    character: '',\n    passable: false,\n  },\n  'WIN': {\n    background: 'white',\n    foreground: 'black',\n    character: 'W',\n    passable: true,\n  }\n}\n\nexport const HAND_SIGNS = {\n  Power: {\n    type: 'Power',\n    name: 'Rin',\n    description: 'Strength of mind, body, spirit',\n  },\n  Energy: {\n    type: 'Energy',\n    name: 'Pyo',\n    description: 'energy direction',\n  },\n  Harmony: {\n    type: 'Harmony',\n    name: 'To',\n    description: 'one- ness with the universe or self',\n  },\n  Healing: {\n    type: 'Healing',\n    name: 'Sha',\n    description: 'of self and others',\n  },\n  Intuition: {\n    type: 'Intuition',\n    name: 'Kai',\n    description: 'premonition of danger, feeling others intent',\n  },\n  Awareness: {\n    type: 'Awareness',\n    name: 'Jin',\n    description: 'feeling thoughts of others, perhaps hiding your own',\n  },\n  Dimension: {\n    type: 'Dimension',\n    name: 'Retsu',\n    description: 'control of time and space',\n  },\n  Creation: {\n    type: 'Creation',\n    name: 'Zai',\n    description: 'understanding nature',\n  },\n  Absolute: {\n    type: 'Absolute',\n    name: 'Zen',\n    description: 'enlightenment',\n  }, \n}\n\nexport const DIRECTIONS = {\n  N: [0, -1],\n  NE: [1, -1],\n  W: [-1, 0],\n  NW: [-1, -1],\n  SW: [-1, 1],\n  S: [0, 1],\n  SE: [1, 1],\n  E: [1, 0],\n  NONE: [0, 0],\n}\n\nexport const getDirectionKey = (direction) => {\n  let directionString = `${direction}`;\n  let keys = Object.keys(DIRECTIONS);\n  let result = false\n  keys.forEach((key) => {\n    if (`${DIRECTIONS[key]}` === directionString) {\n      result = key\n    }\n  })\n  return result\n}\n\nexport const EQUIPMENT_TYPES = {\n  HEAD: 'HEAD',\n  TORSO: 'TORSO',\n  BACK: 'BACK',\n  HAND: 'HAND',\n  FEET: 'FEET',\n}\n\nexport const EQUIPMENT_LAYOUTS = {\n  human: () => {\n    return [\n      {type: EQUIPMENT_TYPES.HEAD, name: 'head', item: null},\n      {type: EQUIPMENT_TYPES.TORSO, name: 'torso', item: null},\n      {type: EQUIPMENT_TYPES.BACK, name: 'back', item: null},\n      {type: EQUIPMENT_TYPES.HAND, name: 'left_hand', item: null},\n      {type: EQUIPMENT_TYPES.HAND, name: 'right_hand', item: null},\n      {type: EQUIPMENT_TYPES.FEET, name: 'feet', item: null},\n    ]\n  }\n}\n\nexport const CLONE_PATTERNS = {\n  verticalLine: {\n    x_offset: 1,\n    y_offset: 1,\n    positions: [\n      { x: 0, y: 0, taken: false, },\n      { x: 0, y: 1, taken: false, },\n      { x: 0, y: -1, taken: false, },\n    ]\n  },\n  smallSquare: {\n    x_offset: 1,\n    y_offset: 1,\n    positions: [\n      { x: 0, y: 0, taken: false, },\n      { x: 0, y: 1, taken: false, },\n      { x: 1, y: 1, taken: false, },\n      { x: 1, y: 0, taken: false, },\n    ]\n  },\n  square: {\n    x_offset: 2,\n    y_offset: 2,\n    positions: [\n      { x: 0, y: 0, taken: false, },\n      { x: 0, y: 1, taken: false, },\n      { x: 1, y: 1, taken: false, },\n      { x: 1, y: 0, taken: false, },\n      { x: 1, y: -1, taken: false, },\n      { x: 0, y: -1, taken: false, },\n      { x: -1, y: -1, taken: false, },\n      { x: -1, y: 0, taken: false, },\n      { x: -1, y: 1, taken: false, },\n    ]\n  },\n  bigSquare: {\n    x_offset: 2,\n    y_offset: 2,\n    positions: [\n      { x: 0, y: 0, taken: false, },\n      { x: 0, y: 1, taken: false, },\n      { x: 1, y: 1, taken: false, },\n      { x: 1, y: 0, taken: false, },\n      { x: 1, y: -1, taken: false, },\n      { x: 0, y: -1, taken: false, },\n      { x: -1, y: -1, taken: false, },\n      { x: -1, y: 0, taken: false, },\n      { x: -1, y: 1, taken: false, },\n      { x: 0, y: 1, taken: false, },\n      { x: 2, y: 2, taken: false, },\n      { x: 2, y: 0, taken: false, },\n      { x: 2, y: -2, taken: false, },\n      { x: 0, y: -2, taken: false, },\n      { x: -2, y: -2, taken: false, },\n      { x: -2, y: 0, taken: false, },\n      { x: -2, y: 2, taken: false, },\n    ],\n  },\n  circle: {\n    x_offset: 0,\n    y_offset: 0,\n    positions: [\n      ...Helper.getPointsOnCircumference(0, 0, 2),\n      ...Helper.getPointsOnCircumference(0, 0, 3)\n    ]\n  },\n}\n\nexport const PARTICLE_TEMPLATES = {\n  default: {\n    renderer: {\n      character: '*',\n      color: 'black',\n      background: 'white',\n    }\n  },\n  fail: {\n    renderer: {\n      character: 'x',\n      color: 'black',\n      background: 'red',\n    }\n  },\n  damage: {\n    renderer: {\n      character: '*',\n      color: 'darkred',\n      background: 'red',\n    }\n  },\n  leaf: {\n    renderer: {\n      character: '',\n      color: '#36635b',\n      background: '#F0D8C0',\n    }\n  },\n}\n\nexport const PARTICLE_TYPE = {\n  directional: 0,\n  path: 1,\n}\n\nexport const ALPHABET = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z'];","import * as Helper from '../helper';\nimport * as Action from './actions';\nimport * as Constant from './constants';\nimport { destroyEntity } from './Entities/helper';\nimport { cloneDeep } from 'lodash';\nimport uuid from 'uuid/v1';\nimport { Particle } from './entites';\n\nexport class Base {\n  constructor({\n    game, \n    actor, \n    energyCost = 100, \n    processDelay = 50, \n    particles = [], \n    particleTemplate = Constant.PARTICLE_TEMPLATES.default,\n    onBefore = () => null,\n    onAfter = () => null,\n    onSuccess = () => null,\n    onFailure = () => null,\n  }) {\n    this.actor = actor\n    this.game = game\n    this.energyCost = energyCost\n    this.processDelay = processDelay\n    this.particles = particles\n    this.particleTemplate = particleTemplate\n    this.onBefore = onBefore\n    this.onAfter = onAfter\n    this.onSuccess = onSuccess\n    this.onFailure = onFailure\n  }\n\n  addParticle(\n    life, \n    pos, \n    direction, \n    renderer = {...this.particleTemplate.renderer}, \n    type = Constant.PARTICLE_TYPE.directional, \n    path = null\n  ) {\n    let particle = new Particle({\n      game: this.game,\n      name: 'particle',\n      passable: true,\n      life,\n      pos,\n      direction,\n      energy: 100,\n      renderer,\n      type,\n      path,\n    })\n    this.particles.push(particle);\n  }\n\n  removeDeadParticles() {\n    this.particles = this.particles.filter((particle) => particle.life > 0);\n  }\n\n  perform() {\n    console.log(`${this.actor.name} performs`)\n    this.actor.energy -= this.energyCost;\n    return {\n      success: true,\n      alternative: null,\n    }\n  }\n}\n\nexport class AddStatusEffect extends Base {\n  constructor({ effect, processDelay = 0, ...args }) {\n    super({ ...args });\n    this.effect = effect\n    this.processDelay = processDelay\n  }\n\n  perform() {\n    let success = this.game.engine.addStatusEffect(this.effect);\n    let positions = Helper.getPointsOnCircumference(this.actor.pos.x, this.actor.pos.y, 2);\n    positions.forEach((pos) => {\n      this.addParticle(\n        5, \n        {...pos}, \n        {\n          x: Math.sign(pos.x - this.actor.pos.x), \n          y: Math.sign(pos.y - this.actor.pos.y)\n        },\n      )\n    })\n    if (success) this.actor.energy -= this.energyCost;\n    return {\n      success,\n      alternative: null,\n    }\n  }\n};\n\nexport class Say extends Base {\n  constructor({ message, processDelay = 50, ...args}) {\n    super({...args});\n    this.message = message\n    this.processDelay = processDelay\n  }\n  perform() {\n    console.log(`${this.actor.name} says ${this.message}`);\n    this.actor.energy -= this.energyCost;\n    return {\n      success: true,\n      alternative: null,\n    }\n  }\n};\n\nexport class SayManyThings extends Base {\n  constructor({ messages, processDelay = 50, ...args}) {\n    super({...args});\n    this.messages = messages\n    this.processDelay = processDelay\n  }\n  perform() {\n    let message = this.messages.shift();\n    if (message) {\n      console.log(`${this.actor.name} says ${message}`);\n      this.actor.energy -= this.energyCost;\n    }\n    if (this.messages.length) {\n      this.actor.setNextAction(this);\n    }\n    return {\n      success: true,\n      alternative: null,\n    }\n  }\n};\n\nexport class EquipItemFromContainer extends Base {\n  // entities can only equip items from their container/inventory\n  constructor({ item, ...args }) {\n    super({ ...args });\n    this.item = item;\n  }\n  perform() {\n    let success = false;\n    let alternative = null;\n    if (this.item.equipmentType) {\n      let itemInSlot = this.actor.getItemInSlot(this.item.equipmentType);\n      if (itemInSlot) {\n        this.actor.addToContainer(itemInSlot);\n        this.actor.unequip(itemInSlot);\n      }\n      this.actor.removeFromContainer(this.item);\n      this.actor.equip(this.item.equipmentType, this.item);\n      console.log(`${this.actor.name} equips ${this.item.name}.`);\n      success = true;\n    }\n\n    this.actor.energy -= this.energyCost;\n    \n    return {\n      success,\n      alternative,\n    }\n  }\n};\n\nexport class EquipItemFromTile extends Base {\n  // entities can only equip items from their container/inventory\n  constructor({ item, ...args }) {\n    super({ ...args });\n    this.item = item;\n  }\n\n  perform () {\n    let success = false;\n    let alternative = null;\n    if (this.item.equipmentType) {\n      let itemInSlot = this.actor.getItemInSlot(this.item.equipmentType);\n      if (itemInSlot) {\n        this.game.map[Helper.coordsToString(this.actor.pos)].entities.push(itemInSlot);\n      }\n\n      let entities = this.game.map[Helper.coordsToString(this.actor.pos)].entities\n      this.game.map[Helper.coordsToString(this.actor.pos)].entities = entities.filter((it) => it.id !== this.item.id);\n      \n      this.actor.equip(this.item);\n      console.log(`${this.actor.name} equips ${this.item.name}.`);\n      success = true;\n    }\n\n    this.actor.energy -= this.energyCost;\n    return {\n      success,\n      alternative,\n    }\n  }\n};\n\nexport class UnequipItem extends Base {\n  constructor({ item, ...args }) {\n    super({ ...args });\n    this.item = item;\n  }\n  perform() {\n    console.log(`${this.actor.name} puts ${this.item.name} away.`);\n    this.actor.unequip(this.item);\n    this.actor.addToContainer(this.item);\n    this.actor.energy -= this.energyCost;\n    return {\n      success: true,\n      alternative: null,\n    }\n  }\n};\n\nexport class DropItem extends Base {\n  constructor({ item, ...args }) {\n    super({ ...args });\n    this.item = item;\n  }\n  perform() {\n    console.log(`${this.actor.name} drops ${this.item.name}.`);\n    this.actor.removeFromContainer(this.item);\n    this.game.map[Helper.coordsToString(this.actor.pos)].entities.push(this.item);\n    this.actor.energy -= this.energyCost;\n    return {\n      success: true,\n      alternative: null,\n    }\n  }\n};\n\nexport class PickupItem extends Base {\n  constructor({ item, ...args }) {\n    super({ ...args });\n    this.item = item;\n  }\n  perform() {\n    console.log(`${this.actor.name} picks up ${this.item.name}.`);\n    this.actor.addToContainer(this.item);\n    let entities = this.game.map[Helper.coordsToString(this.actor.pos)].entities\n    this.game.map[Helper.coordsToString(this.actor.pos)].entities = entities.filter((it) => it.id !== this.item.id);\n    this.actor.energy -= this.energyCost;\n    return {\n      success: true,\n      alternative: null,\n    }\n  }\n};\n\nexport class DestroySelf extends Base {\n  constructor({processDelay = 0, ...args}) {\n    super({...args});\n    this.processDelay = processDelay\n  }\n  perform() {\n    // console.log(`${this.actor.name} is self-destructing`);\n    this.actor.energy -= this.energyCost;\n    this.actor.destroy();\n    return {\n      success: true,\n      alternative: null,\n    }\n  }\n};\n\nexport class CloneSelf extends Base {\n  constructor({cloneArgs = [], ...args}) {\n    super({...args});\n    this.cloneArgs = cloneArgs;\n  }\n\n  perform() {\n    let success = false;\n    if (this.actor.createClone(this.cloneArgs)) {\n      success = true;\n      this.actor.energy -= this.energyCost;\n      console.log(`${this.actor.name} is cloning itself`);\n    }\n    // let clone = cloneDeep(this.actor);\n    // clone.game = this.actor.game;\n    // clone.id = uuid();\n    // this.cloneArgs.forEach((arg) => {\n    //   console.log(arg);\n      \n    //   clone[arg.attribute] = arg.value\n    // });\n    // if (this.game.placeActorOnMap(clone)) {\n    //   this.game.engine.addActorAsNext(clone);\n    //   this.game.draw();\n    //   success = true;\n    // };\n    return {\n      success,\n      alternative: null,\n    }\n  }\n};\n\nexport class Charge extends Base {\n  constructor({chargeAmount, ...args}) {\n    super({...args});\n    this.chargeAmount = chargeAmount;\n  }\n  perform() {\n    console.log(`${this.actor.name} is charging up!`);\n    this.actor.energy -= this.energyCost;\n    this.actor.increaseCharge(this.chargeAmount);\n    return {\n      success: true,\n      alternative: null,\n    }\n  }\n};\n\nexport class Release extends Base {\n  constructor({ chargeCost, ...args }) {\n    super({ ...args });\n    this.chargeCost = chargeCost;\n  }\n  perform() {\n    let success = false;\n    if (this.actor.charge >= this.chargeCost) {\n      console.log(`${this.actor.name} is releasing ${this.chargeCost} volts!`);\n      this.actor.energy -= this.energyCost;\n      this.actor.decreaseCharge(this.chargeCost);\n      success = true;\n    }\n    return {\n      success,\n      alternative: null,\n    }\n  }\n};\n\nexport class Sign extends Base {\n  constructor({ sign, ...args }) {\n    super({ ...args });\n    this.sign = sign;\n  }\n  perform() {\n    console.log(`${this.actor.name} threw a ${this.sign.name} sign.`);\n    this.actor.addSign(this.sign);\n    this.actor.energy -= this.energyCost;\n    return {\n      success: true,\n      alternative: null,\n    }\n  }\n};\n\nexport class SignRelease extends Base {\n  constructor({requiredSequence = [], ...args}) {\n    super({...args});\n    this.requiredSequence = requiredSequence;\n  }\n\n  requiredSequenceIsFulfilled () {\n    let signHistory = this.actor.signHistory.concat();\n    let relevantHistory = signHistory.slice(\n      Math.max(signHistory.length - this.requiredSequence.length, 0)\n    )\n    let result = JSON.stringify(relevantHistory) === JSON.stringify(this.requiredSequence);\n    return result\n  }\n\n  perform() {\n    let success = false;\n    if (this.requiredSequenceIsFulfilled()) {\n      console.log(\n        `${this.actor.name} is releasing the power of ${this.requiredSequence.map(\n          (sign) => sign.type\n        ).join(' and ')}!`\n      );\n      this.actor.energy -= this.energyCost;\n      success = true;\n      this.actor.clearSigns();\n    }\n    return {\n      success,\n      alternative: null,\n    }\n  }\n};\n\nexport class CursorMove extends Base {\n  constructor({ targetPos, processDelay = 0, ...args}) {\n    super({...args});\n    this.targetPos = targetPos\n    this.processDelay = processDelay\n  }\n  perform() {\n    let success = false;\n    let alternative = null;\n\n    if (this.game.cursorCanOccupyPosition(this.targetPos)) {\n      let tile = this.game.map[Helper.coordsToString(this.actor.pos)]\n      this.game.map[Helper.coordsToString(this.actor.pos)] = { ...tile, entities: tile.entities.filter((e) => e.id !== this.actor.id) }\n      this.actor.pos = this.targetPos\n      this.game.map[Helper.coordsToString(this.targetPos)].entities.push(this.actor);\n      success = true;\n    }\n\n    return {\n      success,\n      alternative,\n    }\n  }\n};\n\nexport class ParticleMove extends CursorMove {\n  constructor({...args}) {\n    super({...args})\n  }\n\n  perform () {\n    this.actor.energy -= this.energyCost;\n    if (this.actor.energy <= 0) {\n      this.actor.destroy();\n      return { success: false }\n    } \n    return super.perform();\n  }\n}\n\nexport class PlaceActor extends Base {\n  constructor({ targetPos, entity, ...args}) {\n    super({...args});\n    this.targetPos = targetPos\n    this.entity = entity\n  }\n  perform() {\n    let success = false;\n    let alternative = null;\n    \n    // let canPlace = true;\n    // if (!this.game.canOccupyPosition(this.targetPos, this.entity)) canPlace = false;\n    // if (this.entity.entityTypes.includes('PARENT')) {\n    //   this.entity.children.forEach((child) => {\n    //     console.log(child.pos);\n        \n    //     if (!this.game.canOccupyPosition(child.pos, child)) canPlace = false;\n    //   })\n    // }\n\n    // if (canPlace) {\n    //   this.entity.pos = this.targetPos;\n    //   this.game.engine.addActorAsPrevious(this.entity);\n    //   this.game.engine.start(); // should this be used outside of engine?\n    //   success = true;      \n    // }\n    if (this.game.canOccupyPosition(this.targetPos, this.entity)) {\n      this.entity.pos = this.targetPos;\n      this.game.engine.addActorAsNext(this.entity);\n      // this.game.engine.addActorAsPrevious(this.entity);\n      // this.game.engine.start(); // BUGGED - should this be used outside of engine?\n      success = true;\n    }\n      \n    if (success) {\n      this.actor.energy -= this.energyCost;\n    }\n    \n    return {\n      success,\n      alternative,\n    }\n  }\n};\n\nexport class PlaceItem extends Base {\n  constructor({ targetPos, entity, processDelay = 25, ...args}) {\n    super({...args});\n    this.targetPos = targetPos\n    this.processDelay = processDelay\n    this.entity = entity\n  }\n  perform() {\n    let success = false;\n    let alternative = null;\n    \n    if (this.game.canOccupyPosition(this.targetPos, this.entity)) {\n      this.entity.pos = this.targetPos;\n      success = this.game.placeActorOnMap(this.entity)\n    }\n      \n    if (success) {\n      this.actor.energy -= this.energyCost;\n    }\n    \n    return {\n      success,\n      alternative,\n    }\n  }\n};\n\nexport class PlaceItems extends PlaceItem {\n  constructor({targetPositions = [], ...args}) {\n    super({...args});\n    this.targetPositions = targetPositions\n  }\n  perform() {\n    let success = false;\n    let alternative = null;\n    console.log('actor ', this.actor.pos);\n    this.targetPositions.forEach((targetPos) => {\n      console.log('target ', targetPos);\n      \n      if (this.game.canOccupyPosition(targetPos, this.entity)) {\n        let clone = cloneDeep(this.entity);\n        clone.game = this.game;\n        clone.id = uuid();\n        clone.pos = targetPos;\n        let placementSuccess = this.game.placeActorOnMap(clone);\n        if (placementSuccess) success = true;\n      }\n    });\n\n    if (success) this.actor.energy -= this.energyCost;\n\n    return {\n      success,\n      alternative,\n    }\n  }\n};\n\nexport class Move extends Base {\n  constructor({ targetPos, processDelay = 25, ...args}) {\n    super({...args});\n    this.targetPos = targetPos\n    this.processDelay = processDelay\n  }\n  perform() {\n    let success = false;\n    let alternative = null;\n    let moveSuccess = this.actor.move(this.targetPos);\n    if (moveSuccess) {\n      this.actor.energy -= this.energyCost;\n      success = true;\n    } else {\n      success = true;\n      alternative = new Action.Attack({\n        targetPos: this.targetPos,\n        game: this.game, \n        actor: this.actor, \n        energyCost: Constant.ENERGY_THRESHOLD\n      })\n    }\n\n    return {\n      success,\n      alternative,\n    }\n  }\n};\n\nexport class ProjectileMove extends Base {\n  constructor({ targetPos, damageToSelf = 1, processDelay = 25, ...args}) {\n    super({...args});\n    this.targetPos = targetPos\n    this.processDelay = processDelay\n    this.damageToSelf = damageToSelf\n  }\n  perform() {\n    let success = false;\n    let alternative = null;\n    let moveSuccess = this.actor.move(this.targetPos);\n    if (moveSuccess) {\n      this.actor.energy -= this.energyCost;\n      success = true;\n    } else {\n      success = true;\n      alternative = new Action.SelfDestructiveAttack({\n        targetPos: this.targetPos,\n        game: this.game, \n        actor: this.actor, \n        energyCost: Constant.ENERGY_THRESHOLD,\n        damageToSelf: this.damageToSelf,\n      })\n    }\n\n    return {\n      success,\n      alternative,\n    }\n  }\n};\n\nexport class MoveMultiple extends Base {\n  constructor({ direction, stepCount, processDelay = 25, ...args}) {\n    super({...args});\n    this.direction = direction;\n    this.stepCount = stepCount;\n    this.processDelay = processDelay;\n  }\n  perform() {\n    let success = false;\n    let alternative = null;\n    let newX = this.actor.pos.x + this.direction[0];\n    let newY = this.actor.pos.y + this.direction[1];\n    let targetPos = { x: newX, y: newY };\n    \n    if (this.stepCount > 0 && this.actor.move(targetPos)) {\n      this.stepCount -= 1;\n      this.actor.energy -= this.energyCost;\n      this.actor.setNextAction(this);\n      success = true;\n    } else {\n      success = true;\n      alternative = new Action.Attack({\n        targetPos: targetPos,\n        game: this.game, \n        actor: this.actor, \n        energyCost: Constant.ENERGY_THRESHOLD\n      })\n    }\n\n    return {\n      success,\n      alternative,\n    }\n  }\n};\n\nexport class Shove extends Base {\n  constructor({ targetPos, direction, ...args }) {\n    super({ ...args });\n    this.targetPos = targetPos\n    this.direction = direction\n  }\n  perform() {\n    let success = false;\n    let alternative = null;\n    let moveSuccess = this.actor.shove(this.targetPos, this.direction)\n    \n    if (moveSuccess) {\n      this.actor.energy -= this.energyCost;\n      success = true;\n    } else {\n      success = true;\n      alternative = new Action.Attack({\n        targetPos: this.targetPos,\n        game: this.game,\n        actor: this.actor,\n        energyCost: Constant.ENERGY_THRESHOLD\n      })\n    }\n\n    return {\n      success,\n      alternative,\n    }\n  }\n};\n\nexport class Tackle extends MoveMultiple {\n  constructor({ direction, stepCount, additionalAttackDamage = 0, processDelay = 25, ...args}) {\n    super({...args});\n    this.direction = direction;\n    this.stepCount = stepCount;\n    this.additionalAttackDamage = additionalAttackDamage;\n    this.processDelay = processDelay;\n  }\n  perform() {\n    let success = false;\n    let alternative = null;\n    let newX = this.actor.pos.x + this.direction[0];\n    let newY = this.actor.pos.y + this.direction[1];\n    let targetPos = { x: newX, y: newY };\n    \n    if (this.stepCount > 0 && this.actor.shove(targetPos, this.direction)) {\n      this.stepCount -= 1;\n      this.actor.energy -= this.energyCost;\n      this.actor.setNextAction(this);\n      for (let i = 0; i < 3; i++) {\n        this.addParticle(\n          1,\n          {\n            x: this.actor.pos.x - (this.direction[0] * i),\n            y: this.actor.pos.y - (this.direction[1] * i),\n          },\n          { x: 0, y: 0 }\n        )\n      }\n      success = true;\n    } else {\n      success = true;\n      this.actor.attack(targetPos, this.additionalAttackDamage);\n    }\n\n    return {\n      success,\n      alternative,\n    }\n  }\n};\n\nexport class Attack extends Base {\n  constructor({ targetPos, processDelay = 100, ...args}) {\n    super({...args});\n    this.targetPos = targetPos\n    this.processDelay = processDelay\n    this.particleTemplate = Constant.PARTICLE_TEMPLATES.damage\n  }\n  perform() {\n    let success = false;\n    let alternative = null;\n    \n    if (!this.actor.entityTypes.includes('ATTACKING')) { \n      return { \n        success: true, \n        alternative: new Action.Say({\n          message: `Ooh I don\\'t know how to attack`,\n          game: this.game,\n          actor: this.actor,\n        }),\n      } \n    }\n    \n    success = this.actor.attack(this.targetPos);\n    if (success) {\n      this.addParticle(1, {...this.targetPos}, {x: 0, y:0})\n      this.actor.energy -= this.energyCost;\n    }\n\n    return {\n      success,\n      alternative,\n    }\n  }\n};\n\nexport class SelfDestructiveAttack extends Attack {\n  constructor({ damageToSelf, ...args }) {\n    super({ ...args });\n    this.damageToSelf = damageToSelf\n    this.onSuccess = () => this.actor.decreaseDurabilityWithoutDefense(damageToSelf)\n    this.onFailure = () => this.actor.destroy()\n  }\n}\n\nexport class MultiTargetAttack extends Base {\n  constructor({ targetPositions, processDelay = 25, ...args }) {\n    super({ ...args });\n    this.targetPositions = targetPositions\n    this.processDelay = processDelay\n  }\n\n  perform() {\n    let success = false;\n    let alternative = null;\n    \n    if (!this.actor.entityTypes.includes('ATTACKING')) {\n      return {\n        success: true,\n        alternative: new Action.Say({\n          message: `Ooh I don\\'t know how to attack`,\n          game: this.game,\n          actor: this.actor,\n        }),\n      }\n    }\n\n    let particlePath = [];\n    let particlePos = { x: this.actor.pos.x, y: this.actor.pos.y };\n    let renderer = this.particleTemplate.renderer;\n    this.targetPositions.forEach((targetPos) => {\n      let attackSuccess = this.actor.attack(targetPos);\n      particlePath.push(targetPos);\n      if (attackSuccess) success = true\n    })\n    this.addParticle(\n      particlePath.length + 1, \n      particlePos, \n      null, \n      renderer, \n      Constant.PARTICLE_TYPE.path, \n      particlePath\n    )\n    \n    if (success) { \n      this.actor.energy -= this.energyCost; \n    }\n\n    return {\n      success,\n      alternative,\n    }\n  }\n};\n\nexport class ThrowProjectile extends Move {\n  constructor({ ...args }) {\n    super({ ...args });\n  }\n\n  perform () {\n    let success = false;\n    let alternative = null;\n    this.actor.passable = false;\n    let move_result = super.perform();\n\n    if (move_result.success) {\n      this.actor.path.shift();\n      success = true;\n    }\n    if (this.actor.path.length === 0) {\n      success = true;\n      alternative = new Action.DestroySelf({\n        game: this.game,\n        actor: this.actor,\n        energyCost: Constant.ENERGY_THRESHOLD,\n        processDelay: 0,\n      });\n    }\n    if (move_result.alternative) {\n      let attackSuccess = this.actor.attack(this.targetPos);\n      if (attackSuccess) {\n        alternative = new Action.DestroySelf({\n          game: this.game,\n          actor: this.actor,\n          energyCost: Constant.ENERGY_THRESHOLD,\n          processDelay: 0,\n        });\n      }\n    }\n\n    return {\n      success,\n      alternative,\n    }\n  }\n}\n\nexport class ThrowProjectileGas extends Move {\n  constructor({ ...args }) {\n    super({ ...args });\n    this.processDelay = 0\n  }\n\n  perform () {\n    let success = false;\n    let alternative = null;\n    this.actor.passable = false;\n    let move_result = super.perform();\n    if (move_result.success) {\n      this.actor.path.shift();\n      success = true;\n    } \n    if (this.actor.path.length === 0) {\n      success = true;\n      alternative = new Action.DestroySelf({\n        game: this.game,\n        actor: this.actor,\n        energyCost: Constant.ENERGY_THRESHOLD,\n        processDelay: 0,\n      });\n    }\n    if (move_result.alternative) {\n      this.actor.attack(this.targetPos)\n    }\n\n    return {\n      success,\n      alternative,\n    }\n  }\n}\n\nexport class CrankEngine extends Base {\n  constructor({ engine, ...args }) {\n    super({ ...args });\n    this.engine = engine;\n  }\n  async perform() {\n    let success = true;\n    let alternative = null;\n\n    console.log(`${this.actor.name} is cranking its engine.`);\n    try {\n      await this.engine.start();\n      this.actor.energy -= this.energyCost;\n    } catch (error) {\n      console.log('CrankEngine');\n      console.log(error);\n      alternative = new Action.DestroySelf({\n        game: this.game,\n        actor: this.actor,\n        energyCost: Constant.ENERGY_THRESHOLD,\n      });\n    }\n    \n    return {\n      success,\n      alternative,\n    }\n  }\n};\n","import uuid from 'uuid/v1';\nimport pipe from 'lodash/fp/pipe';\nimport * as Helper from '../helper';\nimport { destroyEntity } from './Entities/helper';\nimport * as Constant from './constants';\nimport * as Action from './actions';\nimport * as Engine from './engine';\nimport { cloneDeep, cloneDeepWith } from 'lodash';\n\nexport class Entity {\n  constructor({ game = null, passable = false}) {\n    let id = uuid();\n    this.entityTypes = ['Entity']\n    this.id = id;\n    this.game = game;\n    this.passable = passable;\n  }\n}\n\nconst Parent = superclass => class extends superclass {\n  constructor({ children = [], engine = new Engine.CrankEngine({}), ...args }) {\n    super({...args })\n    this.entityTypes = this.entityTypes.concat('PARENT');\n    this.children = children;\n    this.engine = engine;\n    this.isInitialized = false;\n  }\n\n  destroyChild(child) {\n    child.energy = 0;\n    let tile = this.game.map[Helper.coordsToString(child.pos)];\n    this.game.map[Helper.coordsToString(child.pos)].entities = tile.entities.filter((e) => e.id !== child.id);\n    this.engine.actors = this.engine.actors.filter((e) => e.id !== child.id);\n    this.game.draw()\n  }\n\n  canAttack (entity) {\n    const childIds = this.children.map((child) => child.id); \n    return !childIds.includes(entity.id)\n  }\n  \n  initialize() {\n    this.isInitialized = true;\n    this.engine.game = this.game;\n    this.engine.actors = this.children;\n    this.engine.actors.forEach((actor) => {\n      actor.game = this.game;\n      actor.destroy = () => {this.destroyChild(actor)};\n      actor.canAttack = this.canAttack.bind(this);\n      // actor.canAttack = (entity) => {this.canAttack(entity)};\n      this.game.placeActorOnMap(actor)\n      this.engine.addActor(actor);\n      this.game.draw();\n    });\n  }\n\n  getAction(game) {\n    // crank engine one turn\n    if (!this.isInitialized) {\n      this.initialize()\n    }\n\n    let result = new Action.CrankEngine({\n      game,\n      actor: this,\n      engine: this.engine,\n      energyCost: Constant.ENERGY_THRESHOLD,\n      processDelay: 10\n    });\n\n    return result;\n  }\n\n}\n\nconst HasInnerGates = superclass => class extends superclass {\n  constructor({ currentGate = null, gates = [], ...args }) {\n    super({ ...args })\n    this.entityTypes = this.entityTypes.concat('HAS_INNER_GATES');\n    this.currentGate = currentGate;\n    this.gates = [\n      {\n        name: 'Gate of Opening',\n        damageBuff: 1,\n        speedBuff: 100,\n        durabilityDebuff: 1,\n      },\n      {\n        name: 'Gate of Healing',\n        damageBuff: 1,\n        speedBuff: 100,\n        durabilityDebuff: 1,\n      },\n      {\n        name: 'Gate of Life',\n        damageBuff: 1,\n        speedBuff: 100,\n        durabilityDebuff: 1,\n      },\n      {\n        name: 'Gate of Pain',\n        damageBuff: 1,\n        speedBuff: 100,\n        durabilityDebuff: 1,\n      },\n      {\n        name: 'Gate of Limit',\n        damageBuff: 1,\n        speedBuff: 100,\n        durabilityDebuff: 1,\n      },\n    ];\n  }\n\n  setNextGate() {\n    let currentGate = this.currentGate;\n    let nextGate = null;\n    if (!currentGate) {\n      nextGate = this.gates[0];\n      this.currentGate = { ...nextGate };\n    } else {\n      let nextGateIndex = this.gates.findIndex((gate) => currentGate.name === gate.name) + 1;\n      console.log('next gate index ', nextGateIndex);\n\n      if (this.gates.length > nextGateIndex) {\n        nextGate = this.gates[nextGateIndex];\n        this.currentGate = { ...nextGate };\n      }\n    }\n    return nextGate;\n  }\n\n  getNextGate() {\n    let currentGate = this.currentGate;\n    let nextGate = null;\n    if (!currentGate) {\n      nextGate = this.gates[0];\n    } else {\n      let nextGateIndex = this.gates.findIndex((gate) => currentGate.name === gate.name) + 1;\n      console.log('next gate index ', nextGateIndex);\n\n      if (this.gates.length > nextGateIndex) {\n        nextGate = this.gates[nextGateIndex];\n      }\n    }\n    return nextGate;\n  }\n}\n\nconst UI = superclass => class extends superclass {\n  constructor({ initiatedBy = null, ...args }) {\n    super({...args })\n    this.entityTypes = this.entityTypes.concat('UI');\n    this.initiatedBy = initiatedBy;\n    this.active = true;\n  }\n\n  hasEnoughEnergy() {\n    return this.active;\n  }\n}\n\nexport const Attacking = superclass => class extends superclass {\n  constructor({attackDamage = 1, ...args }) {\n    super({ ...args })\n    this.entityTypes = this.entityTypes.concat('ATTACKING')\n    this.attackDamage = attackDamage;\n  }\n\n  getAttackDamage (additional = 0) {\n    return this.attackDamage + additional;\n  }\n\n  canAttack (entity) {\n    return true;\n  }\n\n  attack (targetPos, additional = 0) {\n    let success = false;\n    let tile = this.game.map[Helper.coordsToString(targetPos)]\n    if (!tile) { return success }\n    let targets = Helper.getDestructableEntities(tile.entities);\n    if (targets.length > 0) {\n      let target = targets[0];\n      if (this.canAttack(target)) {\n        let damage = this.getAttackDamage(additional);\n        if (this.entityTypes.includes('EQUIPING')) {\n          this.equipment.forEach((slot) => {\n            if (slot.item) {\n              if (slot.item.entityTypes.includes('ATTACKING')) {\n                damage += slot.item.getAttackDamage();\n              }\n            }\n          });\n        }\n        console.log(`${this.name} does ${damage} to ${target.name}`);\n        target.decreaseDurability(damage);\n        success = true;\n      }\n    }\n\n    return success;\n  }\n}\n\nexport const Equipable = superclass => class extends superclass {\n  constructor({name = 'nameless', equipmentType = Constant.EQUIPMENT_TYPES.HAND, ...args }) {\n    super({ ...args })\n    this.entityTypes = this.entityTypes.concat('EQUIPABLE')\n    this.name = name;\n    this.equipmentType = equipmentType;\n  }\n}\n\nconst Acting = superclass => class extends superclass {\n  constructor({name, actions = [], speed = 100, energy = 0, ...args}) {\n    super({...args})\n    this.entityTypes = this.entityTypes.concat('ACTING')\n    this.name = name;\n    this.actions = actions;\n    this.speed = speed;\n    this.energy = speed;\n  }\n\n  getAction() {\n    let action = Helper.getRandomInArray(this.actions)\n    if (action) { return action }\n  }\n\n  gainEnergy(value = this.speed) {\n    this.energy += value;\n  }\n\n  hasEnoughEnergy() {\n    return this.energy > 0;\n  }\n}\n\nconst Rendering = superclass => class extends superclass {\n  constructor({pos = {x: 0, y: 0}, renderer, ...args}) {\n    super({...args})\n    this.entityTypes = this.entityTypes.concat('RENDERING')\n    this.pos = pos;\n    this.renderer = {...renderer};\n  }\n\n  getPosition () {\n    return this.pos;\n  }\n\n  move (targetPos) {\n    let success = false;\n    if (this.game.canOccupyPosition(targetPos, this)) {\n      let tile = this.game.map[Helper.coordsToString(this.pos)]\n      this.game.map[Helper.coordsToString(this.pos)] = { ...tile, entities: tile.entities.filter((e) => e.id !== this.id) }\n      this.pos = targetPos\n      this.game.map[Helper.coordsToString(targetPos)].entities.push(this);\n      success = true;\n    }\n    return success;\n  }\n\n  shove (targetPos, direction) {\n    let success = false;\n    let targetTile = this.game.map[Helper.coordsToString(targetPos)];\n    if (targetTile) {\n      targetTile.entities.map((entity) => { \n        if (!entity.passable) {\n          let newX = entity.pos.x + direction[0];\n          let newY = entity.pos.y + direction[1];\n          let newPos = { x: newX, y: newY };\n          entity.move(newPos);\n        }\n      });\n    }\n    success = this.move(targetPos);\n    return success;\n  }\n}\n\nconst Containing = superclass => class extends superclass {\n  constructor({container = [], ...args}) {\n    super({...args})\n    this.entityTypes = this.entityTypes.concat('CONTAINING')\n    this.container = container;\n  }\n\n  contains (itemType) {\n    let container = this.container;\n    let items = container.filter((item) => item.name === itemType);\n    return items.length > 0 ? items[0] : false;\n  }\n\n  addToContainer (item) {\n    this.container.push(item);\n  }\n  \n  removeFromContainer (item) {\n    this.container = this.container.filter((it) => it.id !== item.id);\n  }\n}\n\nconst Equiping = superclass => class extends superclass {\n  constructor({equipment = Constant.EQUIPMENT_LAYOUTS.human(), ...args}) {\n    super({...args})\n    this.entityTypes = this.entityTypes.concat('EQUIPING')\n    this.equipment = equipment;\n  }\n\n  getItemInSlot (slotName) {\n    let openSlots = this.equipment.filter((slot) => {\n      return (slot.item === null && slot.type === slotName)\n    })\n    if (openSlots.length > 0) { return false; }\n    let slot = this.equipment.find((slot) => slot.type === slotName);\n    if (!slot) { return false; }\n    if (!slot.item) { return false; }\n    return slot.item;\n  }\n\n  equip (slotName, item) {\n    let foundSlot = false;\n    this.equipment = this.equipment.map((slot) => {\n      if (!foundSlot && slot.type === slotName && slot.item === null) {\n        slot.item = item;\n        foundSlot = true;\n      }\n      return slot;\n    })\n  }\n  \n  unequip(item) {\n    this.equipment = this.equipment.map((slot) => {\n      if (slot.item) {\n        if (slot.item.id === item.id) {\n          slot.item = null;\n        }\n      }\n      return slot;\n    })\n  }\n}\n\nconst Charging = superclass => class extends superclass {\n  constructor({charge = 10, ...args}) {\n    super({...args})\n    this.entityTypes = this.entityTypes.concat('CHARGING')\n    this.charge = charge;\n    this.chargeMax = charge;\n  }\n\n  decreaseCharge(value) {\n    this.charge = Math.max(0, this.charge - value);\n  }\n  \n  increaseCharge(value) {\n    this.charge = Math.min(this.chargeMax, this.charge + value);\n  }\n}\n\nconst Signing = superclass => class extends superclass {\n  constructor({...args}) {\n    super({...args})\n    this.entityTypes = this.entityTypes.concat('SIGNING')\n    this.signHistory = [];\n  }\n\n  addSign(sign) {\n    if (this.signHistory.length >= 4) {\n      this.signHistory.shift();\n    }\n    this.signHistory.push(sign);\n  }\n  \n  clearSigns() {\n    this.signHistory = [];\n  }\n}\n\nconst Playing = superclass => class extends superclass {\n  constructor({keymap = {}, ...args}) {\n    super({...args})\n    this.entityTypes = this.entityTypes.concat('PLAYING')\n    this.nextAction = null;\n    this.keymap = keymap;\n  }\n\n    setNextAction(action) {\n      this.nextAction = action;\n    }\n\n    getAction() {\n      let action = this.nextAction;\n      this.nextAction = null;\n      return action;\n    }\n}\n\nconst Cloning = superclass => class extends superclass {\n  constructor({cloneLimit = 1, ...args}) {\n    super({...args})\n    this.entityTypes = this.entityTypes.concat('CLONING')\n    this.cloneLimit = cloneLimit;\n    this.clones = [];\n  }\n  \n  // perhaps clones should have a status effect that leeches parent actor's energy or chakra\n  \n  // status effects should be removed from engine when owner is removed.\n  \n  destroy() {\n    // add function to override self destroy funtion \n    // if this actor dies, clones should be destroyed as well\n    if (this.clones) {\n      this.clones.map((clone) => {\n        destroyEntity(clone)\n      });\n    }\n    destroyEntity(this);\n  }\n\n  destroyClone (id) {\n  // overrides clone destroy function\n  // when clone is destroyed, clone count will change accordingly\n    const index = this.clones.findIndex((c) => c.id == id);\n    if (index >= 0) {\n      this.clones[index].super__destroy();\n      this.clones.splice(index, 1);\n    }\n  }\n\n  createClone (cloneArgs) {\n    if (this.clones.length < this.cloneLimit) {\n      let clone = cloneDeep(this);\n      clone.name += ` Clone ${this.clones.length}`\n      clone.game = this.game;\n      clone.id = uuid();\n      delete clone.clones;\n      clone['super__destroy'] = clone.destroy;\n      clone.destroy = () => { this.destroyClone(clone.id) };\n      cloneArgs.forEach((arg) => {\n        clone[arg.attribute] = arg.value\n      });\n      if (this.game.placeActorOnMap(clone)) {\n        this.game.engine.addActorAsNext(clone);\n        this.game.draw();\n        this.clones.push(clone);\n        return true;\n      };\n    }\n    return false;\n  }\n}\n\nconst Projecting = superclass => class extends superclass {\n  constructor({path = false, targetPos = null ,...args}) {\n    super({...args})\n    this.entityTypes = this.entityTypes.concat('PROJECTING')\n    this.path = path;\n    this.targetPos = targetPos;\n  }\n\n  createPath (game) {\n    let path = Helper.calculatePath(game, this.targetPos, this.pos, 8);\n    this.path = path;\n  }\n\n  getAction(game) {\n    if (!this.path) {\n      this.createPath(game);\n    }\n    let targetPos = this.path.length > 0 ? this.path[0] : this.pos;\n    let result = new Action.Move({\n      targetPos, \n      game, \n      actor: this, \n      energyCost: Constant.ENERGY_THRESHOLD\n    });\n    if (this.game.canOccupyPosition(targetPos, this)) {\n      this.path.shift();\n    }\n    return result;\n  }\n}\n\nconst DestructiveProjecting = superclass => class extends superclass {\n  constructor({path = false, targetPos = null, attackDamage = 1, range = 3, ...args}) {\n    super({...args})\n    this.entityTypes = this.entityTypes.concat('DESTRUCTIVE_PROJECTING')\n    this.path = path;\n    this.targetPos = targetPos;\n    this.attackDamage = attackDamage;\n    this.range = range;\n  }\n\n  createPath (game) {\n    let path = Helper.calculatePathWithRange(game, this.targetPos, this.pos, 8, this.range);\n    this.path = path;\n  }\n\n  getAction (game) {\n    if (!this.path) {\n      this.createPath(game);\n    }\n\n    let targetPos = this.path.length > 0 ? this.path[0] : this.pos;\n    \n    let result = new Action.ThrowProjectile({\n      targetPos, \n      game, \n      actor: this, \n      energyCost: Constant.ENERGY_THRESHOLD\n    });\n\n    return result;\n  }\n}\n\nconst DirectionalProjecting = superclass => class extends superclass {\n  constructor({path = false, direction = {x: 0, y: 0}, attackDamage = 1, range = 3, ...args}) {\n    super({...args})\n    this.entityTypes = this.entityTypes.concat('DIRECTIONAL_PROJECTING')\n    this.path = path;\n    this.direction = direction;\n    this.attackDamage = attackDamage;\n    this.range = range;\n  }\n\n  getAction (game) {\n    let result = null;\n    let newX = this.pos.x + this.direction[0];\n    let newY = this.pos.y + this.direction[1];\n    let targetPos = { x: newX, y: newY };\n    this.passable = false\n    console.log(this.range);\n    \n    if (this.range > 0) {\n      result = new Action.ProjectileMove({\n        targetPos: targetPos,\n        game: game,\n        actor: this,\n        energyCost: Constant.ENERGY_THRESHOLD,\n        damageToSelf: 1,\n        onSuccess: () => this.range -= 1\n      })\n    } else {\n      result = new Action.DestroySelf({\n        game: game,\n        actor: this,\n        energyCost: 0\n      })\n    }\n\n    return result;\n  }\n}\n\nconst GaseousDestructiveProjecting = superclass => class extends superclass {\n  constructor({owner_id = null, path = false, targetPos = null, attackDamage = 1, range = 3, ...args}) {\n    super({...args})\n    this.entityTypes = this.entityTypes.concat('GASEOUS_DESTRUCTIVE_PROJECTING')\n    this.path = path;\n    this.targetPos = targetPos;\n    this.attackDamage = attackDamage;\n    this.range = range;\n    this.owner_id = owner_id;\n  }\n\n  canAttack (entity) {\n    let success = super.canAttack();\n    if (success) {\n      success = this.owner_id === null || (entity.owner_id !== this.owner_id);\n    }\n    return success\n  }\n\n  createPath (game) {\n    let path = Helper.calculatePathWithRange(game, this.targetPos, this.pos, 8, this.range);\n    this.path = path;\n  }\n\n  getAction (game) {\n    if (!this.path) {\n      this.createPath(game);\n    }\n    let targetPos = this.path.length > 0 ? this.path[0] : this.pos;\n    \n    let result = new Action.ThrowProjectileGas({\n      targetPos, \n      game, \n      actor: this, \n      energyCost: Constant.ENERGY_THRESHOLD\n    });\n\n    return result;\n  }\n}\n\nconst Gaseous = superclass => class extends superclass {\n  constructor({\n    isClone = false,\n    cloneCount = 0,\n    clonePattern = Constant.CLONE_PATTERNS.square,\n    ...args\n  }) {\n    super({...args})\n    this.entityTypes = this.entityTypes.concat('GASEOUS')\n    this.isClone = isClone;\n    this.cloneCount = cloneCount;\n    this.clonePattern = cloneDeep(clonePattern);\n  }\n\n  getAction (game) {\n    let offset = this.clonePattern.positions.find((pos) => !pos.taken);\n    if (!this.isClone && offset) {\n      offset.taken = true\n      let clone = cloneDeepWith(this, (value, key) => {\n        switch (key) {\n          case 'id':\n          case 'game':\n          case 'engine':\n          case 'clones':\n            return null\n            break;\n          default:\n            return undefined\n            break;\n        }\n      });\n      clone.game = game;\n      clone.id = uuid();\n      if (this.hasOwnProperty('pos')) {\n        let referencePos = this.pos\n        clone.pos = {\n          x: referencePos.x + offset.x,\n          y: referencePos.y + offset.y\n        }\n      }\n      if (clone.hasOwnProperty('path')) {\n        clone.path = clone.path.map((pos) => {\n          return {\n            x: pos.x + offset.x,\n            y: pos.y + offset.y\n          }\n        })\n      }\n      clone.isClone = true\n      this.cloneCount += 1\n      game.placeActorOnMap(clone)\n      game.engine.addActor(clone);\n      game.draw();\n    }\n\n    let result = super.getAction(game);\n    return result;\n  }\n}\n\nconst Chasing = superclass => class extends superclass {\n  constructor({targetEntity = null ,...args}) {\n    super({...args})\n    this.entityTypes = this.entityTypes.concat('CHASING')\n    this.targetEntity = targetEntity;\n  }\n\n  getAction(game) {\n    let path = Helper.calculatePath(game, this.targetEntity.pos, this.pos);\n    let targetPos = path.length > 0 ? path[0] : this.pos;\n\n    let result = new Action.Move({\n      targetPos, \n      game, \n      actor: this, \n      energyCost: Constant.ENERGY_THRESHOLD\n    });\n    return result;\n  }\n}\n\nconst Pushing = superclass => class extends superclass {\n  constructor({ path = false, targetPos = null, ...args }) {\n    super({ ...args })\n    this.entityTypes = this.entityTypes.concat('PUSHING')\n    this.path = path;\n    this.targetPos = targetPos;\n  }\n\n  createPath(game) {\n    let path = Helper.calculatePath(game, this.targetPos, this.pos, 8);\n    this.path = path;\n  }\n\n  getAction(game) {\n    if (!this.path) {\n      this.createPath(game);\n    }\n    let targetPos = this.path.length > 0 ? this.path[0] : this.pos;\n    let direction = [\n      targetPos.x - this.pos.x ,\n      targetPos.y - this.pos.y ,\n    ]\n    if (direction[0] === 0 && direction[1] === 0) {\n      return new Action.DestroySelf({\n        game: game,\n        actor: this,\n        energyCost: Constant.ENERGY_THRESHOLD,\n        processDelay: 0,\n      });\n    }\n    let result = new Action.Shove({\n      targetPos,\n      direction,\n      game,\n      actor: this,\n      energyCost: Constant.ENERGY_THRESHOLD\n    });\n    this.path.shift();\n\n    return result;\n  }\n}\n\nconst Destructable = superclass => class extends superclass {\n  constructor({durability = 1, defense = 0 ,onDestroy = () => null, ...args }) {\n    super({ ...args })\n    this.entityTypes = this.entityTypes.concat('DESTRUCTABLE')\n    this.durability = durability;\n    this.defense = defense;\n    this.onDestroy = onDestroy;\n  }\n\n  getDefense () {\n    // add in reducer to get defense stats of all equpiment\n    return this.defense;\n  }\n\n  decreaseDurabilityWithoutDefense (value) {\n    this.durability -= value;\n    if (this.durability <= 0) {\n      this.destroy();\n    }\n  }\n\n  decreaseDurability (value) {\n    const current = this.durability;\n    const newDurability = current - (value - this.getDefense());\n    this.durability = Math.min(current, newDurability);\n    if (this.durability <= 0) {\n      this.destroy();\n    }\n  }\n\n  increaseDurability (value) {\n    this.durability += value\n  }\n\n  destroy () {\n    this.onDestroy();\n    destroyEntity(this);\n  }\n}\n\nconst IsParticle = superclass => class extends superclass {\n  constructor({\n    pos = { x: 1, y: 1 },\n    direction = { x: 0, y: 0 },\n    life = 1,\n    speed = 1,\n    type = Constant.PARTICLE_TYPE.directional,\n    path = null,\n    ...args\n  }) {\n    super({ ...args })\n    this.pos = pos;\n    this.direction = direction;\n    this.life = life;\n    this.speed = speed;\n    this.type = type;\n    this.path = path;\n    this.entityTypes = this.entityTypes.concat('PARTICLE')\n  }\n\n  getNextPos(step) {\n    switch (this.type) {\n      case Constant.PARTICLE_TYPE.directional:\n        return {\n          x: this.pos.x + (this.direction.x * this.speed) * step,\n          y: this.pos.y + (this.direction.y * this.speed) * step,\n        }\n      case Constant.PARTICLE_TYPE.path:\n        const nextPos = this.path.shift();\n        return nextPos ? {...nextPos} : {...this.pos}\n    }\n  }\n\n  update(step) {\n    this.life -= step;\n    if (this.life > 0) {\n      this.pos = this.getNextPos(step);\n    }\n  }\n}\n\nexport const UI_Actor = pipe(\n  Acting, \n  Rendering, \n  Playing, \n  UI\n)(Entity);\n\nexport const Actor = pipe(\n  Acting, \n  Rendering\n)(Entity);\n\nexport const Wall = pipe(\n  Rendering,\n  Destructable,\n)(Entity);\n\nexport const MovingWall = pipe(\n  Acting,\n  Rendering,\n  Pushing,\n  Destructable,\n)(Entity);\n\nexport const Chaser = pipe(\n  Acting, \n  Rendering, \n  Chasing, \n  Destructable\n)(Entity);\n\nexport const Bandit = pipe(\n  Acting, \n  Rendering, \n  Chasing, \n  Destructable,\n  Attacking,\n)(Entity);\n\nexport const Player = pipe(\n  Acting, \n  Rendering, \n  Charging, \n  Signing, \n  Containing, \n  Equiping, \n  Attacking, \n  HasInnerGates,\n  Destructable, \n  Cloning,\n  Playing,\n)(Entity);\n\nexport const Weapon = pipe(\n  Rendering, \n  Equipable, \n  Attacking\n)(Entity);\n\nexport const DestructiveProjectile = pipe(\n  Acting, \n  Rendering, \n  Attacking, \n  DestructiveProjecting, \n  Destructable\n)(Entity);\n\nexport const DirectionalProjectile = pipe(\n  Acting, \n  Rendering, \n  Attacking, \n  DirectionalProjecting, \n  Destructable\n)(Entity);\n\nexport const DestructiveCloudProjectile = pipe(\n  Acting, \n  Rendering, \n  Attacking, \n  GaseousDestructiveProjecting, \n  Destructable, \n  Gaseous\n)(Entity);\n\nexport const DestructiveCloudProjectileV2 = pipe(\n  Acting, \n  Destructable,\n  Parent, \n)(Entity);\n\nexport const Particle = pipe(\n  Acting,\n  Rendering,\n  IsParticle,\n)(Entity);\n\nexport const ParticleEmitter = pipe(\n  Acting, \n  Destructable,\n  Parent, \n)(Entity);","import * as Entity from './entites';\nimport * as Constant from './constants';\nimport * as Helper from '../helper';\n\nexport const TYPE = {\n  KUNAI: 'Kunai',\n  SWORD: 'Sword',\n  BARRIER: 'Barrier',\n}\n\nconst createProjectileCloud = ({ \n  engine, \n  actor, \n  targetPos, \n  throwDirection,\n  speed,\n  structureType,\n  createProjectile,\n}) => {\n  let structure = Constant.CLONE_PATTERNS[structureType];\n\n  let children = structure.positions.map((slot) => {\n    let position = {\n      x: actor.pos.x + slot.x + (throwDirection.x * structure.x_offset),\n      y: actor.pos.y + slot.y + (throwDirection.y * structure.y_offset)\n    }\n    \n    let targetPosition = {\n      x: targetPos.x + slot.x,\n      y: targetPos.y + slot.y,\n    }\n\n    return createProjectile(engine, position, targetPosition);\n  })\n\n  return new Entity.DestructiveCloudProjectileV2({\n    game: engine.game,\n    passable: true,\n    speed,\n    children,\n  })\n}\n\nconst createProjectileSingularity = ({ \n  engine, \n  actor, \n  targetPos, \n  speed,\n  structureType,\n  createProjectile,\n}) => {\n  let structure = Constant.CLONE_PATTERNS[structureType];\n\n  let children = structure.positions.map((slot) => {\n    let position = {\n      x: targetPos.x + slot.x + structure.x_offset,\n      y: targetPos.y + slot.y + structure.y_offset\n    }\n\n    let targetPosition = {\n      x: targetPos.x,\n      y: targetPos.y,\n    }\n\n    return createProjectile(engine, position, targetPosition);\n\n  })\n\n  return new Entity.DestructiveCloudProjectileV2({\n    game: engine.game,\n    passable: true,\n    speed,\n    children,\n  })\n}\n\nconst createProjectileBurst = ({ \n  engine, \n  actor, \n  targetPos, \n  speed,\n  structureType,\n  createProjectile,\n}) => {\n  let structure = Constant.CLONE_PATTERNS[structureType];\n\n  let children = structure.positions.map((slot) => {\n    let position = {\n      x: targetPos.x + structure.x_offset,\n      y: targetPos.y + structure.y_offset\n    }\n\n    let targetPosition = {\n      x: targetPos.x + slot.x,\n      y: targetPos.y + slot.y,\n    }\n\n    return createProjectile(engine, position, targetPosition);\n\n  })\n\n  return new Entity.DestructiveCloudProjectileV2({\n    game: engine.game,\n    passable: true,\n    speed,\n    children,\n  })\n}\n\nexport const sandTomb = ({\n  engine,\n  actor,\n  targetPos,\n}) => createProjectileSingularity({\n  engine,\n  actor,\n  targetPos,\n  speed: 100,\n  structureType: 'circle',\n  createProjectile: sandShuriken,\n})\n\nexport const sandBurst = ({\n  engine,\n  actor,\n  targetPos,\n}) => createProjectileBurst({\n  engine,\n  actor,\n  targetPos,\n  speed: 500,\n  structureType: 'circle',\n  createProjectile: sandShuriken,\n})\n\nexport const sandWallPulse = ({\n  engine,\n  actor,\n  targetPos,\n  throwDirection,\n}) => createProjectileCloud({\n  engine,\n  actor,\n  targetPos,\n  throwDirection,\n  speed: 500,\n  structureType: 'smallSquare',\n  createProjectile: movingSandWall,\n})\n\nexport const kunaiCloud = ({\n  engine,\n  actor,\n  targetPos,\n  throwDirection,\n}) => createProjectileCloud({\n  engine,\n  actor,\n  targetPos,\n  throwDirection,\n  speed: 500,\n  structureType: 'square',\n  createProjectile: kunai,\n})\n\nexport const fireballCloud = ({\n  engine,\n  actor,\n  targetPos,\n  throwDirection,\n}) => createProjectileCloud({\n  engine,\n  actor,\n  targetPos,\n  throwDirection,\n  speed: 500,\n  structureType: 'square',\n  createProjectile: fireball,\n})\n\nexport const kunai = (engine, pos, targetPos) => new Entity.DestructiveProjectile({\n  game: engine.game,\n  targetPos,\n  passable: true,\n  pos: { x: pos.x, y: pos.y },\n  renderer: {\n    // character: '>',\n    character: '',\n    color: 'white',\n    background: '',\n  },\n  name: TYPE.KUNAI,\n  speed: 600,\n  energy: 0,\n  range: 30,\n})\n\nexport const directionalKunai = (engine, pos, direction, range) => new Entity.DirectionalProjectile({\n  game: engine.game,\n  direction,\n  passable: true,\n  pos: { x: pos.x, y: pos.y },\n  renderer: {\n    character: '>',\n    color: 'white',\n    background: '',\n  },\n  name: 'directionalKunai',\n  speed: 600,\n  energy: 0,\n  range,\n})\n\nexport const movingSandWall = (engine, pos, targetPos) => new Entity.MovingWall({\n  game: engine.game,\n  passable: false,\n  pos: { x: pos.x, y: pos.y },\n  targetPos,\n  renderer: {\n    // character: '>',\n    character: ']',\n    color: '#A89078',\n    background: '#D8C0A8',\n  },\n  name: TYPE.KUNAI,\n  // name: TYPE.BARRIER,\n  durability: 3,\n})\n\nexport const sandShuriken = (engine, pos, targetPos) => new Entity.DestructiveProjectile({\n  game: engine.game,\n  targetPos,\n  passable: true,\n  pos: { x: pos.x, y: pos.y },\n  renderer: {\n    // character: '>',\n    character: '',\n    color: '#A89078',\n    background: '#D8C0A8',\n  },\n  name: TYPE.KUNAI,\n  speed: 600,\n  energy: 0,\n  range: 30,\n})\n\nexport const fireball = (engine, pos, targetPos) => new Entity.DestructiveProjectile({\n  game: engine.game,\n  targetPos,\n  passable: true,\n  pos: { x: pos.x, y: pos.y },\n  renderer: {\n    // character: '>',\n    character: '',\n    color: 'wheat',\n    background: 'tomato',\n  },\n  name: TYPE.KUNAI,\n  speed: 100,\n  energy: 0,\n  range: 30,\n})\n\nexport const fireballGas = (engine, actor, targetPos) => {\n  return new Entity.DestructiveCloudProjectile({\n    game: engine.game,\n    owner_id: actor ? actor.id : null,\n    targetPos,\n    passable: true,\n    pos: actor ? { x: actor.pos.x, y: actor.pos.y } : null,\n    renderer: {\n      // character: '@',\n      character: '',\n      color: 'wheat',\n      background: 'tomato',\n    },\n    name: TYPE.KUNAI,\n    speed: 100,\n    range: 10,\n    clonePattern: Constant.CLONE_PATTERNS.bigSquare,\n    // clonePattern: Constant.CLONE_PATTERNS.square,\n  })\n}\n\nexport const waterball = (engine, actor, targetPos) => new Entity.DestructiveCloudProjectile({\n  game: engine.game,\n  owner_id: actor ? actor.id : null,\n  targetPos,\n  passable: true,\n  pos: actor ? { x: actor.pos.x, y: actor.pos.y } : null,\n  renderer: {\n    // character: '~',\n    character: '',\n    color: 'silver',\n    background: 'lightslategrey',\n  },\n  name: TYPE.KUNAI,\n  speed: 800,\n  range: 10,\n  clonePattern: Constant.CLONE_PATTERNS.bigSquare,\n  // clonePattern: Constant.CLONE_PATTERNS.square,\n})\n\nexport const sword = (engine) => new Entity.Weapon({\n  game: engine.game,\n  name: TYPE.SWORD,\n  passable: true,\n  attackDamage: 1,\n  equipmentType: Constant.EQUIPMENT_TYPES.HAND,\n  renderer: {\n    // character: '|',\n    character: '',\n    color: 'white',\n    background: '',\n  },\n})\n\nexport const test = (engine, pos) => new Entity.Weapon({\n  game: engine.game,\n  name: TYPE.SWORD,\n  passable: true,\n  attackDamage: 1,\n  pos,\n  equipmentType: Constant.EQUIPMENT_TYPES.HAND,\n  renderer: {\n    // character: '|',\n    character: '',\n    color: 'white',\n    background: 'lightsteelblue',\n  },\n})\n","import { ALPHABET } from '../constants';\n\nexport const addAlphabeticallyToKeymap = (keymap, obj) => {\n  let alphabetAllowed = ALPHABET.filter((letter) => {\n    return !Object.keys(keymap).includes(letter);\n  });\n  keymap[alphabetAllowed[0]] = obj;\n}\n\nexport const deactivateUIKeymap = (engine, visibleUIKey) => {\n  let currentUiActor = engine.actors[engine.currentActor];\n  engine.game.removeActor(currentUiActor);\n  engine.game[visibleUIKey] = null;\n}","import * as Constant from '../../constants';\nimport { UI_Actor } from '../../entites';\nimport { DropItem } from '../../actions';\nimport { addAlphabeticallyToKeymap, deactivateUIKeymap } from '../helper';\n\nconst keymapDropFromInventory = (engine, initiatedBy) => {\n  let keymap = {\n    Escape: {\n      // g: {\n      activate: () => deactivateUIKeymap(engine, 'visibleInventory'),\n      label: 'Close',\n    }\n  };\n\n  initiatedBy.container.map((item, index) => {\n    let obj = {\n      activate: null,\n      label: ''\n    }\n    obj['activate'] = () => {\n      console.log(`setting action for ${initiatedBy.name} to drop ${item.name}`);\n      initiatedBy.setNextAction(new DropItem({\n        item,\n        game: engine.game,\n        actor: initiatedBy,\n        energyCost: Constant.ENERGY_THRESHOLD\n      }));\n      deactivateUIKeymap(engine, 'visibleInventory');\n    }\n    obj['label'] = `Drop ${item.name}`;\n    addAlphabeticallyToKeymap(keymap, obj);\n    return true;\n  })\n\n  return keymap;\n}\n\nexport const activateDropItem = (engine) => {\n  let currentActor = engine.actors[engine.currentActor]\n  engine.game.visibleInventory = currentActor.container;\n\n  let ui = new UI_Actor({\n    initiatedBy: currentActor,\n    pos: { ...currentActor.pos },\n    renderer: {\n      character: 'D',\n      color: 'white',\n      background: '',\n    },\n    name: 'Drop',\n    game: engine.game,\n  })\n  engine.addActorAsPrevious(ui);\n  engine.game.placeActorOnMap(ui)\n  engine.game.draw()\n  ui.keymap = keymapDropFromInventory(engine, currentActor);\n}","import { UI_Actor } from '../../entites';\nimport { UnequipItem } from '../../actions';\nimport { addAlphabeticallyToKeymap, deactivateUIKeymap } from '../helper';\n\nconst keymapEquipment = (engine, initiatedBy) => {\n  let keymap = {\n    Escape: {\n      activate: () => deactivateUIKeymap(engine, 'visibleEquipment'),\n      label: 'Close',\n    }\n  };\n\n  initiatedBy.equipment.filter((slot) => slot.item).map((slot) => {\n    let obj = {\n      activate: null,\n      label: ''\n    }\n    obj['activate'] = () => {\n      console.log(`setting action for ${initiatedBy.name} to unequip ${slot.item.name}`);\n      initiatedBy.setNextAction(new UnequipItem({\n        item: slot.item,\n        game: engine.game,\n        actor: initiatedBy,\n      }))\n      deactivateUIKeymap(engine, 'visibleEquipment');\n    }\n    obj['label'] = `Unequip ${slot.name}`;\n    addAlphabeticallyToKeymap(keymap, obj);\n    return true;\n  })\n\n  return keymap;\n}\n\nexport const activateEquipment = (engine) => {\n  let currentActor = engine.actors[engine.currentActor]\n  engine.game.visibleEquipment = currentActor.equipment;\n\n  let ui = new UI_Actor({\n    initiatedBy: currentActor,\n    pos: { ...currentActor.pos },\n    renderer: {\n      character: 'E',\n      color: 'white',\n      background: '',\n    },\n    name: 'Equipment',\n    game: engine.game,\n  })\n  engine.addActorAsPrevious(ui);\n  engine.game.placeActorOnMap(ui)\n  engine.game.draw()\n  ui.keymap = keymapEquipment(engine, currentActor);\n}","import { UI_Actor } from '../../entites';\nimport { EquipItemFromContainer } from '../../actions';\nimport { addAlphabeticallyToKeymap, deactivateUIKeymap } from '../helper';\n\nconst keymapEquipFromInventory = (engine, initiatedBy) => {\n  let keymap = {\n    Escape: {\n      activate: () => deactivateUIKeymap(engine, 'visibleInventory'),\n      label: 'Close',\n    }\n  };\n\n  initiatedBy.container.map((item, index) => {\n    let obj = {\n      activate: null,\n      label: ''\n    }\n    obj['activate'] = () => {\n      console.log(`setting action for ${initiatedBy.name} to equip ${item.name}`);\n      initiatedBy.setNextAction(new EquipItemFromContainer({\n        item,\n        game: engine.game,\n        actor: initiatedBy,\n      }))\n      deactivateUIKeymap(engine, 'visibleInventory');\n    }\n    obj['label'] = `Equip ${item.name}`;\n    addAlphabeticallyToKeymap(keymap, obj);\n    return true;\n  })\n\n  return keymap;\n}\n\nexport const activateInventory = (engine) => {\n  let currentActor = engine.actors[engine.currentActor]\n  engine.game.visibleInventory = currentActor.container;\n\n  let ui = new UI_Actor({\n    initiatedBy: currentActor,\n    pos: { ...currentActor.pos },\n    renderer: {\n      character: 'I',\n      color: 'white',\n      background: '',\n    },\n    name: 'Inventory',\n    game: engine.game,\n    // keymap: keymapEquipFromInventory(engine, currentActor),\n  })\n  engine.addActorAsPrevious(ui);\n  engine.game.placeActorOnMap(ui)\n  engine.game.draw()\n  ui.keymap = keymapEquipFromInventory(engine, currentActor);\n}","import * as Action from '../../actions';\nimport * as Constant from '../../constants';\nimport { UI_Actor } from '../../entites';\n\nconst throwDirectionalKunai = (direction, engine, actor) => {\n  let cursor = engine.actors[engine.currentActor];\n  cursor.active = false;\n  let throwDirection = {\n    x: Math.sign(cursor.pos.x - actor.pos.x),\n    y: Math.sign(cursor.pos.y - actor.pos.y),\n  }\n  engine.game.removeActor(cursor);\n  let kunai = actor.contains('directionalKunai');\n  if (kunai) {\n    kunai.game = engine.game;\n    kunai.pos = {\n      x: actor.pos.x + throwDirection.x,\n      y: actor.pos.y + throwDirection.y,\n    };\n    kunai.direction = direction;\n    actor.removeFromContainer(kunai);\n    engine.addActorAsPrevious(kunai);\n    engine.game.placeActorsOnMap();\n    engine.game.draw();\n    actor.setNextAction(\n      new Action.Say({\n        message: `I'll get you with this kunai!`,\n        game: engine.game,\n        actor,\n        energyCost: Constant.ENERGY_THRESHOLD\n      })\n    )\n  } else {\n    console.log('I have no kunais left');\n  }\n}\n\nconst keymapCursorToThrowItem = (engine, initiatedBy) => {\n  return {\n    w: {\n      activate: () => throwDirectionalKunai(Constant.DIRECTIONS.N, engine, initiatedBy),\n      label: 'throw N',\n    },\n    e: {\n      activate: () => throwDirectionalKunai(Constant.DIRECTIONS.NE, engine, initiatedBy),\n      label: 'throw NE',\n    },\n    d: {\n      activate: () => throwDirectionalKunai(Constant.DIRECTIONS.E, engine, initiatedBy),\n      label: 'throw E',\n    },\n    c: {\n      activate: () => throwDirectionalKunai(Constant.DIRECTIONS.SE, engine, initiatedBy),\n      label: 'throw SE',\n    },\n    x: {\n      activate: () => throwDirectionalKunai(Constant.DIRECTIONS.S, engine, initiatedBy),\n      label: 'throw S',\n    },\n    z: {\n      activate: () => throwDirectionalKunai(Constant.DIRECTIONS.SW, engine, initiatedBy),\n      label: 'throw SW',\n    },\n    a: {\n      activate: () => throwDirectionalKunai(Constant.DIRECTIONS.W, engine, initiatedBy),\n      label: 'throw W',\n    },\n    q: {\n      activate: () => throwDirectionalKunai(Constant.DIRECTIONS.NW, engine, initiatedBy),\n      label: 'throw NW',\n    },\n  };\n}\n\nexport const activateThrow = (engine) => {\n  let game = engine.game;\n  let currentActor = engine.actors[game.engine.currentActor]\n  let pos = currentActor.pos;\n\n  let cursor = new UI_Actor({\n    initiatedBy: currentActor,\n    pos,\n    renderer: {\n      character: '',\n      color: 'white',\n      background: '',\n    },\n    name: 'Cursor',\n    game,\n    keymap: keymapCursorToThrowItem(engine, currentActor),\n  })\n  engine.addActorAsPrevious(cursor);\n  engine.game.placeActorOnMap(cursor)\n  engine.game.draw()\n}","import { Move } from '../../actions';\nimport * as Constant from '../../constants';\n\nexport const walk = (direction, engine) => {\n  let actor = engine.actors[engine.currentActor];\n  let newX = actor.pos.x + direction[0];\n  let newY = actor.pos.y + direction[1];\n  actor.setNextAction(new Move({\n    targetPos: { x: newX, y: newY },\n    game: engine.game,\n    actor,\n    energyCost: Constant.ENERGY_THRESHOLD\n  }))\n}","import * as Helper from '../../../helper';\nimport { Bandit } from '../../entites';\n\nconst getBanditStats = () => {\n  let banditLevels = [\n    {\n      name: 'Ross',\n      renderer: {\n        character: Helper.getRandomInArray(['']),\n        color: '#ced5dd',\n        background: '',\n      },\n      durability: 1,\n      attackDamage: 1,\n      speed: 100,\n    },\n    {\n      name: 'Kevin',\n      renderer: {\n        character: Helper.getRandomInArray(['']),\n        color: '#3fc072',\n        background: '',\n      },\n      durability: 2,\n      attackDamage: 1,\n      speed: 100,\n    },\n    {\n      name: 'Jacob',\n      renderer: {\n        character: Helper.getRandomInArray(['']),\n        color: '#67a1d7',\n        background: '',\n      },\n      durability: 3,\n      attackDamage: 1,\n      speed: 100,\n    },\n    {\n      name: 'Jarod',\n      renderer: {\n        character: Helper.getRandomInArray(['']),\n        color: '#e16264',\n        background: '',\n      },\n      durability: 1,\n      attackDamage: 5,\n      speed: 300,\n    },\n    {\n      name: 'Bigii',\n      renderer: {\n        character: Helper.getRandomInArray(['']),\n        color: '#9f62e1',\n        background: '',\n      },\n      durability: 15,\n      attackDamage: 10,\n      speed: 100,\n    },\n  ]\n  return Helper.getRandomInArray(banditLevels);\n\n}\n\nexport const addActor = (game) => {\n  let targetEntity = game.engine.actors[game.engine.currentActor]\n  let pos = Helper.getRandomPos(game.map).coordinates\n  const banditStats = getBanditStats();\n  let actor = new Bandit({\n    targetEntity,\n    pos,\n    renderer: banditStats.renderer,\n    name: banditStats.name,\n    game,\n    actions: [],\n    attackDamage: banditStats.attackDamage,\n    durability: banditStats.durability,\n    speed: banditStats.speed,\n  })\n  // game.placeActorOnMap(actor)\n  if (game.randomlyPlaceActorOnMap(actor)) {\n    game.engine.addActor(actor);\n    game.draw();\n  };\n}","import { CursorMove } from '../../actions';\n\nexport const moveCursor = (direction, engine) => {\n  let actor = engine.actors[engine.currentActor];\n  let newX = actor.pos.x + direction[0];\n  let newY = actor.pos.y + direction[1];\n  actor.setNextAction(new CursorMove({\n    targetPos: { x: newX, y: newY },\n    game: engine.game,\n    actor,\n    energyCost: 0,\n  }))\n}","import { PickupItem } from '../../actions';\nimport { ENERGY_THRESHOLD } from '../../constants';\nimport { coordsToString, getRandomInArray } from '../../../helper';\n\nexport const pickupRandom = (engine) => {\n  let actor = engine.actors[engine.currentActor];\n  let entities = engine.game.map[coordsToString(actor.pos)].entities.filter((e) => e.id !== actor.id);\n  if (entities.length > 0) {\n    actor.setNextAction(new PickupItem({\n      item: getRandomInArray(entities),\n      game: engine.game,\n      actor,\n      energyCost: ENERGY_THRESHOLD\n    }));\n  }\n  else {\n    console.log('nothing to pickup.');\n  }\n};","import { Sign, SignRelease } from '../../actions';\nimport { ENERGY_THRESHOLD, HAND_SIGNS } from '../../constants';\n\n/******************** PLAYER ********************/\nexport const sign = (sign, engine) => {\n  let actor = engine.actors[engine.currentActor];\n  actor.setNextAction(new Sign({\n    sign,\n    game: engine.game,\n    actor,\n    energyCost: ENERGY_THRESHOLD\n  }));\n};\n\nexport const signRelease = (engine) => {\n  let actor = engine.actors[engine.currentActor];\n  actor.setNextAction(new SignRelease({\n    requiredSequence: [\n      HAND_SIGNS.Power,\n      HAND_SIGNS.Healing,\n    ],\n    game: engine.game,\n    actor,\n    energyCost: ENERGY_THRESHOLD\n  }));\n};","import { Tackle } from '../../actions';\nimport { ENERGY_THRESHOLD, DIRECTIONS, PARTICLE_TEMPLATES } from '../../constants';\n\nconst flyingLotus = (direction, stepCount, energyCost, additionalAttackDamage, engine) => {\n  let actor = engine.actors[engine.currentActor];\n  actor.setNextAction(new Tackle({\n    direction,\n    stepCount,\n    game: engine.game,\n    actor,\n    additionalAttackDamage,\n    energyCost,\n    particleTemplate: PARTICLE_TEMPLATES.leaf\n  }))\n}\n\nconst keymapFlyingLotus = (engine, initiatedBy, previousKeymap) => {\n  const energyCost = Math.floor(ENERGY_THRESHOLD / 2);\n  const stepCount = Math.floor(initiatedBy.energy / energyCost) - 1;\n  const additionalAttackDamage = stepCount;\n  const goToPreviousKeymap = () => initiatedBy.keymap = previousKeymap;\n  return {\n    Escape: {\n      activate: goToPreviousKeymap,\n      label: 'Close',\n    },\n    w: {\n      activate: () => {\n        flyingLotus(DIRECTIONS.N, stepCount, energyCost, additionalAttackDamage, engine);\n        goToPreviousKeymap();\n      },\n      label: 'activate N',\n    },\n    d: {\n      activate: () => {\n        flyingLotus(DIRECTIONS.E, stepCount, energyCost, additionalAttackDamage, engine);\n        goToPreviousKeymap();\n      },\n      label: 'activate E',\n    },\n    s: {\n      activate: () => {\n        flyingLotus(DIRECTIONS.S, stepCount, energyCost, additionalAttackDamage, engine);\n        goToPreviousKeymap();\n      },\n      label: 'activate S',\n    },\n    a: {\n      activate: () => {\n        flyingLotus(DIRECTIONS.W, stepCount, energyCost, additionalAttackDamage, engine);\n        goToPreviousKeymap();\n      },\n      label: 'activate W',\n    },\n  };\n}\n\nexport const activateFlyingLotus = (engine) => {\n  let currentActor = engine.actors[engine.currentActor]\n  currentActor.keymap = keymapFlyingLotus(engine, currentActor, { ...currentActor.keymap });\n}","export class Base {\n  constructor({ \n    game, \n    actor, \n    name = 'Effect', \n    lifespan = 100,\n    stepInterval = 100,\n    allowDuplicates = true,\n    onStart = () => null,\n    onStep = () => null,\n    onStop = () => null,\n  }) {\n    this.game = game\n    this.actor = actor\n    this.name = name\n    this.lifespan = lifespan\n    this.timeToLive = lifespan\n    this.stepInterval = stepInterval\n    this.allowDuplicates = allowDuplicates\n    this.timeSinceLastStep = 0;\n    this.onStart = onStart\n    this.onStep = onStep\n    this.onStop = onStop\n  }\n}","import { DIRECTIONS, ENERGY_THRESHOLD } from '../../constants';\nimport * as StatusEffect from '../../statusEffects';\nimport { AddStatusEffect, Move } from '../../actions';\nimport { walk } from './walk';\nimport { getRandomInArray } from '../../../helper';\n\nconst drunkWalk = (direction, engine) => {\n  let actor = engine.actors[engine.currentActor];\n  let originalDirection = [...direction];\n  let chance = Math.random();\n  if (chance < 0.5) {\n    console.log('drunk misstep');\n    let count = 100\n    while ((direction[0] === originalDirection[0] && direction[1] === originalDirection[1]) || count < 0) {\n      count -= 1;\n      direction = DIRECTIONS[getRandomInArray(Object.keys(DIRECTIONS))];\n    }\n    console.log(count);\n  }\n\n  let newX = actor.pos.x + direction[0];\n  let newY = actor.pos.y + direction[1];\n  actor.setNextAction(new Move({\n    targetPos: { x: newX, y: newY },\n    game: engine.game,\n    actor,\n    energyCost: ENERGY_THRESHOLD\n  }))\n}\n\nexport const drunkenFist = (engine, damageBuff = 1) => {\n  let currentActor = engine.actors[engine.currentActor];\n\n  let effect = new StatusEffect.Base({\n    game: engine.game,\n    actor: currentActor,\n    name: 'Drunk',\n    lifespan: 1000,\n    stepInterval: 100,\n    allowDuplicates: false,\n    onStart: () => {\n      currentActor.attackDamage += damageBuff;\n      currentActor.renderer.character = '?';\n      console.log(`${currentActor.name} took a sip of sake.`);\n      currentActor.keymap.w = {\n        activate: () => drunkWalk(DIRECTIONS.N, engine),\n        label: 'drunken walk'\n      }\n      currentActor.keymap.a = {\n        activate: () => drunkWalk(DIRECTIONS.W, engine),\n        label: 'drunken walk'\n      }\n      currentActor.keymap.s = {\n        activate: () => drunkWalk(DIRECTIONS.S, engine),\n        label: 'drunken walk'\n      }\n      currentActor.keymap.d = {\n        activate: () => drunkWalk(DIRECTIONS.E, engine),\n        label: 'drunken walk'\n      }\n    },\n    onStop: () => {\n      currentActor.attackDamage -= damageBuff;\n      currentActor.renderer.character = 'R';\n      console.log(`${currentActor.name} recovered from drunkeness.`);\n      currentActor.keymap.w = {\n        activate: () => walk(DIRECTIONS.N, engine),\n        label: 'walk'\n      }\n      currentActor.keymap.a = {\n        activate: () => walk(DIRECTIONS.W, engine),\n        label: 'walk'\n      }\n      currentActor.keymap.s = {\n        activate: () => walk(DIRECTIONS.S, engine),\n        label: 'walk'\n      }\n      currentActor.keymap.d = {\n        activate: () => walk(DIRECTIONS.E, engine),\n        label: 'walk'\n      }\n    },\n  });\n  currentActor.setNextAction(new AddStatusEffect({\n    effect,\n    actor: currentActor,\n    game: engine.game,\n    processDelay: 100,\n    particleTemplate: {\n      renderer: {\n        color: '#c45ffd',\n        background: '#424242',\n        character: '?'\n      }\n    },\n  }));\n}","import * as Action from '../../actions';\nimport * as Item from '../../items';\nimport * as Constant from '../../constants';\nimport { UI_Actor } from '../../entites';\nimport { moveCursor } from './moveCursor';\n\n// ------------ SAND TOMB ----------------------\nconst triggerSandTomb = (engine, actor) => {\n  let cursor = engine.actors[engine.currentActor];\n  // let cloud = Item.sandBurst({\n  let cloud = Item.sandTomb({\n    engine,\n    actor,\n    targetPos: { ...cursor.pos },\n  });\n\n  if (cloud) {\n    engine.addActorAsNext(cloud);\n    actor.setNextAction(\n      new Action.Say({\n        game: engine.game,\n        actor,\n        message: 'I\\'ll crush you!',\n        energyCost: Constant.ENERGY_THRESHOLD\n      })\n      // new Action.PlaceActor({\n      //   targetPos: { ...cursor.pos },\n      //   entity: cloud,\n      //   game: engine.game,\n      //   actor,\n      //   // energyCost: actor.energy\n      //   energyCost: Constant.ENERGY_THRESHOLD\n      // })\n    )\n  }\n}\n\nconst keymapSandTomb = (engine, initiatedBy, previousKeymap) => {\n  const goToPreviousKeymap = () => {\n    let cursor = engine.actors[engine.currentActor];\n    cursor.active = false;\n    engine.game.removeActor(cursor);\n  };\n  return {\n    Escape: {\n      activate: goToPreviousKeymap,\n      label: 'Close',\n    },\n    w: {\n      activate: () => moveCursor(Constant.DIRECTIONS.N, engine),\n      label: 'move',\n    },\n    d: {\n      activate: () => moveCursor(Constant.DIRECTIONS.E, engine),\n      label: 'move',\n    },\n    s: {\n      activate: () => moveCursor(Constant.DIRECTIONS.S, engine),\n      label: 'move',\n    },\n    a: {\n      activate: () => moveCursor(Constant.DIRECTIONS.W, engine),\n      label: 'move',\n    },\n    k: {\n      activate: () => {\n        triggerSandTomb(engine, initiatedBy);\n        goToPreviousKeymap();\n      },\n      label: 'activate'\n    },\n  };\n}\n\nexport const sandTomb = (engine) => {\n  let currentActor = engine.actors[engine.currentActor]\n  let game = engine.game;\n  let pos = currentActor.pos;\n\n  let cursor = new UI_Actor({\n    initiatedBy: currentActor,\n    pos,\n    renderer: {\n      character: '',\n      color: 'white',\n      background: '',\n    },\n    name: 'Cursor',\n    game,\n    keymap: keymapSandTomb(engine, currentActor, { ...currentActor.keymap }),\n  })\n  engine.addActorAsPrevious(cursor);\n  game.placeActorOnMap(cursor)\n  game.draw()\n}","import { PlaceActor, Say } from '../../actions';\nimport { sandWallPulse } from '../../items';\nimport { DIRECTIONS, ENERGY_THRESHOLD } from '../../constants';\n\nconst triggerSandPulse = (direction, actor, engine) => {\n  let cloud = sandWallPulse({\n    engine,\n    actor,\n    throwDirection: {\n      x: direction[0],\n      y: direction[1],\n    },\n    targetPos: {\n      x: actor.pos.x + (direction[0] * 10),\n      y: actor.pos.y + (direction[1] * 10),\n    },\n  });\n\n  if (cloud) {\n    engine.addActorAsPrevious(cloud);\n    actor.setNextAction(\n      new Say({\n        game: engine.game,\n        actor,\n        message: 'Away from me!',\n        energyCost: ENERGY_THRESHOLD\n      })\n      // new PlaceActor({\n      //   targetPos: {\n      //     x: actor.pos.x + direction[0],\n      //     y: actor.pos.y + direction[1],\n      //   },\n      //   entity: cloud,\n      //   game: engine.game,\n      //   actor,\n      //   energyCost: ENERGY_THRESHOLD\n      // })\n    )\n  }\n}\n\nconst keymapSandPulse = (engine, initiatedBy, previousKeymap) => {\n  const goToPreviousKeymap = () => initiatedBy.keymap = previousKeymap;\n  return {\n    Escape: {\n      activate: goToPreviousKeymap,\n      label: 'Close',\n    },\n    w: {\n      activate: () => {\n        triggerSandPulse(DIRECTIONS.N, initiatedBy, engine);\n        goToPreviousKeymap();\n      },\n      label: 'activate N',\n    },\n    d: {\n      activate: () => {\n        triggerSandPulse(DIRECTIONS.E, initiatedBy, engine);\n        goToPreviousKeymap();\n      },\n      label: 'activate E',\n    },\n    s: {\n      activate: () => {\n        triggerSandPulse(DIRECTIONS.S, initiatedBy, engine);\n        goToPreviousKeymap();\n      },\n      label: 'activate S',\n    },\n    a: {\n      activate: () => {\n        triggerSandPulse(DIRECTIONS.W, initiatedBy, engine);\n        goToPreviousKeymap();\n      },\n      label: 'activate W',\n    },\n  };\n}\n\nexport const sandPulse = (engine) => {\n  let currentActor = engine.actors[engine.currentActor]\n  currentActor.keymap = keymapSandPulse(engine, currentActor, { ...currentActor.keymap });\n}","import { Wall } from '../../entites';\nimport { PlaceItems } from '../../actions';\nimport { TYPE } from '../../items';\nimport { getDirectionKey, DIRECTIONS, ENERGY_THRESHOLD } from '../../constants';\n\n// ------------ SAND WALL ----------------------\nconst createSandWall = (engine, pos) => new Wall({\n  game: engine.game,\n  passable: false,\n  pos: { x: pos.x, y: pos.y },\n  renderer: {\n    // character: '>',\n    character: '',\n    color: '#A89078',\n    background: '#D8C0A8',\n  },\n  name: TYPE.BARRIER,\n  durability: 3,\n})\n\nconst triggerSandWall = (direction, engine) => {\n  let actor = engine.actors[engine.currentActor];\n  let targetPositions = [];\n  let directionKey = getDirectionKey(direction);\n  switch (directionKey) {\n    case 'N':\n      targetPositions = targetPositions.concat([\n        {\n          x: actor.pos.x - 1,\n          y: actor.pos.y - 1,\n        },\n        {\n          x: actor.pos.x,\n          y: actor.pos.y - 1,\n        },\n        {\n          x: actor.pos.x + 1,\n          y: actor.pos.y - 1,\n        },\n      ]);\n      break;\n    case 'S':\n      targetPositions = targetPositions.concat([\n        {\n          x: actor.pos.x - 1,\n          y: actor.pos.y + 1,\n        },\n        {\n          x: actor.pos.x,\n          y: actor.pos.y + 1,\n        },\n        {\n          x: actor.pos.x + 1,\n          y: actor.pos.y + 1,\n        },\n      ]);\n      break;\n    case 'E':\n      targetPositions = targetPositions.concat([\n        {\n          x: actor.pos.x + 1,\n          y: actor.pos.y - 1,\n        },\n        {\n          x: actor.pos.x + 1,\n          y: actor.pos.y,\n        },\n        {\n          x: actor.pos.x + 1,\n          y: actor.pos.y + 1,\n        },\n      ]);\n      break;\n    case 'W':\n      targetPositions = targetPositions.concat([\n        {\n          x: actor.pos.x - 1,\n          y: actor.pos.y - 1,\n        },\n        {\n          x: actor.pos.x - 1,\n          y: actor.pos.y,\n        },\n        {\n          x: actor.pos.x - 1,\n          y: actor.pos.y + 1,\n        },\n      ]);\n      break;\n    default:\n      break;\n  }\n  actor.setNextAction(new PlaceItems({\n    targetPositions,\n    entity: createSandWall(engine, { ...actor.pos }),\n    game: engine.game,\n    actor,\n    energyCost: ENERGY_THRESHOLD\n  }))\n}\n\nconst keymapSandWall = (engine, initiatedBy, previousKeymap) => {\n  const goToPreviousKeymap = () => initiatedBy.keymap = previousKeymap;\n  return {\n    Escape: {\n      activate: goToPreviousKeymap,\n      label: 'Close',\n    },\n    w: {\n      activate: () => {\n        triggerSandWall(DIRECTIONS.N, engine);\n        goToPreviousKeymap();\n      },\n      label: 'activate N',\n    },\n    d: {\n      activate: () => {\n        triggerSandWall(DIRECTIONS.E, engine);\n        goToPreviousKeymap();\n      },\n      label: 'activate E',\n    },\n    s: {\n      activate: () => {\n        triggerSandWall(DIRECTIONS.S, engine);\n        goToPreviousKeymap();\n      },\n      label: 'activate S',\n    },\n    a: {\n      activate: () => {\n        triggerSandWall(DIRECTIONS.W, engine);\n        goToPreviousKeymap();\n      },\n      label: 'activate W',\n    },\n  };\n}\n\nexport const sandWall = (engine) => {\n  let currentActor = engine.actors[engine.currentActor]\n  currentActor.keymap = keymapSandWall(engine, currentActor, { ...currentActor.keymap });\n}","import { Say } from '../../actions';\nimport * as Constant from '../../constants';\n\nexport const none = (engine) => {\n  let actor = engine.actors[engine.currentActor];\n  actor.setNextAction(new Say({\n    message: 'standing still...',\n    game: engine.game,\n    actor,\n    energyCost: Constant.ENERGY_THRESHOLD\n  }))\n}","// import deps\nimport * as Item from '../items';\nimport * as Entity from '../entites';\nimport * as Constant from '../constants';\nimport * as Keymap from '../Keymap';\n\nexport default function (engine) {\n  // define keymap\n  const keymap = (engine) => {\n    return {\n      w: {\n        activate: () => Keymap.walk(Constant.DIRECTIONS.N, engine),\n        label: 'walk N',\n      },\n      e: {\n        activate: () => Keymap.walk(Constant.DIRECTIONS.NE, engine),\n        label: 'walk NE',\n      },\n      d: {\n        activate: () => Keymap.walk(Constant.DIRECTIONS.E, engine),\n        label: 'walk E',\n      },\n      c: {\n        activate: () => Keymap.walk(Constant.DIRECTIONS.SE, engine),\n        label: 'walk SE',\n      },\n      x: {\n        activate: () => Keymap.walk(Constant.DIRECTIONS.S, engine),\n        label: 'walk S',\n      },\n      z: {\n        activate: () => Keymap.walk(Constant.DIRECTIONS.SW, engine),\n        label: 'walk SW',\n      },\n      a: {\n        activate: () => Keymap.walk(Constant.DIRECTIONS.W, engine),\n        label: 'walk W',\n      },\n      q: {\n        activate: () => Keymap.walk(Constant.DIRECTIONS.NW, engine),\n        label: 'walk NW',\n      },\n      s: {\n        activate: () => Keymap.none(engine),\n        label: 'stay',\n      },\n      l: {\n        activate: () => Keymap.activateFlyingLotus(engine),\n        label: 'Flying Lotus',\n      },\n      k: {\n        activate: () => Keymap.removeWeights(engine, 200),\n        label: 'Remove wraps',\n      },\n      j: {\n        activate: () => Keymap.drunkenFist(engine),\n        label: 'Sip Sake',\n      },\n      h: {\n        activate: () => Keymap.leafWhirlwind(engine),\n        label: 'Leaf Whirlwind',\n      },\n      g: {\n        activate: () => Keymap.openInnerGate(engine),\n        label: 'Gate of Opening',\n      },\n      i: {\n        activate: () => Keymap.activateInventory(engine),\n        label: 'Open Inventory',\n      },\n      o: {\n        activate: () => Keymap.activateEquipment(engine),\n        label: 'Open Equipment',\n      },\n      u: {\n        activate: () => Keymap.activateDropItem(engine),\n        label: 'Drop Item',\n      },\n      p: {\n        activate: () => Keymap.pickupRandom(engine),\n        label: 'Pickup',\n      },\n      t: {\n        activate: () => Keymap.activateThrow(engine),\n        label: 'Throw',\n      },\n      // DEV KEYS\n      y: {\n        activate: () => Keymap.addActor(engine.game),\n        label: 'Add NPC',\n      },\n    };\n  }\n  // instantiate class\n  let actor = new Entity.Player({\n    pos: { x: 23, y: 7 },\n    renderer: {\n      character: 'R',\n      color: '#e6e6e6',\n      background: '#36635b',\n    },\n    name: 'Rock Lee',\n    actions: [],\n    speed: 400,\n    durability: 20,\n    keymap: keymap(engine),\n  })\n\n  // add default items to container\n  actor.container = [\n    ...Array(100).fill('').map(() => Item.kunai(engine, { ...actor.pos })),\n    ...Array(100).fill('').map(() => Item.directionalKunai(engine, { ...actor.pos }, null, 10)),\n  ]\n\n  return actor;\n}","import * as StatusEffect from '../../statusEffects';\nimport { AddStatusEffect } from '../../actions';\n\nexport const removeWeights = (engine, speedBoost = 600, damageDebuff = 1) => {\n  let currentActor = engine.actors[engine.currentActor];\n\n  let effect = new StatusEffect.Base({\n    game: engine.game,\n    actor: currentActor,\n    name: 'Removed wraps (weights)',\n    lifespan: 1000,\n    stepInterval: 100,\n    allowDuplicates: false,\n    onStart: () => {\n      currentActor.speed += speedBoost;\n      currentActor.attackDamage = Math.max(0, currentActor.attackDamage - damageDebuff);\n      currentActor.energy += speedBoost;\n      currentActor.renderer.character = ''\n      console.log(`${currentActor.name} removed weighted wraps.`);\n    },\n    onStop: () => {\n      currentActor.speed -= speedBoost;\n      currentActor.attackDamage += damageDebuff;\n      currentActor.renderer.character = 'R'\n      console.log(`${currentActor.name} rewrapped weights.`);\n    },\n  });\n  currentActor.setNextAction(new AddStatusEffect({\n    effect,\n    actor: currentActor,\n    game: engine.game,\n    particleTemplate: {\n      renderer: {\n        color: '#424242',\n        background: '#e6e6e6',\n        character: ''\n      }\n    }\n  }));\n}","import { MultiTargetAttack} from '../../actions';\nimport { ENERGY_THRESHOLD, PARTICLE_TEMPLATES } from '../../constants';\n\nexport const leafWhirlwind = (engine) => {\n  let actor = engine.actors[engine.currentActor];\n  let targetPositions = [\n    {\n      x: actor.pos.x - 1,\n      y: actor.pos.y,\n    },\n    {\n      x: actor.pos.x - 1,\n      y: actor.pos.y - 1,\n    },\n    {\n      x: actor.pos.x,\n      y: actor.pos.y - 1,\n    },\n    {\n      x: actor.pos.x + 1,\n      y: actor.pos.y - 1,\n    },\n    {\n      x: actor.pos.x + 1,\n      y: actor.pos.y,\n    },\n    {\n      x: actor.pos.x + 1,\n      y: actor.pos.y + 1,\n    },\n    {\n      x: actor.pos.x,\n      y: actor.pos.y + 1,\n    },\n    {\n      x: actor.pos.x - 1,\n      y: actor.pos.y + 1,\n    },\n  ]\n\n  actor.setNextAction(new MultiTargetAttack({\n    targetPositions,\n    game: engine.game,\n    actor,\n    energyCost: (ENERGY_THRESHOLD * 8),\n    particleTemplate: PARTICLE_TEMPLATES.leaf,\n  }))\n}","import * as StatusEffect from '../../statusEffects';\nimport { AddStatusEffect } from '../../actions';\n\nexport const openInnerGate = (engine) => {\n  let currentActor = engine.actors[engine.currentActor];\n  let nextGate = currentActor.setNextGate();\n  if (nextGate) {\n    let effect = new StatusEffect.Base({\n      game: engine.game,\n      actor: currentActor,\n      name: nextGate.name,\n      lifespan: -1,\n      stepInterval: 100,\n      allowDuplicates: false,\n      onStart: () => {\n        currentActor.speed += nextGate.speedBuff;\n        currentActor.energy += nextGate.speedBuff;\n        currentActor.attackDamage += nextGate.damageBuff;\n        console.log(`${currentActor.name} opened the ${nextGate.name}.`);\n        let nextGateToLabel = currentActor.getNextGate();\n        if (nextGateToLabel) {\n          currentActor.keymap.o.label = nextGateToLabel.name;\n        } else {\n          delete currentActor.keymap.o;\n        }\n      },\n      onStep: () => {\n        currentActor.decreaseDurability(nextGate.durabilityDebuff);\n        currentActor.decreaseDurability(0);\n        console.log(`${currentActor.name} suffers ${nextGate.durabilityDebuff} damage from physical stress.`)\n      },\n    });\n    currentActor.setNextAction(new AddStatusEffect({\n      effect,\n      actor: currentActor,\n      game: engine.game,\n      processDelay: 25,\n      particleTemplate: {\n        renderer: {\n          color: '#3cc2bb',\n          background: '#24fe88',\n          character: '#'\n        }\n      }\n    }));\n  }\n}","import * as Helper from '../helper';\nimport { Particle } from './entites';\nimport { PARTICLE_TEMPLATES } from './constants';\nimport RockLee from './Characters/RockLee';\n\nexport class Engine {\n  constructor({\n    statusEffects = [],\n    actors = [],\n    currentActor = 0,\n    isRunning = false,\n    game = null,\n  }) {\n    this.statusEffects = statusEffects;\n    this.actors = actors;\n    this.currentActor = currentActor;\n    this.isRunning = isRunning;\n    this.game = game;\n  }\n\n  async processV1 () { // a turn-based system using speed and round-robin\n    let actor = this.actors[this.currentActor]\n    actor.gainEnergy(actor.speed);\n    if (actor.hasEnoughEnergy()) {\n      let action = actor.getAction(this.game);\n      if (!action) { return false; } // if no action given, kick out to UI input\n      while (true) {\n        let result = action.perform();\n        this.game.draw();\n        await Helper.delay(action.processDelay);\n        if (!result.success) return false;\n        if (result.alternative === null) break;\n        action = result.alternative;\n      }\n    }\n    this.currentActor = (this.currentActor + 1) % this.actors.length;\n    return true\n  }\n\n  async processV2() { // a turn-based system using speed and Action Points\n    let actor = this.actors[this.currentActor]\n    let acting = true;\n    while (acting) {\n      if (!actor) return false;\n      let timePassed = 0;\n      if (actor.hasEnoughEnergy()) {\n        let action = actor.getAction(this.game);\n        if (!action) { return false; } // if no action given, kick out to UI input\n        timePassed += action.energyCost;\n        while (true) {\n          action.onBefore();\n          let result = await action.perform();\n          if (result.success) {\n            action.onSuccess();\n          } else {\n            action.onFailure();\n          }\n          action.onAfter();\n          if (!await this.processActionFX(action, result.success)) {\n              await Helper.delay(action.processDelay);\n              this.game.draw();\n          }\n          if (!result.success) return false;\n          if (result.alternative === null) break;\n          action = result.alternative;\n        }\n        this.processStatusEffects(timePassed);\n      } else {\n        actor.gainEnergy(actor.speed);\n        acting = false;\n      }\n    }\n    this.currentActor = (this.currentActor + 1) % this.actors.length;\n    return true\n  }\n\n  // a turn-based system using speed and Action Points\n  // it reorders all actors by energy after every round robin\n  async processV3() { \n    let actor = this.actors[this.currentActor]\n    if (!actor) return false;\n    let timePassed = 0;\n    if (actor.hasEnoughEnergy()) {\n      let action = actor.getAction(this.game);\n      if (!action) { return false; } // if no action given, kick out to UI input\n      timePassed += action.energyCost;\n      while (true) {\n        let result = await action.perform();\n        if (!await this.processActionFX(action, result.success)) {\n            await Helper.delay(action.processDelay);\n            this.game.draw();\n        }\n        if (!result.success) return false;\n        if (result.alternative === null) break;\n        action = result.alternative;\n      }\n      this.processStatusEffects(timePassed);\n    } else {\n      actor.gainEnergy(actor.speed);\n    }\n    this.currentActor = (this.currentActor + 1) % this.actors.length;\n    if (this.currentActor === 0) this.sortActorsByEnery();\n    return true\n  }\n\n  // TODO process that reorders actors after every action\n\n  async start() {\n    this.isRunning = true;\n    while (this.isRunning) {\n      this.isRunning = await this.processV2();\n    }\n    let actor = this.actors[this.currentActor]\n    \n    if (!actor) {\n      this.game.backToTitle();\n      return false;\n    }\n    \n    if (actor.keymap) {\n      this.game.visibleKeymap = actor.keymap;\n    }\n    this.game.updateMode();\n    await this.game.updateReact(this.game);\n  }\n  \n  stop() {\n    this.isRunning = false;\n  }\n\n  sortActorsByEnery () {\n    this.actors = this.actors.sort((a, b) => b.energy - a.energy);\n    console.log(this.actors);\n  }\n\n  addStatusEffect(newEffect) {\n    if (!newEffect.allowDuplicates) {\n      if (this.statusEffects.filter((effect) => (\n        effect.actor.id === newEffect.actor.id &&\n        effect.name === newEffect.name\n      )).length > 0) {\n        console.log(`${newEffect.name} cannot be applied twice to ${newEffect.actor.name}`);\n        return false;\n      };\n    }\n    newEffect.onStart();\n    this.statusEffects.push(newEffect)\n    return true;\n  }\n\n  removeStatusEffectById (id) {\n    this.statusEffects = this.statusEffects.filter((effect) => {\n      if (effect.id !== id) return true;\n      effect.onStop();\n      return false;\n    });\n  }\n  \n  removeStatusEffectByActorId (actorId) {\n    this.statusEffects = this.statusEffects.filter((effect) => {\n      if (effect.actor.id !== actorId) return true;\n      effect.onStop();\n      return false;\n    });\n  }\n\n  removeDeadStatusEffects() {\n    this.statusEffects = this.statusEffects.filter((effect) =>{\n      if (effect.lifespan >= 0 && effect.timeToLive <= 0) {\n        effect.onStop();\n        return false;\n      }\n      return true;\n    });\n  }\n\n  processStatusEffects (timePassed) {\n    this.statusEffects.forEach((effect) => {\n      effect.timeSinceLastStep += timePassed;\n      effect.timeToLive -= timePassed;\n      if (effect.timeSinceLastStep >= effect.stepInterval) {\n        effect.onStep();\n        effect.timeSinceLastStep = 0;\n      } \n    });\n    this.removeDeadStatusEffects();\n  }\n\n  async processActionFX (action, actionSuccess) {\n    // EASE IN\n    // let time = .8\n    // let nextT = (t) => t *= t; \n    // EASE OUT\n    // let time = .03\n    // let nextT = (t) => t * (2 - t); \n    // EASE IN OUT QUAD\n    // let time = .4\n    // let nextT = (t) => t < .5 ? 2 * t * t : -1 + (4 - 2 * t) * t; \n    // EASE IN CUBIC\n    // let time = .8\n    // let nextT = (t) => t * t * t; \n    // EASE OUT CUBIC\n    // let time = .001\n    // let nextT = (t) => (--t) * t * t + 1; \n    if (!actionSuccess) { \n      // If action is not successful, instead of running action's normal particle animation\n      // we'll show a red X on the entity that initiated the action\n      const particle = new Particle({\n        game: this.game,\n        name: 'particle',\n        passable: true,\n        pos: {...action.actor.pos},\n        renderer: PARTICLE_TEMPLATES.fail.renderer,\n      })\n      this.game.placeActorOnMap(particle);\n      this.game.draw();\n      await Helper.delay(100);\n      this.game.removeActorFromMap(particle);\n      particle.update(1);\n      this.game.draw();\n      action.removeDeadParticles(); // is this needed?\n      return true;\n    }\n\n    if (action.particles.length) {\n      while (action.particles.length > 0) {\n        action.particles.forEach((particle) => {\n          this.game.placeActorOnMap(particle);\n        })\n        this.game.draw();\n        // await Helper.delay(time * 100);\n        // await Helper.delay(time * action.processDelay);\n        await Helper.delay(action.processDelay);\n        action.particles.forEach((particle) => {\n          this.game.removeActorFromMap(particle);\n          particle.update(1);\n\n        })\n        this.game.draw();\n        action.removeDeadParticles();\n        // time = nextT(time);\n      }\n      return true;\n    }\n    return false;\n  }\n\n  addActor (entity) {\n    this.actors.push(entity);\n  }\n\n  addActorAsPrevious (entity) {\n    this.actors.splice(this.currentActor, 0, entity);\n  }\n\n  addActorAsNext (entity) {\n    this.actors.splice(this.currentActor + 1, 0, entity);\n  }\n\n  setActorToPrevious (entity) {\n    this.currentActor -= 1;\n    if (this.currentActor <= -1) this.currentActor = this.actors.length - 1;\n  }\n\n  setActorToNext (entity) {\n    this.currentActor = (this.currentActor + 1) % this.actors.length;\n  }\n\n}\n\n\nexport class CrankEngine extends Engine {\n  async process() { // a turn-based system using speed and Action Points\n    let actor = this.actors[this.currentActor]\n    let acting = true;\n    while (acting) {\n      if (actor.hasEnoughEnergy()) {\n        let action = actor.getAction(this.game);\n        if (!action) { return false; } // if no action given, kick out to UI input\n        while (true) {\n          this.game.draw();\n          let result = await action.perform();\n          await Helper.delay(action.processDelay);\n          if (!result.success) return false;\n          if (result.alternative === null) break;\n          action = result.alternative;\n        }\n      } else {\n        // actor.gainEnergy(actor.speed);\n        acting = false;\n      }\n    }\n    // this.currentActor = (this.currentActor + 1) % this.actors.length;\n    this.currentActor += 1;\n    if (this.currentActor + 1 >= this.actors.length) {\n      this.currentActor = 0;\n      this.actors.forEach((actor) => actor.gainEnergy(actor.speed));\n      return false;\n    }\n    return true\n  }\n\n  async start() {\n    this.isRunning = true;\n    while (this.isRunning) {\n      this.isRunning = await this.process();\n    }\n    let actor = this.actors[this.currentActor]\n    if (actor.keymap) {\n      this.game.visibleKeymap = actor.keymap;\n    }\n    this.game.updateMode();\n    await this.game.updateReact(this.game);\n  }\n}","import React from 'react';\nimport * as ROT from 'rot-js';\nimport * as Constant from './constants';\nimport * as Helper from '../helper';\nimport { addActor as addWaveEnemy } from './Keymap/KeyActions/addActor';\n\nconst GAME_MODE_TYPES = {WAVE: 0};\n\nexport class Game {\n  constructor({\n    engine = null,\n    map = {},\n    display = new ROT.Display({ \n      // forceSquareRatio: true,\n      width: 90,\n      // height: 100,\n      fontSize: 24, \n      bg: '#424242' \n    }),\n    tileKey = Constant.TILE_KEY,\n    mode = {\n      type: GAME_MODE_TYPES.WAVE,\n      data: {\n        level: 1,\n        highestLevel: null,\n      }\n    },\n  }) {\n    this.engine = engine;\n    this.map = map;\n    this.display = display;\n    this.tileKey = tileKey;\n    this.mode = mode;\n  }\n\n  initializeMode () {\n    if (this.mode.type === GAME_MODE_TYPES.WAVE) {\n      let highestLevel = localStorage.getItem('hidden_leaf_rl__highestLevel');\n      if (!highestLevel) { \n        highestLevel = this.mode.data.level;\n      } else { \n        highestLevel = Math.max(highestLevel , this.mode.data.level);\n      }\n      localStorage.setItem('hidden_leaf_rl__highestLevel', highestLevel);\n      this.mode.data.highestLevel = highestLevel\n      for (let i = 0; i < Math.pow(this.mode.data.level, 2); i++) {\n        addWaveEnemy(this);\n      }\n    }\n  }\n  \n  updateMode () {\n    if (this.mode.type === GAME_MODE_TYPES.WAVE) {\n      const nonPlayerCharacters = this.engine.actors.filter((actor) => !actor.entityTypes.includes('PLAYING'));\n      if (!nonPlayerCharacters.length) {\n        this.nextModeLevel();\n        this.initializeMode();\n      }\n    }\n  }\n\n  setModeLevel (level) {\n    this.mode.data.level = level;\n  }\n\n  nextModeLevel () {\n    this.setModeLevel(this.mode.data.level + 1);\n  }\n  \n  resetMode () {\n    this.setModeLevel(1);\n    this.initializeMode();\n  }\n\n  randomlyPlaceActorOnMap(actor) {\n    let kill = 0;\n    let placed = false;\n    while (!placed) {\n      let pos = Helper.getRandomPos(this.map).coordinates\n      if (this.canOccupyPosition(pos, actor)) {\n        let tile = this.map[Helper.coordsToString(pos)]\n        actor.pos = { ...pos }\n        tile.entities.push(actor);\n        placed = true;\n      }\n      kill += 1;\n      if (kill >= 100) {\n        placed = true;\n      }\n    }\n    return placed;\n  }\n\n  randomlyPlaceAllActorsOnMap() {\n    this.engine.actors.forEach((actor) => {\n      this.randomlyPlaceActorOnMap(actor);\n    })\n  }\n\n  placeActorsOnMap() {\n    this.engine.actors.forEach((actor) => {\n      let tile = this.map[Helper.coordsToString(actor.pos)]\n      if (tile) {\n        tile.entities.push(actor);\n      } else {\n        console.log(`could not place ${actor.id}: ${actor.name} on map`);\n      }\n    })\n  }\n\n  placeActorOnMap(actor) {\n    let tile = this.map[Helper.coordsToString(actor.pos)]\n    if (tile) {\n      tile.entities.push(actor);\n      return true\n    } else {\n      console.log(`could not place ${actor.id}: ${actor.name} on map`);\n      return false\n    }\n  }\n\n  removeActorFromMap (actor) {\n    let tile = this.map[Helper.coordsToString(actor.pos)]\n    if (!tile) return false;\n    this.map[Helper.coordsToString(actor.pos)].entities = tile.entities.filter((ac) => ac.id !== actor.id);\n    return true;\n  }\n\n  createLevel () {\n    let digger = new ROT.Map.Arena();\n    // let digger = new ROT.Map.Rogue();\n    // let digger = new ROT.Map.DividedMaze();\n    // let digger = new ROT.Map.EllerMaze();\n    // let digger = new ROT.Map.Cellular();\n    // let digger = new ROT.Map.Digger();\n    // let digger = new ROT.Map.IceyMaze();\n    // let digger = new ROT.Map.Uniform();\n    let freeCells = [];\n    let digCallback = function (x, y, value) {\n      let key = x + \",\" + y;\n      let type = 'GROUND';\n      let currentFrame = 0;\n      if (value) { \n        type = 'WALL';\n        // type = 'WATER';\n      }\n\n      if (Constant.TILE_KEY[type].animation) {\n        currentFrame = Helper.getRandomInt(0, Constant.TILE_KEY[type].animation.length)\n      }\n\n      this.map[key] = {\n        type,\n        currentFrame,\n        entities: [],\n      };\n      freeCells.push(key);\n    }\n    digger.create(digCallback.bind(this));\n    this.randomlyPlaceAllActorsOnMap()\n  }\n\n  canOccupyPosition (pos, entity = {passable: false}) {\n    let result = false;\n    let targetTile = this.map[Helper.coordsToString(pos)];\n    if (targetTile) {\n      let hasImpassableEntity = targetTile.entities.filter((entity) => !entity.passable).length > 0;\n      if (!hasImpassableEntity || entity.passable) {\n        let tile = this.map[Helper.coordsToString(pos)];\n        if (this.tileKey[tile.type].passable) {\n          result = true;\n        }\n      }\n    }\n\n    return result;\n  }\n\n  cursorCanOccupyPosition(pos) {\n    let result = false;\n    let targetTile = this.map[Helper.coordsToString(pos)];\n    if (targetTile) {\n      result = true;\n    }\n\n    return result;\n  }\n\n  show () {\n    let d = document.getElementById('display')\n    d.appendChild(this.display.getContainer())\n  }\n\n  draw () {\n    for (let key in this.map) {\n      let parts = key.split(\",\");\n      let x = parseInt(parts[0]);\n      let y = parseInt(parts[1]);\n      let tile = this.map[key];\n      let { character, foreground, background } = this.tileKey[tile.type]\n\n      // Proto code to handle tile animations\n      let tileRenderer = this.tileKey[tile.type]\n      if (tileRenderer.animation) {\n        let frame = tileRenderer.animation[tile.currentFrame];\n        \n        character = frame.character;\n        foreground = frame.foreground;\n        background = frame.background;\n        tile.currentFrame = (tile.currentFrame + 1) % tileRenderer.animation.length;\n      }\n\n      if (tile.entities.length > 0) {\n        let entity = tile.entities[tile.entities.length - 1]\n        character = entity.renderer.character\n        foreground = entity.renderer.color\n        if (entity.renderer.background) {\n          background = entity.renderer.background\n        }\n      }\n      this.display.draw(x, y, character, foreground, background);\n    }\n  }\n\n  addActor (actor, engine = this.engine) {\n    let isPlaced = this.placeActorOnMap(actor); // replace with placeActorOnMap\n    if (!isPlaced) { return false }\n    engine.actors.push(actor);\n    this.draw();\n    return true\n  }\n\n  placeAndDrawActor (actor) {\n    this.placeActorsOnMap(); // replace with placeActorOnMap\n    this.draw();\n  }\n\n  removeActor (actor) {\n    this.engine.actors = this.engine.actors.filter((ac) => ac.id !== actor.id);\n    // this.engine.currentActor = this.engine.actors.length - 1; // should remove need for this line\n    // this.engine.currentActor = (this.engine.currentActor) % this.engine.actors.length;\n    // this.engine.currentActor = (this.engine.currentActor + 1) % this.engine.actors.length;\n    this.removeActorFromMap(actor);\n    this.draw();\n  }\n\n  initialize (presserRef) {\n    this.engine.game = this;\n    this.engine.actors.forEach((actor) => {\n      actor.game = this;\n    });\n    this.show();\n    this.createLevel();\n    this.draw();\n    presserRef.current.focus();\n    this.initializeMode();\n  }\n}\n\n/************************** UI ********************************/\nexport const handleKeyPress = (event, engine) => {\n  if (!engine.isRunning) {\n    let actor = engine.actors[engine.currentActor];\n    let keymap = actor.keymap;\n    let code = event.key;\n    if (!(code in keymap)) { return; }\n    keymap[code]['activate']();\n    engine.start()\n  }\n  return;\n}\n\nexport const DisplayElement = (presserRef, handleKeyPress, engine) => {\n  return (\n    <div\n      id='display'\n      ref={presserRef}\n      onKeyDown={(event) => handleKeyPress(event, engine)}\n      tabIndex='0'\n    />\n  )\n}\n/************************** UI ********************************/\n","import React from 'react';\n\nfunction Button(props) {\n  let color = props['color'];\n  if (!color) color = 'grey';\n  return (\n    <button\n      onClick={props.onClick}\n      className={`btn ${color} darken-3`}\n    >\n      {props.children}  \n    </button>\n  )\n}\n\nexport default Button;\n","import React from 'react';\nimport Button from './Button';\n\nclass Information extends React.Component {\n  render() {\n    return (\n      <div className=\"Information UI\">\n        <div className='flow-text'>Information</div>\n        {\n          this.props.data && (\n            this.props.data.map((item, index) => {\n              return (\n                <Button key={index} color={item['color']} onClick={() => null}>\n                  {`${item.label}: ${item.value}`}\n                </Button>\n              )\n            })\n          )\n        }\n      </div>\n    );\n  }\n}\n\nexport default Information;","import React from 'react';\nimport Button from './Button';\n\nclass Equipment extends React.Component {\n  render() {\n    return (\n      <div className=\"Equipment UI\">\n        <div className='flow-text'>Equipment</div>\n        {\n          this.props.equipment && (\n            this.props.equipment.map((slot, index) => {\n              return (\n                <Button key={index} onClick={() => null}>\n                  {slot.name} {slot.item ? slot.item.renderer.character : ''}\n                </Button>\n              )\n            })\n          )\n        }\n      </div>\n    );\n  }\n}\n\nexport default Equipment;","import React from 'react';\nimport Button from './Button';\n\nclass Inventory extends React.Component {\n  render() {\n    return (\n      <div className=\"Inventory UI\">\n        <div className='flow-text'>Inventory</div>\n        {\n          this.props.inventory && (\n            this.props.inventory.map((item, index) => {\n              return (\n                <Button key={index} onClick={() => null}>\n                  {index} {item.name} {item.renderer.character}\n                </Button>\n              )\n            })\n          )\n        }\n      </div>\n    );\n  }\n}\n\nexport default Inventory;","import React from 'react';\nimport Button from './Button';\n\nclass Keymap extends React.Component {\n  render() {\n    return (  \n      <div className=\"Keymap UI\">\n        <div className='flow-text'>Keymap</div>\n        {\n          \n          this.props.keymap && (\n            Object.entries(this.props.keymap).map(([key, value], index) => {\n              return (\n                <Button key={index} onClick={() => null}>\n                  {key} {value.label}\n                </Button>\n              )\n            })\n          )\n        }\n      </div>\n    );\n  }\n}\n\nexport default Keymap;","// import deps\nimport * as Constant from '../constants';\nimport * as Item from '../items';\nimport * as Entity from '../entites';\nimport * as Keymap from '../Keymap';\n// create class\n\nconst keymap = (engine) => {\n  return {\n    w: {\n      activate: () => Keymap.walk(Constant.DIRECTIONS.N, engine),\n      label: 'walk',\n    },\n    d: {\n      activate: () => Keymap.walk(Constant.DIRECTIONS.E, engine),\n      label: 'walk',\n    },\n    s: {\n      activate: () => Keymap.walk(Constant.DIRECTIONS.S, engine),\n      label: 'walk',\n    },\n    a: {\n      activate: () => Keymap.walk(Constant.DIRECTIONS.W, engine),\n      label: 'walk',\n    },\n    i: {\n      activate: () => Keymap.activateInventory(engine),\n      label: 'Open Inventory',\n    },\n    q: {\n      activate: () => Keymap.activateEquipment(engine),\n      label: 'Open Equipment',\n    },\n    k: {\n      activate: () => Keymap.cloneSelf(engine),\n      label: 'Clone Self',\n    },\n    g: {\n      activate: () => Keymap.activateDropItem(engine),\n      label: 'Drop Item',\n    },\n    p: {\n      activate: () => Keymap.pickupRandom(engine),\n      label: 'Pickup',\n    },\n    t: {\n      activate: () => Keymap.activateThrow(engine),\n      label: 'Throw',\n    },\n    y: {\n      activate: () => Keymap.addActor(engine.game),\n      label: 'Add NPC',\n    },\n    c: {\n      activate: () => Keymap.charge(engine, 1),\n      label: 'Charge',\n    },\n    '1': {\n      activate: () => Keymap.sign(Constant.HAND_SIGNS.Power, engine),\n      label: 'Sign - Power',\n    },\n    '2': {\n      activate: () => Keymap.sign(Constant.HAND_SIGNS.Healing, engine),\n      label: 'Sign - Healing',\n    },\n    '3': {\n      activate: () => Keymap.sign(Constant.HAND_SIGNS.Absolute, engine),\n      label: 'Sign - Absolution',\n    },\n    r: {\n      activate: () => Keymap.signRelease(engine),\n      label: 'Release',\n    },\n  };\n}\n\nexport default function (engine) {\n  let actor = new Entity.Player({\n    pos: { x: 23, y: 7 },\n    renderer: {\n      character: 'N',\n      color: 'black',\n      background: 'orange',\n    },\n    name: 'Naruto Uzumaki',\n    actions: [],\n    speed: 600,\n    durability: 1,\n    keymap: keymap(engine),\n  })\n\n  actor.container = [\n    Item.sword(engine),\n    Item.sword(engine),\n    Item.sword(engine),\n    ...Array(10).fill('').map(() => Item.kunai(engine, { ...actor.pos })),\n  ]\n\n  return actor;\n}\n// export instance","import { CloneSelf } from '../../actions';\n\nexport const cloneSelf = (engine, cloneOverrides = []) => {\n  let actor = engine.actors[engine.currentActor];\n  actor.setNextAction(new CloneSelf({\n    game: engine.game,\n    actor,\n    cloneArgs: cloneOverrides,\n  }));\n};","import { Charge, Release } from '../../actions';\nimport { ENERGY_THRESHOLD } from '../../constants';\n\nexport const charge = (engine, chargeAmount) => {\n  let actor = engine.actors[engine.currentActor];\n  actor.setNextAction(new Charge({\n    chargeAmount,\n    game: engine.game,\n    actor,\n    energyCost: ENERGY_THRESHOLD\n  }));\n};\n\nexport const release = (engine, chargeCost) => {\n  let actor = engine.actors[engine.currentActor];\n  actor.setNextAction(new Release({\n    chargeCost,\n    game: engine.game,\n    actor,\n    energyCost: ENERGY_THRESHOLD\n  }));\n};","// import deps\nimport * as Item from '../items';\nimport * as Entity from '../entites';\nimport * as Constant from '../constants';\nimport * as Keymap from '../Keymap';\n\n// create class\nexport default function (engine) {\n  // define keymap\n  const keymap = (engine) => {\n    return {\n      w: {\n        activate: () => Keymap.walk(Constant.DIRECTIONS.N, engine),\n        label: 'walk N',\n      },\n      e: {\n        activate: () => Keymap.walk(Constant.DIRECTIONS.NE, engine),\n        label: 'walk NE',\n      },\n      d: {\n        activate: () => Keymap.walk(Constant.DIRECTIONS.E, engine),\n        label: 'walk E',\n      },\n      c: {\n        activate: () => Keymap.walk(Constant.DIRECTIONS.SE, engine),\n        label: 'walk SE',\n      },\n      x: {\n        activate: () => Keymap.walk(Constant.DIRECTIONS.S, engine),\n        label: 'walk S',\n      },\n      z: {\n        activate: () => Keymap.walk(Constant.DIRECTIONS.SW, engine),\n        label: 'walk SW',\n      },\n      a: {\n        activate: () => Keymap.walk(Constant.DIRECTIONS.W, engine),\n        label: 'walk W',\n      },\n      q: {\n        activate: () => Keymap.walk(Constant.DIRECTIONS.NW, engine),\n        label: 'walk NW',\n      },\n      s: {\n        activate: () => Keymap.none(engine),\n        label: 'stay',\n      },\n      l: {\n        activate: () => Keymap.sandClone(engine),\n        label: 'Sand Clone',\n      },\n      k: {\n        activate: () => Keymap.sandTomb(engine),\n        label: 'Sand Tomb',\n      },\n      j: {\n        activate: () => Keymap.sandSkin(engine, 2),\n        label: 'Sand Skin',\n      },\n      h: {\n        activate: () => Keymap.sandWall(engine),\n        label: 'Sand Wall',\n      },\n      g: {\n        activate: () => Keymap.sandPulse(engine),\n        label: 'Sand Pulse',\n      },\n      i: {\n        activate: () => Keymap.activateInventory(engine),\n        label: 'Open Inventory',\n      },\n      o: {\n        activate: () => Keymap.activateEquipment(engine),\n        label: 'Open Equipment',\n      },\n      u: {\n        activate: () => Keymap.activateDropItem(engine),\n        label: 'Drop Item',\n      },\n      p: {\n        activate: () => Keymap.pickupRandom(engine),\n        label: 'Pickup',\n      },\n      t: {\n        activate: () => Keymap.activateThrow(engine),\n        label: 'Throw',\n      },\n      // DEV KEYS\n      y: {\n        activate: () => Keymap.addActor(engine.game),\n        label: 'Add NPC',\n      },\n    };\n  }\n\n\n  let actor = new Entity.Player({\n    pos: { x: 23, y: 7 },\n    renderer: {\n      character: 'G',\n      color: '#F0D8C0',\n      background: '#603030',\n    },\n    name: 'Gaara',\n    actions: [],\n    speed: 200,\n    durability: 15,\n    cloneLimit: 3,\n    keymap: keymap(engine),\n    defense: 2,\n  })\n\n  actor.container = [\n    Item.sword(engine),\n    ...Array(100).fill('').map(() => Item.sandShuriken(engine, { ...actor.pos })),\n    // ...Array(10).fill('').map(() => Item.fireballGas(engine, actor)),\n    // ...Array(10).fill('').map(() => Item.movingSandWall(engine, { ...actor.pos })),\n  ]\n\n  return actor;\n}\n// export instance","import { CloneSelf } from '../../actions';\nimport { cloneDeep } from 'lodash';\n\nexport const sandClone = (engine) => {\n  let actor = engine.actors[engine.currentActor];\n  let cloneKeymap = cloneDeep(actor.keymap);\n  delete cloneKeymap['j'];\n  delete cloneKeymap['k'];\n  delete cloneKeymap['l'];\n  let cloneArgs = [\n    {\n      attribute: 'renderer',\n      value: { ...actor.renderer, background: '#A89078' }\n    },\n    {\n      attribute: 'keymap',\n      value: cloneKeymap\n    }\n  ];\n  actor.setNextAction(new CloneSelf({\n    game: engine.game,\n    actor,\n    cloneArgs,\n  }))\n}","import * as StatusEffect from '../../statusEffects';\nimport { AddStatusEffect } from '../../actions';\n\nexport const sandSkin = (engine, defenseBuff = 1) => {\n  let currentActor = engine.actors[engine.currentActor];\n  let effect = new StatusEffect.Base({\n    game: engine.game,\n    actor: currentActor,\n    name: 'Sand Skin',\n    lifespan: 500,\n    stepInterval: 100,\n    allowDuplicates: false,\n    onStart: () => {\n      currentActor.defense += defenseBuff;\n      console.log(`${currentActor.name} was enveloped in hardened sand.`);\n      currentActor.renderer.background = '#A89078'\n    },\n    onStop: () => {\n      currentActor.defense = Math.max(0, currentActor.defense - defenseBuff);\n      console.log(`${currentActor.name}'s hardened sand skin fell away.`);\n      currentActor.renderer.background = '#603030';\n    },\n  });\n  currentActor.setNextAction(new AddStatusEffect({\n    effect,\n    actor: currentActor,\n    game: engine.game,\n    particleTemplate: {\n      renderer: {\n        character: '',\n        color: '#A89078',\n        background: '#D8C0A8',\n      }\n    },\n  }));\n}","import React from 'react';\nimport { SCREENS } from './constants';\nimport * as Engine from '../engine';\nimport * as Game from '../game';\nimport Information from '../UI/Information';\nimport Equipment from '../UI/Equipment';\nimport Inventory from '../UI/Inventory';\nimport KeymapUI from '../UI/Keymap';\nimport RockLee from '../Characters/RockLee';\nimport NarutoUzumaki from '../Characters/NarutoUzumaki';\nimport Gaara from '../Characters/Gaara';\n\nclass Level extends React.Component {\n  constructor(props) {\n    super(props);\n    let ENGINE = new Engine.Engine({});\n    let actor = this.props.selectedCharacter.initialize(ENGINE);\n    ENGINE.actors.push(actor)\n    let game = new Game.Game({ engine: ENGINE })\n\n    this.state = {\n      game: game,\n    };\n    this.presserRef = React.createRef();\n  }\n\n  async componentDidMount() {\n    this.state.game.initialize(this.presserRef)\n    this.state.game['backToTitle'] = () => this.props.setActiveScreen(SCREENS.TITLE);\n    this.state.game.updateReact = (newGameState) => { this.setState({game: newGameState}) }\n    this.state.game.engine.start()\n  }\n\n  render() {\n    let currentActor = this.state.game.engine.actors[this.state.game.engine.currentActor];\n    let data = [\n      {\n        label: 'Wave',\n        value: `Current: ${this.state.game.mode.data.level}, Highest: ${this.state.game.mode.data.highestLevel}`,\n      },\n    ];\n\n    data = data.concat(\n      [\n        ...this.state.game.engine.actors.map((actor, index) => {\n          let result = {\n            label: actor.name,\n            value: index,\n            value: `HP: ${actor.durability}, En/Sp: ${actor.energy}/${actor.speed}`,\n          };\n          if (index === this.state.game.engine.currentActor) {\n            result['color'] = 'red';\n          }\n          return result;\n        })\n      ]\n    )\n\n    return (\n      <div className=\"Level\">\n        <div className='flow-text'>Chunin Exams</div>\n        <button className='btn' onClick={() => this.props.setActiveScreen(SCREENS.TITLE)}>Quit</button>\n        <div className='row'>\n          <Information data={data} />\n          <Equipment equipment={this.state.game.visibleEquipment} />\n          <Inventory inventory={this.state.game.visibleInventory} />\n          <KeymapUI keymap={this.state.game.visibleKeymap} />\n          {Game.DisplayElement(this.presserRef, Game.handleKeyPress, this.state.game.engine)}\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Level;\n","import React from 'react';\nimport { SCREENS } from './constants';\nconst CharacterSelect = (props) => {\n  return (\n    <div className='CharacterSelect'>\n      {\n        props.characters.map((character, index) => {\n          let color = '';\n          if (props.selectedCharacter) {\n            color = props.selectedCharacter.name === character.name ? 'red' : ''\n          }\n\n          return (\n            <button\n              key={index}\n              className={`CharacterSelect__button btn ${color}`}\n              onClick={() => {\n                props.setSelectedCharacter(character)\n                props.setActiveScreen(SCREENS.LEVEL)\n              }}\n            >\n              {character.name}\n            </button>\n          )\n        })\n      }\n    </div>\n  );\n}\n\nclass Title extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {};\n  }\n\n  render() {\n    return (\n      <div className=\"Title\">\n        <div\n          style={{\n            width: '100vw',\n            height: '100vh',\n            backgroundColor: '#e2e2e2',\n          }}\n        >\n          <div class='flow-text grey-text'>Hidden Leaf RL</div>\n          <CharacterSelect \n            characters={this.props.characters} \n            selectedCharacter={this.props.selectedCharacter} \n            setSelectedCharacter={this.props.setSelectedCharacter}\n            setActiveScreen={this.props.setActiveScreen}\n        />\n          <button \n            class='btn' \n            onClick={() => this.props.setActiveScreen(SCREENS.LEVEL)}\n            disabled={!this.props.selectedCharacter}\n          >\n            Play\n          </button>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Title;","import RockLee from './RockLee';\nimport Gaara from './Gaara';\nimport NarutoUzumaki from './NarutoUzumaki';\n\nlet Characters = () => {\n  return {\n    RockLee,\n    Gaara,\n    NarutoUzumaki,\n  }\n}\n\nexport default Characters;","import React from 'react';\nimport ReactCSSTransitionGroup from 'react-addons-css-transition-group';\nimport { SCREENS } from './Screen/constants';\nimport Level from './Screen/Level';\nimport Title from './Screen/Title';\nimport Characters from './Characters/index';\n\nclass Nystrum extends React.Component {\n  constructor() {\n    super();\n    let characterKey = Characters();\n    let characters = Object.keys(characterKey).map((key, i) => {\n      return {\n        // [key]: characterKey[key],\n        initialize: characterKey[key],\n        selected: false,\n        name: key,\n      }\n    });\n    this.state = {\n      activeScreen: SCREENS.TITLE,\n      characters,\n      selectedCharacter: null,\n    };\n  }\n\n  setActiveScreen (activeScreen) {\n    this.setState({activeScreen})\n  }\n\n  setSelectedCharacter (character) {\n    this.setState({selectedCharacter: {...character}})\n  }\n\n  getActiveScreen () {\n    const titleScreen = <Title \n      key={SCREENS.TITLE} \n      setActiveScreen={this.setActiveScreen.bind(this)}\n      setSelectedCharacter={this.setSelectedCharacter.bind(this)}\n      selectedCharacter={this.state.selectedCharacter}\n      characters={this.state.characters}\n    />\n    const levelScreen = <Level \n      key={SCREENS.LEVEL} \n      setActiveScreen={this.setActiveScreen.bind(this)}\n      selectedCharacter={this.state.selectedCharacter}\n    />\n\n    switch (this.state.activeScreen) {\n      case SCREENS.TITLE:\n        return titleScreen\n      case SCREENS.LEVEL:\n        return levelScreen\n      default:\n        return titleScreen\n    }\n  }\n\n  render() {\n    const activeScreen = this.getActiveScreen();\n    return (\n      <div className=\"Nystrum\">\n        <ReactCSSTransitionGroup\n          transitionName=\"fade\"\n          transitionAppear={true}\n          transitionEnter={true}\n          transitionLeave={true}\n          transitionAppearTimeout={500}\n          transitionEnterTimeout={500}\n          transitionLeaveTimeout={300}\n        >\n          { activeScreen }\n        </ReactCSSTransitionGroup>\n      </div>\n    );\n  }\n}\n\nexport default Nystrum;\n","import * as ROT from 'rot-js';\n\nexport const TILE_KEY = () => {\n  return {\n    'GROUND': {\n      background: '#974',\n      foreground: '#aaa',\n      character: '.',\n      passable: true,\n    }\n  }\n}\n\n// RENDERING\n\nexport const DRAW = (map, display) => {\n  for (let key in map) {\n    let parts = key.split(\",\");\n    let x = parseInt(parts[0]);\n    let y = parseInt(parts[1]);\n    let tile = map[key];\n    let { character, foreground, background } = TILE_KEY()[tile.type]\n    if (tile.entities.length > 0) {\n      let entity = tile.entities[tile.entities.length - 1]\n      character = entity.components.renderer.character\n      foreground = entity.components.renderer.color\n      if (entity.components.renderer.background) {\n        background = entity.components.renderer.background\n      }\n    }\n    display.draw(x, y, character, foreground, background);\n  }\n}\n\n// END RENDERING\n\nexport const coordsToString = (coords) => `${coords.x},${coords.y}`\n\nexport const getImpassableEntities = (entities) => {\n  return entities.filter((e) => e.components.hasOwnProperty('impasse') && !e.components.impasse.passable)\n}\n\nexport const getDestructableEntities = (entities) => {\n  return entities.filter((e) => e.components.hasOwnProperty('destructible'))\n}\n\nexport const delay = (timeDelayed = 100) => {\n  return new Promise(resolve => setTimeout(resolve, timeDelayed));\n}\n\nexport const exampleEngine = () => {\n  let scheduler = new ROT.Scheduler.Simple();\n  let engine = new ROT.Engine(scheduler);\n  let output = [];\n  /* sample actor: pauses the execution when dead */\n  let actor = {\n    lives: 3,\n    act: function () {\n      let done = null;\n      let promise = {\n        then: function (cb) { done = cb; }\n      }\n\n      output.push(\".\");\n      // SHOW(output.join(\"\"));\n      console.log(output.join(\"\"));\n\n      this.lives--;\n\n      /* if alive, wait for 500ms for next turn */\n      if (this.lives) {\n        setTimeout(function () { done(); }, 500);\n      }\n\n      return promise;\n    }\n  }\n  scheduler.add(actor, true);\n  engine.start();\n}\n\nexport const getRandomInArray = (array) => {\n  return array[Math.floor(Math.random() * array.length)];\n}","import * as Helper from '../lib/helper';\n\nexport const createEntity = (id = null, name = 'Empty', components = {}, world) => {\n  let entity = {\n    id,\n    name,\n    components,\n    world,\n    sendEvent: (target, eventType, parameters) => sendEvent(target, eventType, parameters, world),\n  };\n  return entity\n}\n\nexport const sendEvent = async (target = null, eventType = null, parameters = null, world = null) => {\n  let success = false;\n  for (let key in target.components) {\n    let component = target.components[key]\n    if (component.hasOwnProperty(eventType)) {\n      console.log('SUCCESSFUL EVENT: ', eventType)\n      success = true\n      if (eventType !== 'PREPARE_RENDER') {\n        await Helper.delay();\n      }\n      component[eventType]({ ...parameters, self: target, component: component });\n      Helper.DRAW(world.map, world.display)\n    }\n  }\n  if (!success) {\n    console.log('FAILED EVENT')\n  }\n};","import * as Helper from '../lib/helper';\n\nexport const receiver = (pos) => {\n  return {\n    responded: false,\n    RECIEVE: (parameters) => {\n      let { self, component, message } = parameters\n      console.log(message, pos.x, pos.y)\n      if (!component.responded) {\n        component.responded = true\n        self.sendEvent(parameters.sender, 'hello', 'RECIEVE', { message: 'copy', sender: self })\n      }\n    }\n  }\n}\n\nexport const impasse = (passable = false) => {\n  return {\n    passable,\n    MAKE_PASSABLE: (parameters) => {\n      let { component } = parameters;\n      component.passable = true;\n    },\n    MAKE_IMPASSABLE: (parameters) => {\n      let { component } = parameters;\n      component.passable = false;\n    }\n  }\n}\n\nexport const body = (world, pos = { x: 0, y: 0 }) => {\n  if (world) {\n    return {\n      pos,\n      MOVE: (parameters) => {\n        let { self, component, currentPos, targetPos } = parameters\n        if (world.canOccupy(world.map, targetPos)) {\n          component.pos = targetPos\n          let tile = world.map[Helper.coordsToString(currentPos)]\n          world.map[Helper.coordsToString(currentPos)] = {...tile, entities: []}\n          self.sendEvent(self, 'PREPARE_RENDER')\n          // Helper.DRAW(world.map, world.display)\n        } else {\n          console.log('can\\'t move there')\n        }\n      }\n    }\n  }\n  console.log('No world to occupy');\n  return {}\n}\n\nexport const destructible = (world, durability = 1) => {\n  return {\n    durability,\n    DECREASE_DURABILITY: (parameters) => {\n      let { self, component, value } = parameters;\n      component.durability -= value\n      if (component.durability <= 0) {\n        self.sendEvent(self, 'DESTROY')\n      }\n    },\n    INCREASE_DURABILITY: (parameters) => {\n      let { component, value } = parameters;\n      component.durability += value\n    },\n    DESTROY: (parameters) => {\n      let { self, component, value } = parameters;\n      let tile = world.map[Helper.coordsToString(self.components.body.pos)];\n      world.map[Helper.coordsToString(self.components.body.pos)].entities = tile.entities.filter((e) => e.id !== self.id);\n      // self.sendEvent(self, 'PREPARE_RENDER')\n      // Helper.DRAW(world.map, world.display)\n    }\n  }\n}\n\nexport const attack = (damage = 1) => {\n  return {\n    damage,\n  }\n}\n\nexport const throwable = (world) => {\n  return {\n    THROW: (parameters) => {\n      let { self, component, direction } = parameters;\n      // if next tile is passable\n        // send move action to self\n        // send throw action to self\n      // else\n        // send decrease_durability to entity next in tile\n        // send decrease_durability to self\n      let currentPos = self.components.body.pos;\n      let nextPos = { x: currentPos.x + direction.x, y: currentPos.y + direction.y }\n      let nextTile = world.map[Helper.coordsToString(nextPos)];\n      if (world.canOccupy(world.map, nextPos)) { // change to check for target entity\n        self.sendEvent(\n          self, 'MOVE', {\n            currentPos: currentPos,\n            targetPos: nextPos\n          }\n        )\n        self.sendEvent(self, 'THROW', {direction});\n      } else {\n        if (world.map.hasOwnProperty(Helper.coordsToString(nextPos))) {\n          let impassable_and_destructable_entities = Helper.getDestructableEntities(Helper.getImpassableEntities(nextTile.entities))\n          if (impassable_and_destructable_entities.length > 0) {\n            self.sendEvent(impassable_and_destructable_entities[0], 'DECREASE_DURABILITY', { value: 1 });\n          }\n        }\n        self.sendEvent(self, 'DECREASE_DURABILITY', { value: 1 });\n      }\n    },\n  }\n}\n\nexport const renderer = (world, character = '', color = 'white', background = false) => {\n  return {\n    character,\n    color,\n    background,\n    PREPARE_RENDER: (parameters) => {\n      let { self } = parameters\n      if (self.components.hasOwnProperty('body')) {\n        world.map[Helper.coordsToString(self.components.body.pos)].entities.push(self)\n      }\n    }\n  }\n}","import React from 'react';\nimport '../App.css';\nimport * as ROT from 'rot-js';\nimport * as Entity from './lib/entity'\nimport * as Helper from './lib/helper'\nimport * as Components from './components/index'\n\nconst SHOW = (canvas) => {\n  let d = document.getElementById('display')\n  d.appendChild(canvas)\n}\n\nconst CREATE_LEVEL = (world) => {\n  let digger = new ROT.Map.Arena();\n  let freeCells = [];\n  let digCallback = function (x, y, value) {\n    if (value) { return; }\n    let key = x + \",\" + y;\n    world.map[key] = {\n      type: 'GROUND',\n      entities: [],\n    };\n    freeCells.push(key);\n  }\n  digger.create(digCallback.bind(this));\n}\n\nlet scheduler = new ROT.Scheduler.Simple()\nlet engine = new ROT.Engine(scheduler)\n\nlet world = {\n  canAct: true,\n  scheduler,\n  engine,\n  map: {},\n  display: new ROT.Display({ fontSize: 24, bg: '#099' }),\n  canOccupy: (map, pos) => {\n    if (map.hasOwnProperty(Helper.coordsToString(pos))) {\n      let tile = map[Helper.coordsToString(pos)];\n      if (Helper.TILE_KEY()[tile.type].passable && Helper.getImpassableEntities(tile.entities).length === 0) {\n        return true\n      }\n    } else {\n      return false\n    }\n  },\n}\n\nlet naruto = {\n  ...Entity.createEntity(1, 'Naruto', {\n    reciever: Components.receiver({ x: 10, y: 30 }),\n    body: Components.body(world, { x: 19, y: 21 }),\n    renderer: Components.renderer(world, 'N', 'orange', 'black'),\n  },\n    world,\n  ),\n}\n\nlet box = {\n  ...Entity.createEntity(2, 'Box', {\n    body: Components.body(world, { x: 22, y: 21 }),\n    renderer: Components.renderer(world, '#', 'black'),\n    impasse: Components.impasse(),\n    destructible: Components.destructible(world),\n  },\n    world,\n  )\n}\n\nlet box2 = {\n  ...Entity.createEntity(2, 'Box', {\n    body: Components.body(world, { x: 22, y: 19 }),\n    renderer: Components.renderer(world, '#', 'black'),\n    impasse: Components.impasse(),\n    destructible: Components.destructible(world),\n  },\n    world,\n  )\n}\n\nlet box3 = {\n  ...Entity.createEntity(2, 'Box', {\n    body: Components.body(world, { x: 22, y: 17 }),\n    renderer: Components.renderer(world, '#', 'black'),\n    impasse: Components.impasse(),\n    destructible: Components.destructible(world),\n  },\n    world,\n  )\n}\n\nlet kunai = {\n  ...Entity.createEntity(3, 'Kunai', {\n    body: Components.body(world, { x: 20, y: 21 }),\n    renderer: Components.renderer(world, '<>', 'black'),\n    destructible: Components.destructible(world),\n    attack: Components.attack(),\n    throwable: Components.throwable(world),\n  },\n    world,\n  )\n}\n\nclass Original extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {};\n    this.presserRef = React.createRef();\n  }\n\n  handleKeyPress = (event, world, entity) => {\n    let keymap = {\n      w: 0,\n      d: 1,\n      s: 2,\n      a: 3,\n    };\n\n    let code = event.key;\n    let dir = ROT.DIRS[4][keymap[code]];\n    if (code === 't') {\n      kunai.sendEvent(kunai, 'MOVE', {\n        currentPos: kunai.components.body.pos,\n        targetPos: {\n          x: entity.components.body.pos.x + 1,\n          y: entity.components.body.pos.y,\n        },\n      })\n      return kunai.sendEvent(kunai, 'THROW', { direction: { x: 1, y: 0 } })\n    }\n    if (!(code in keymap)) { return; }\n    let newX = entity.components.body.pos.x + dir[0];\n    let newY = entity.components.body.pos.y + dir[1];\n\n    entity.sendEvent(\n      entity, 'MOVE', {\n        currentPos: entity.components.body.pos,\n        targetPos: {\n          x: newX,\n          y: newY\n        }\n      }\n    )\n\n    return;\n    // return Helper.DRAW(world.map, world.display)\n\n  }\n\n  componentDidMount() {\n    ROT.RNG.setSeed(7);\n    SHOW(world.display.getContainer());\n    CREATE_LEVEL(world);\n    naruto.sendEvent(naruto, 'PREPARE_RENDER')\n    // kunai.sendEvent(kunai, 'PREPARE_RENDER')\n    box.sendEvent(box, 'PREPARE_RENDER')\n    box2.sendEvent(box2, 'PREPARE_RENDER')\n    box3.sendEvent(box3, 'PREPARE_RENDER')\n    Helper.DRAW(world.map, world.display)\n    this.presserRef.current.focus();\n  }\n\n  render() {\n    return (\n      <div className=\"App\" ref={this.presserRef} onKeyDown={(event) => this.handleKeyPress(event, world, naruto)} tabIndex='0'>\n        <div id='display'></div>\n      </div>\n    );\n  }\n}\n\nexport default Original;\n","import React from 'react';\nimport './App.css';\nimport Nystrum from './nystrum/Nystrum';\nimport Original from './original/Original';\n\nclass App extends React.Component {\n  render() {\n    return (\n      <div className=\"App container-fluid\">\n        <Nystrum />\n        {/* <Original /> */}\n      </div>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}