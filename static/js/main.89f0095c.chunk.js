(window["webpackJsonphidden-leaf-rl"]=window["webpackJsonphidden-leaf-rl"]||[]).push([[0],{123:function(e,t,n){e.exports=n(268)},128:function(e,t,n){},268:function(e,t,n){"use strict";n.r(t);var r=n(5),a=n.n(r),i=n(71),c=n.n(i),o=(n(128),n(0)),s=n(1),u=n(3),l=n(2),p=n(4),h=(n(74),n(122)),f=n.n(h),y={TITLE:0,LEVEL:1},g=n(8),v=n(15),m=n(10),b=n.n(m),d=n(17),O=n(11),j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return new Promise(function(t){return setTimeout(t,e)})},k=function(e){return e[Math.floor(Math.random()*e.length)]},w=function(e){return"".concat(e.x,",").concat(e.y)},x=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4,a=e.map,i=function(e,t){return!!a[e+","+t]&&"GROUND"===a[e+","+t].type},c=new O.e.AStar(t.x,t.y,i,{topology:r}),o=[];return c.compute(n.x,n.y,function(e,t){o.push({x:e,y:t})}),o.slice(1)},E=function(e,t,n,r,a){return x(e,t,n,r).slice(0,a+1)},P=function(e){var t=Object.keys(e),n=k(t).split(",");return{coordinates:{x:parseInt(n[0]),y:parseInt(n[1])},text:n}},A=function(e){return e.filter(function(e){return e.hasOwnProperty("durability")})},D=function(e){return 2/3*(Math.pow(e,3)-9*Math.pow(e,2)+32*e-18)},C=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,r=D(n),a=[],i=0;i<r;i++){var c=Math.round(e+Math.cos(2*Math.PI/r*i)*n),o=Math.round(t+Math.sin(2*Math.PI/r*i)*n);a.push({x:c,y:o})}return a},T=function(){function e(t){var n=t.statusEffects,r=void 0===n?[]:n,a=t.actors,i=void 0===a?[]:a,c=t.currentActor,s=void 0===c?0:c,u=t.isRunning,l=void 0!==u&&u,p=t.game,h=void 0===p?null:p;Object(o.a)(this,e),this.statusEffects=r,this.actors=i,this.currentActor=s,this.isRunning=l,this.game=h}return Object(s.a)(e,[{key:"processV1",value:function(){var e=Object(d.a)(b.a.mark(function e(){var t,n,r;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((t=this.actors[this.currentActor]).gainEnergy(t.speed),!t.hasEnoughEnergy()){e.next=18;break}if(n=t.getAction(this.game)){e.next=6;break}return e.abrupt("return",!1);case 6:return r=n.perform(),this.game.draw(),e.next=11,j(n.processDelay);case 11:if(r.success){e.next=13;break}return e.abrupt("return",!1);case 13:if(null!==r.alternative){e.next=15;break}return e.abrupt("break",18);case 15:n=r.alternative,e.next=6;break;case 18:return this.currentActor=(this.currentActor+1)%this.actors.length,e.abrupt("return",!0);case 20:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"process",value:function(){var e=Object(d.a)(b.a.mark(function e(){var t,n,r,a,i;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.actors[this.currentActor],n=!0;case 2:if(!n){e.next=33;break}if(r=0,!t.hasEnoughEnergy()){e.next=29;break}if(a=t.getAction(this.game)){e.next=8;break}return e.abrupt("return",!1);case 8:r+=a.energyCost;case 9:return e.next=12,a.perform();case 12:return i=e.sent,e.next=15,this.processActionFX(a);case 15:if(e.sent){e.next=19;break}return e.next=18,j(a.processDelay);case 18:this.game.draw();case 19:if(i.success){e.next=21;break}return e.abrupt("return",!1);case 21:if(null!==i.alternative){e.next=23;break}return e.abrupt("break",26);case 23:a=i.alternative,e.next=9;break;case 26:this.processStatusEffects(r),e.next=31;break;case 29:t.gainEnergy(t.speed),n=!1;case 31:e.next=2;break;case 33:return this.currentActor=(this.currentActor+1)%this.actors.length,e.abrupt("return",!0);case 35:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"start",value:function(){var e=Object(d.a)(b.a.mark(function e(){var t;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.isRunning=!0;case 1:if(!this.isRunning){e.next=7;break}return e.next=4,this.process();case 4:this.isRunning=e.sent,e.next=1;break;case 7:return(t=this.actors[this.currentActor]).keymap&&(this.game.visibleKeymap=t.keymap),this.game.updateMode(),e.next=12,this.game.updateReact(this.game);case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){this.isRunning=!1}},{key:"addStatusEffect",value:function(e){return!e.allowDuplicates&&this.statusEffects.filter(function(t){return t.actor.id===e.actor.id&&t.name===e.name}).length>0?(console.log("".concat(e.name," cannot be applied twice to ").concat(e.actor.name)),!1):(e.onStart(),this.statusEffects.push(e),!0)}},{key:"removeStatusEffectById",value:function(e){this.statusEffects=this.statusEffects.filter(function(t){return t.id!==e||(t.onStop(),!1)})}},{key:"removeStatusEffectByActorId",value:function(e){this.statusEffects=this.statusEffects.filter(function(t){return t.actor.id!==e||(t.onStop(),!1)})}},{key:"removeDeadStatusEffects",value:function(){this.statusEffects=this.statusEffects.filter(function(e){return!(e.lifespan>=0&&e.timeToLive<=0)||(e.onStop(),!1)})}},{key:"processStatusEffects",value:function(e){this.statusEffects.forEach(function(t){t.timeSinceLastStep+=e,t.timeToLive-=e,t.timeSinceLastStep>=t.stepInterval&&(t.onStep(),t.timeSinceLastStep=0)}),this.removeDeadStatusEffects()}},{key:"processActionFX",value:function(){var e=Object(d.a)(b.a.mark(function e(t){var n=this;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.particles.length){e.next=12;break}case 1:if(!(t.particles.length>0)){e.next=11;break}return t.particles.forEach(function(e){n.game.placeActorOnMap(e)}),this.game.draw(),e.next=6,j(t.processDelay);case 6:t.particles.forEach(function(e){n.game.removeActorFromMap(e),e.update(1)}),this.game.draw(),t.removeDeadParticles(),e.next=1;break;case 11:return e.abrupt("return",!0);case 12:return e.abrupt("return",!1);case 13:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"addActor",value:function(e){this.actors.push(e)}},{key:"addActorAsPrevious",value:function(e){this.actors.splice(this.currentActor,0,e)}},{key:"addActorAsNext",value:function(e){this.actors.splice(this.currentActor+1,0,e)}},{key:"setActorToPrevious",value:function(e){this.currentActor-=1,this.currentActor<=-1&&(this.currentActor=this.actors.length-1)}},{key:"setActorToNext",value:function(e){this.currentActor=(this.currentActor+1)%this.actors.length}}]),e}(),S=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"process",value:function(){var e=Object(d.a)(b.a.mark(function e(){var t,n,r,a;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.actors[this.currentActor],n=!0;case 2:if(!n){e.next=26;break}if(!t.hasEnoughEnergy()){e.next=23;break}if(r=t.getAction(this.game)){e.next=7;break}return e.abrupt("return",!1);case 7:return this.game.draw(),e.next=11,r.perform();case 11:return a=e.sent,e.next=14,j(r.processDelay);case 14:if(a.success){e.next=16;break}return e.abrupt("return",!1);case 16:if(null!==a.alternative){e.next=18;break}return e.abrupt("break",21);case 18:r=a.alternative,e.next=7;break;case 21:e.next=24;break;case 23:n=!1;case 24:e.next=2;break;case 26:if(this.currentActor+=1,!(this.currentActor+1>=this.actors.length)){e.next=31;break}return this.currentActor=0,this.actors.forEach(function(e){return e.gainEnergy(e.speed)}),e.abrupt("return",!1);case 31:return e.abrupt("return",!0);case 32:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),t}(T),I={GROUND:{background:"#424242",character:"",passable:!0},WATER:{animation:[{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#8aa",character:"\u2592",passable:!1},{background:"#424242",foreground:"#8aa",character:"\u2593",passable:!1}],background:"#9dc3d3",character:"\u2591",passable:!1},WIN:{background:"white",foreground:"black",character:"W",passable:!0}},N={N:[0,-1],S:[0,1],E:[1,0],W:[-1,0]},R={HEAD:"HEAD",TORSO:"TORSO",BACK:"BACK",HAND:"HAND",FEET:"FEET"},M={human:function(){return[{type:R.HEAD,name:"head",item:null},{type:R.TORSO,name:"torso",item:null},{type:R.BACK,name:"back",item:null},{type:R.HAND,name:"left_hand",item:null},{type:R.HAND,name:"right_hand",item:null},{type:R.FEET,name:"feet",item:null}]}},L={verticalLine:{x_offset:1,y_offset:1,positions:[{x:0,y:0,taken:!1},{x:0,y:1,taken:!1},{x:0,y:-1,taken:!1}]},smallSquare:{x_offset:1,y_offset:1,positions:[{x:0,y:0,taken:!1},{x:0,y:1,taken:!1},{x:1,y:1,taken:!1},{x:1,y:0,taken:!1}]},square:{x_offset:1,y_offset:1,positions:[{x:0,y:0,taken:!1},{x:0,y:1,taken:!1},{x:1,y:1,taken:!1},{x:1,y:0,taken:!1},{x:1,y:-1,taken:!1},{x:0,y:-1,taken:!1},{x:-1,y:-1,taken:!1},{x:-1,y:0,taken:!1},{x:-1,y:1,taken:!1}]},bigSquare:{x_offset:2,y_offset:2,positions:[{x:0,y:0,taken:!1},{x:0,y:1,taken:!1},{x:1,y:1,taken:!1},{x:1,y:0,taken:!1},{x:1,y:-1,taken:!1},{x:0,y:-1,taken:!1},{x:-1,y:-1,taken:!1},{x:-1,y:0,taken:!1},{x:-1,y:1,taken:!1},{x:0,y:1,taken:!1},{x:2,y:2,taken:!1},{x:2,y:0,taken:!1},{x:2,y:-2,taken:!1},{x:0,y:-2,taken:!1},{x:-2,y:-2,taken:!1},{x:-2,y:0,taken:!1},{x:-2,y:2,taken:!1}]},circle:{x_offset:0,y_offset:0,positions:C(0,0,2)}},G={default:{renderer:{character:"*",color:"black",background:"white"}},fail:{renderer:{character:"x",color:"black",background:"red"}},leaf:{renderer:{character:"\u2724",color:"#36635b",background:"#F0D8C0"}}},q={directional:0,path:1},B=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],_=n(9),U=n(28),H=n(7),W=n(29),K=n.n(W),V=n(14),F=n.n(V),z=function(e){if(e.energy=0,e.pos){var t=e.game.map[w(e.pos)];e.game.map[w(e.pos)].entities=t.entities.filter(function(t){return t.id!==e.id})}e.game.engine.actors=e.game.engine.actors.filter(function(t){return t.id!==e.id}),e.game.engine.removeStatusEffectByActorId(e.id),e.game.draw(),e.game.engine.currentActor=e.game.engine.currentActor%e.game.engine.actors.length},Y=n(23);function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(n,!0).forEach(function(t){Object(g.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var X=function(){function e(t){var n=t.game,r=t.actor,a=t.energyCost,i=void 0===a?100:a,c=t.processDelay,s=void 0===c?50:c,u=t.particles,l=void 0===u?[]:u,p=t.particleTemplate,h=void 0===p?G.default:p;Object(o.a)(this,e),this.actor=r,this.game=n,this.energyCost=i,this.processDelay=s,this.particles=l,this.particleTemplate=h}return Object(s.a)(e,[{key:"addParticle",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Q({},this.particleTemplate.renderer),a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:q.directional,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,c=new Te({game:this.game,name:"particle",passable:!0,life:e,pos:t,direction:n,energy:100,renderer:r,type:a,path:i});this.particles.push(c)}},{key:"removeDeadParticles",value:function(){this.particles=this.particles.filter(function(e){return e.life>0})}},{key:"perform",value:function(){return console.log("".concat(this.actor.name," performs")),this.actor.energy-=this.energyCost,{success:!0,alternative:null}}}]),e}(),$=function(e){function t(e){var n,r=e.effect,a=e.processDelay,i=void 0===a?0:a,c=Object(H.a)(e,["effect","processDelay"]);return Object(o.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,Q({},c)))).effect=r,n.processDelay=i,n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"perform",value:function(){var e=this,t=this.game.engine.addStatusEffect(this.effect);return C(this.actor.pos.x,this.actor.pos.y,2).forEach(function(t){e.addParticle(5,Q({},t),{x:Math.sign(t.x-e.actor.pos.x),y:Math.sign(t.y-e.actor.pos.y)})}),t&&(this.actor.energy-=this.energyCost),{success:t,alternative:null}}}]),t}(X),Z=function(e){function t(e){var n,r=e.message,a=e.processDelay,i=void 0===a?50:a,c=Object(H.a)(e,["message","processDelay"]);return Object(o.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,Q({},c)))).message=r,n.processDelay=i,n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"perform",value:function(){return console.log("".concat(this.actor.name," says ").concat(this.message)),this.actor.energy-=this.energyCost,{success:!0,alternative:null}}}]),t}(X),ee=function(e){function t(e){var n,r=e.item,a=Object(H.a)(e,["item"]);return Object(o.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,Q({},a)))).item=r,n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"perform",value:function(){var e=!1;if(this.item.equipmentType){var t=this.actor.getItemInSlot(this.item.equipmentType);t&&(this.actor.addToContainer(t),this.actor.unequip(t)),this.actor.removeFromContainer(this.item),this.actor.equip(this.item.equipmentType,this.item),console.log("".concat(this.actor.name," equips ").concat(this.item.name,".")),e=!0}return this.actor.energy-=this.energyCost,{success:e,alternative:null}}}]),t}(X),te=function(e){function t(e){var n,r=e.item,a=Object(H.a)(e,["item"]);return Object(o.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,Q({},a)))).item=r,n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"perform",value:function(){return console.log("".concat(this.actor.name," puts ").concat(this.item.name," away.")),this.actor.unequip(this.item),this.actor.addToContainer(this.item),this.actor.energy-=this.energyCost,{success:!0,alternative:null}}}]),t}(X),ne=function(e){function t(e){var n,r=e.item,a=Object(H.a)(e,["item"]);return Object(o.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,Q({},a)))).item=r,n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"perform",value:function(){return console.log("".concat(this.actor.name," drops ").concat(this.item.name,".")),this.actor.removeFromContainer(this.item),this.game.map[w(this.actor.pos)].entities.push(this.item),this.actor.energy-=this.energyCost,{success:!0,alternative:null}}}]),t}(X),re=function(e){function t(e){var n,r=e.item,a=Object(H.a)(e,["item"]);return Object(o.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,Q({},a)))).item=r,n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"perform",value:function(){var e=this;console.log("".concat(this.actor.name," picks up ").concat(this.item.name,".")),this.actor.addToContainer(this.item);var t=this.game.map[w(this.actor.pos)].entities;return this.game.map[w(this.actor.pos)].entities=t.filter(function(t){return t.id!==e.item.id}),this.actor.energy-=this.energyCost,{success:!0,alternative:null}}}]),t}(X),ae=function(e){function t(e){var n,r=e.processDelay,a=void 0===r?0:r,i=Object(H.a)(e,["processDelay"]);return Object(o.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,Q({},i)))).processDelay=a,n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"perform",value:function(){return this.actor.energy-=this.energyCost,this.actor.destroy(),{success:!0,alternative:null}}}]),t}(X),ie=function(e){function t(e){var n,r=e.targetPos,a=e.processDelay,i=void 0===a?0:a,c=Object(H.a)(e,["targetPos","processDelay"]);return Object(o.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,Q({},c)))).targetPos=r,n.processDelay=i,n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"perform",value:function(){var e=this,t=!1;if(this.game.cursorCanOccupyPosition(this.targetPos)){var n=this.game.map[w(this.actor.pos)];this.game.map[w(this.actor.pos)]=Q({},n,{entities:n.entities.filter(function(t){return t.id!==e.actor.id})}),this.actor.pos=this.targetPos,this.game.map[w(this.targetPos)].entities.push(this.actor),t=!0}return{success:t,alternative:null}}}]),t}(X),ce=function(e){function t(e){var n,r=e.targetPos,a=e.processDelay,i=void 0===a?25:a,c=Object(H.a)(e,["targetPos","processDelay"]);return Object(o.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,Q({},c)))).targetPos=r,n.processDelay=i,n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"perform",value:function(){var e=!1,t=null;return this.actor.move(this.targetPos)?(this.actor.energy-=this.energyCost,e=!0):(e=!0,t=new le({targetPos:this.targetPos,game:this.game,actor:this.actor,energyCost:100})),{success:e,alternative:t}}}]),t}(X),oe=function(e){function t(e){var n,r=e.direction,a=e.stepCount,i=e.processDelay,c=void 0===i?25:i,s=Object(H.a)(e,["direction","stepCount","processDelay"]);return Object(o.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,Q({},s)))).direction=r,n.stepCount=a,n.processDelay=c,n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"perform",value:function(){var e=!1,t=null,n={x:this.actor.pos.x+this.direction[0],y:this.actor.pos.y+this.direction[1]};return this.stepCount>0&&this.actor.move(n)?(this.stepCount-=1,this.actor.energy-=this.energyCost,this.actor.setNextAction(this),e=!0):(e=!0,t=new le({targetPos:n,game:this.game,actor:this.actor,energyCost:100})),{success:e,alternative:t}}}]),t}(X),se=function(e){function t(e){var n,r=e.targetPos,a=e.direction,i=Object(H.a)(e,["targetPos","direction"]);return Object(o.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,Q({},i)))).targetPos=r,n.direction=a,n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"perform",value:function(){var e=!1,t=null;return this.actor.shove(this.targetPos,this.direction)?(this.actor.energy-=this.energyCost,e=!0):(e=!0,t=new le({targetPos:this.targetPos,game:this.game,actor:this.actor,energyCost:100})),{success:e,alternative:t}}}]),t}(X),ue=function(e){function t(e){var n,r=e.direction,a=e.stepCount,i=e.additionalAttackDamage,c=void 0===i?0:i,s=e.processDelay,p=void 0===s?25:s,h=Object(H.a)(e,["direction","stepCount","additionalAttackDamage","processDelay"]);return Object(o.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,Q({},h)))).direction=r,n.stepCount=a,n.additionalAttackDamage=c,n.processDelay=p,n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"perform",value:function(){var e=!1,t={x:this.actor.pos.x+this.direction[0],y:this.actor.pos.y+this.direction[1]};if(this.stepCount>0&&this.actor.shove(t,this.direction)){this.stepCount-=1,this.actor.energy-=this.energyCost,this.actor.setNextAction(this);for(var n=0;n<3;n++)this.addParticle(1,{x:this.actor.pos.x-this.direction[0]*n,y:this.actor.pos.y-this.direction[1]*n},{x:0,y:0});e=!0}else e=!0,this.actor.attack(t,this.additionalAttackDamage);return{success:e,alternative:null}}}]),t}(oe),le=function(e){function t(e){var n,r=e.targetPos,a=e.processDelay,i=void 0===a?25:a,c=Object(H.a)(e,["targetPos","processDelay"]);return Object(o.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,Q({},c)))).targetPos=r,n.processDelay=i,n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"perform",value:function(){var e;return this.actor.entityTypes.includes("ATTACKING")?((e=this.actor.attack(this.targetPos))&&(this.actor.energy-=this.energyCost),{success:e,alternative:null}):{success:!0,alternative:new Z({message:"Ooh I don't know how to attack",game:this.game,actor:this.actor})}}}]),t}(X),pe=function(e){function t(e){var n,r=e.targetPositions,a=e.processDelay,i=void 0===a?25:a,c=Object(H.a)(e,["targetPositions","processDelay"]);return Object(o.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,Q({},c)))).targetPositions=r,n.processDelay=i,n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"perform",value:function(){var e=this,t=!1;if(!this.actor.entityTypes.includes("ATTACKING"))return{success:!0,alternative:new Z({message:"Ooh I don't know how to attack",game:this.game,actor:this.actor})};var n=[],r={x:this.actor.pos.x,y:this.actor.pos.y},a=this.particleTemplate.renderer;return this.targetPositions.forEach(function(r){var a=e.actor.attack(r);n.push(r),a&&(t=!0)}),this.addParticle(n.length+1,r,null,a,q.path,n),t&&(this.actor.energy-=this.energyCost),{success:t,alternative:null}}}]),t}(X),he=function(e){function t(e){var n=Object(U.a)({},e);return Object(o.a)(this,t),Object(u.a)(this,Object(l.a)(t).call(this,Q({},n)))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"perform",value:function(){var e=!1,n=null;this.actor.passable=!1;var r=Object(_.a)(Object(l.a)(t.prototype),"perform",this).call(this);(r.success&&(this.actor.path.shift(),e=!0),0===this.actor.path.length&&(e=!0,n=new ae({game:this.game,actor:this.actor,energyCost:100,processDelay:0})),r.alternative)&&(this.actor.attack(this.targetPos)&&(n=new ae({game:this.game,actor:this.actor,energyCost:100,processDelay:0})));return{success:e,alternative:n}}}]),t}(ce),fe=function(e){function t(e){var n,r=Object(U.a)({},e);return Object(o.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,Q({},r)))).processDelay=0,n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"perform",value:function(){var e=!1,n=null;this.actor.passable=!1;var r=Object(_.a)(Object(l.a)(t.prototype),"perform",this).call(this);return r.success&&(this.actor.path.shift(),e=!0),0===this.actor.path.length&&(e=!0,n=new ae({game:this.game,actor:this.actor,energyCost:100,processDelay:0})),r.alternative&&this.actor.attack(this.targetPos),{success:e,alternative:n}}}]),t}(ce),ye=function(e){function t(e){var n,r=e.engine,a=Object(H.a)(e,["engine"]);return Object(o.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,Q({},a)))).engine=r,n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"perform",value:function(){var e=Object(d.a)(b.a.mark(function e(){var t,n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=!0,n=null,console.log("".concat(this.actor.name," is cranking its engine.")),e.prev=3,e.next=6,this.engine.start();case 6:this.actor.energy-=this.energyCost,e.next=14;break;case 9:e.prev=9,e.t0=e.catch(3),console.log("CrankEngine"),console.log(e.t0),n=new ae({game:this.game,actor:this.actor,energyCost:100});case 14:return e.abrupt("return",{success:t,alternative:n});case 15:case"end":return e.stop()}},e,this,[[3,9]])}));return function(){return e.apply(this,arguments)}}()}]),t}(X);function ge(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ve(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ge(n,!0).forEach(function(t){Object(g.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ge(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var me=function e(t){var n=t.game,r=void 0===n?null:n,a=t.passable,i=void 0!==a&&a;Object(o.a)(this,e);var c=K()();this.entityTypes=["Entity"],this.id=c,this.game=r,this.passable=i},be=function(e){return function(e){function t(e){var n,r=e.children,a=void 0===r?[]:r,i=e.engine,c=void 0===i?new S({}):i,s=Object(H.a)(e,["children","engine"]);return Object(o.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,ve({},s)))).entityTypes=n.entityTypes.concat("PARENT"),n.children=a,n.engine=c,n.isInitialized=!1,n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"destroyChild",value:function(e){e.energy=0;var t=this.game.map[w(e.pos)];this.game.map[w(e.pos)].entities=t.entities.filter(function(t){return t.id!==e.id}),this.engine.actors=this.engine.actors.filter(function(t){return t.id!==e.id}),this.game.draw()}},{key:"canAttack",value:function(e){return!this.children.map(function(e){return e.id}).includes(e.id)}},{key:"initialize",value:function(){var e=this;this.isInitialized=!0,this.engine.game=this.game,this.engine.actors=this.children,this.engine.actors.forEach(function(t){t.game=e.game,t.destroy=function(){e.destroyChild(t)},t.canAttack=e.canAttack.bind(e),e.game.placeActorOnMap(t),e.engine.addActor(t),e.game.draw()})}},{key:"getAction",value:function(e){return this.isInitialized||this.initialize(),new ye({game:e,actor:this,engine:this.engine,energyCost:100,processDelay:10})}}]),t}(e)},de=function(e){return function(e){function t(e){var n,r=e.attackDamage,a=void 0===r?1:r,i=Object(H.a)(e,["attackDamage"]);return Object(o.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,ve({},i)))).entityTypes=n.entityTypes.concat("ATTACKING"),n.attackDamage=a,n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"getAttackDamage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.attackDamage+e}},{key:"canAttack",value:function(e){return!0}},{key:"attack",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=!1,r=this.game.map[w(e)];if(!r)return n;var a=A(r.entities);if(a.length>0){var i=a[0];if(this.canAttack(i)){var c=this.getAttackDamage(t);this.entityTypes.includes("EQUIPING")&&this.equipment.forEach(function(e){e.item&&e.item.entityTypes.includes("ATTACKING")&&(c+=e.item.getAttackDamage())}),console.log("".concat(this.name," does ").concat(c," to ").concat(i.name)),i.decreaseDurability(c),n=!0}}return n}}]),t}(e)},Oe=function(e){return function(e){function t(e){var n,r=e.name,a=e.actions,i=void 0===a?[]:a,c=e.speed,s=void 0===c?100:c,p=(e.energy,Object(H.a)(e,["name","actions","speed","energy"]));return Object(o.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,ve({},p)))).entityTypes=n.entityTypes.concat("ACTING"),n.name=r,n.actions=i,n.speed=s,n.energy=s,n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"getAction",value:function(){var e=k(this.actions);if(e)return e}},{key:"gainEnergy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.speed;this.energy+=e}},{key:"hasEnoughEnergy",value:function(){return this.energy>0}}]),t}(e)},je=function(e){return function(e){function t(e){var n,r=e.pos,a=void 0===r?{x:0,y:0}:r,i=e.renderer,c=Object(H.a)(e,["pos","renderer"]);return Object(o.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,ve({},c)))).entityTypes=n.entityTypes.concat("RENDERING"),n.pos=a,n.renderer=ve({},i),n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"getPosition",value:function(){return this.pos}},{key:"move",value:function(e){var t=this,n=!1;if(this.game.canOccupyPosition(e,this)){var r=this.game.map[w(this.pos)];this.game.map[w(this.pos)]=ve({},r,{entities:r.entities.filter(function(e){return e.id!==t.id})}),this.pos=e,this.game.map[w(e)].entities.push(this),n=!0}return n}},{key:"shove",value:function(e,t){var n=this.game.map[w(e)];return n&&n.entities.map(function(e){if(!e.passable){var n={x:e.pos.x+t[0],y:e.pos.y+t[1]};e.move(n)}}),this.move(e)}}]),t}(e)},ke=function(e){return function(e){function t(e){var n,r=e.keymap,a=void 0===r?{}:r,i=Object(H.a)(e,["keymap"]);return Object(o.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,ve({},i)))).entityTypes=n.entityTypes.concat("PLAYING"),n.nextAction=null,n.keymap=a,n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"setNextAction",value:function(e){this.nextAction=e}},{key:"getAction",value:function(){var e=this.nextAction;return this.nextAction=null,e}}]),t}(e)},we=function(e){return function(e){function t(e){var n,r=e.targetEntity,a=void 0===r?null:r,i=Object(H.a)(e,["targetEntity"]);return Object(o.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,ve({},i)))).entityTypes=n.entityTypes.concat("CHASING"),n.targetEntity=a,n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"getAction",value:function(e){var t=x(e,this.targetEntity.pos,this.pos),n=t.length>0?t[0]:this.pos;return new ce({targetPos:n,game:e,actor:this,energyCost:100})}}]),t}(e)},xe=function(e){return function(e){function t(e){var n,r=e.durability,a=void 0===r?1:r,i=e.onDestroy,c=void 0===i?function(){return null}:i,s=Object(H.a)(e,["durability","onDestroy"]);return Object(o.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,ve({},s)))).entityTypes=n.entityTypes.concat("DESTRUCTABLE"),n.durability=a,n.onDestroy=c,n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"decreaseDurability",value:function(e){this.durability-=e,this.durability<=0&&this.destroy()}},{key:"increaseDurability",value:function(e){this.durability+=e}},{key:"destroy",value:function(){this.onDestroy(),z(this)}}]),t}(e)},Ee=F()(Oe,je,ke,function(e){return function(e){function t(e){var n,r=e.initiatedBy,a=void 0===r?null:r,i=Object(H.a)(e,["initiatedBy"]);return Object(o.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,ve({},i)))).entityTypes=n.entityTypes.concat("UI"),n.initiatedBy=a,n.active=!0,n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"hasEnoughEnergy",value:function(){return this.active}}]),t}(e)})(me),Pe=(F()(Oe,je)(me),F()(je,xe)(me),F()(Oe,je,function(e){return function(e){function t(e){var n,r=e.path,a=void 0!==r&&r,i=e.targetPos,c=void 0===i?null:i,s=Object(H.a)(e,["path","targetPos"]);return Object(o.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,ve({},s)))).entityTypes=n.entityTypes.concat("PUSHING"),n.path=a,n.targetPos=c,n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"createPath",value:function(e){var t=x(e,this.targetPos,this.pos,8);this.path=t}},{key:"getAction",value:function(e){this.path||this.createPath(e);var t=this.path.length>0?this.path[0]:this.pos,n=[t.x-this.pos.x,t.y-this.pos.y];if(0===n[0]&&0===n[1])return new ae({game:e,actor:this,energyCost:100,processDelay:0});var r=new se({targetPos:t,direction:n,game:e,actor:this,energyCost:100});return this.path.shift(),r}}]),t}(e)},xe)(me),F()(Oe,je,we,xe)(me),F()(Oe,je,we,xe,de)(me)),Ae=F()(Oe,je,function(e){return function(e){function t(e){var n,r=e.charge,a=void 0===r?10:r,i=Object(H.a)(e,["charge"]);return Object(o.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,ve({},i)))).entityTypes=n.entityTypes.concat("CHARGING"),n.charge=a,n.chargeMax=a,n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"decreaseCharge",value:function(e){this.charge=Math.max(0,this.charge-e)}},{key:"increaseCharge",value:function(e){this.charge=Math.min(this.chargeMax,this.charge+e)}}]),t}(e)},function(e){return function(e){function t(e){var n,r=Object(U.a)({},e);return Object(o.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,ve({},r)))).entityTypes=n.entityTypes.concat("SIGNING"),n.signHistory=[],n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"addSign",value:function(e){this.signHistory.length>=4&&this.signHistory.shift(),this.signHistory.push(e)}},{key:"clearSigns",value:function(){this.signHistory=[]}}]),t}(e)},function(e){return function(e){function t(e){var n,r=e.container,a=void 0===r?[]:r,i=Object(H.a)(e,["container"]);return Object(o.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,ve({},i)))).entityTypes=n.entityTypes.concat("CONTAINING"),n.container=a,n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"contains",value:function(e){var t=this.container.filter(function(t){return t.name===e});return t.length>0&&t[0]}},{key:"addToContainer",value:function(e){this.container.push(e)}},{key:"removeFromContainer",value:function(e){this.container=this.container.filter(function(t){return t.id!==e.id})}}]),t}(e)},function(e){return function(e){function t(e){var n,r=e.equipment,a=void 0===r?M.human():r,i=Object(H.a)(e,["equipment"]);return Object(o.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,ve({},i)))).entityTypes=n.entityTypes.concat("EQUIPING"),n.equipment=a,n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"getItemInSlot",value:function(e){if(this.equipment.filter(function(t){return null===t.item&&t.type===e}).length>0)return!1;var t=this.equipment.find(function(t){return t.type===e});return!!t&&(!!t.item&&t.item)}},{key:"equip",value:function(e,t){var n=!1;this.equipment=this.equipment.map(function(r){return n||r.type!==e||null!==r.item||(r.item=t,n=!0),r})}},{key:"unequip",value:function(e){this.equipment=this.equipment.map(function(t){return t.item&&t.item.id===e.id&&(t.item=null),t})}}]),t}(e)},de,function(e){return function(e){function t(e){var n,r=e.currentGate,a=void 0===r?null:r,i=(e.gates,Object(H.a)(e,["currentGate","gates"]));return Object(o.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,ve({},i)))).entityTypes=n.entityTypes.concat("HAS_INNER_GATES"),n.currentGate=a,n.gates=[{name:"Gate of Opening",damageBuff:1,speedBuff:100,durabilityDebuff:1},{name:"Gate of Healing",damageBuff:1,speedBuff:100,durabilityDebuff:1},{name:"Gate of Life",damageBuff:1,speedBuff:100,durabilityDebuff:1},{name:"Gate of Pain",damageBuff:1,speedBuff:100,durabilityDebuff:1},{name:"Gate of Limit",damageBuff:1,speedBuff:100,durabilityDebuff:1}],n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"setNextGate",value:function(){var e=this.currentGate,t=null;if(e){var n=this.gates.findIndex(function(t){return e.name===t.name})+1;console.log("next gate index ",n),this.gates.length>n&&(t=this.gates[n],this.currentGate=ve({},t))}else t=this.gates[0],this.currentGate=ve({},t);return t}},{key:"getNextGate",value:function(){var e=this.currentGate,t=null;if(e){var n=this.gates.findIndex(function(t){return e.name===t.name})+1;console.log("next gate index ",n),this.gates.length>n&&(t=this.gates[n])}else t=this.gates[0];return t}}]),t}(e)},xe,function(e){return function(e){function t(e){var n,r=e.cloneLimit,a=void 0===r?1:r,i=Object(H.a)(e,["cloneLimit"]);return Object(o.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,ve({},i)))).entityTypes=n.entityTypes.concat("CLONING"),n.cloneLimit=a,n.clones=[],n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"destroy",value:function(){this.clones&&this.clones.map(function(e){z(e)}),z(this)}},{key:"destroyClone",value:function(e){var t=this.clones.findIndex(function(t){return t.id==e});t>=0&&(this.clones[t].super__destroy(),this.clones.splice(t,1))}},{key:"createClone",value:function(e){var t=this;if(this.clones.length<this.cloneLimit){var n=Object(Y.cloneDeep)(this);if(n.name+=" Clone ".concat(this.clones.length),n.game=this.game,n.id=K()(),delete n.clones,n.super__destroy=n.destroy,n.destroy=function(){t.destroyClone(n.id)},e.forEach(function(e){n[e.attribute]=e.value}),this.game.placeActorOnMap(n))return this.game.engine.addActorAsNext(n),this.game.draw(),this.clones.push(n),!0}return!1}}]),t}(e)},ke)(me),De=(F()(je,function(e){return function(e){function t(e){var n,r=e.name,a=void 0===r?"nameless":r,i=e.equipmentType,c=void 0===i?R.HAND:i,s=Object(H.a)(e,["name","equipmentType"]);return Object(o.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,ve({},s)))).entityTypes=n.entityTypes.concat("EQUIPABLE"),n.name=a,n.equipmentType=c,n}return Object(p.a)(t,e),t}(e)},de)(me),F()(Oe,je,de,function(e){return function(e){function t(e){var n,r=e.path,a=void 0!==r&&r,i=e.targetPos,c=void 0===i?null:i,s=e.attackDamage,p=void 0===s?1:s,h=e.range,f=void 0===h?3:h,y=Object(H.a)(e,["path","targetPos","attackDamage","range"]);return Object(o.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,ve({},y)))).entityTypes=n.entityTypes.concat("DESTRUCTIVE_PROJECTING"),n.path=a,n.targetPos=c,n.attackDamage=p,n.range=f,n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"createPath",value:function(e){var t=E(e,this.targetPos,this.pos,8,this.range);this.path=t}},{key:"getAction",value:function(e){this.path||this.createPath(e);var t=this.path.length>0?this.path[0]:this.pos;return new he({targetPos:t,game:e,actor:this,energyCost:100})}}]),t}(e)},xe)(me)),Ce=(F()(Oe,je,de,function(e){return function(e){function t(e){var n,r=e.owner_id,a=void 0===r?null:r,i=e.path,c=void 0!==i&&i,s=e.targetPos,p=void 0===s?null:s,h=e.attackDamage,f=void 0===h?1:h,y=e.range,g=void 0===y?3:y,v=Object(H.a)(e,["owner_id","path","targetPos","attackDamage","range"]);return Object(o.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,ve({},v)))).entityTypes=n.entityTypes.concat("GASEOUS_DESTRUCTIVE_PROJECTING"),n.path=c,n.targetPos=p,n.attackDamage=f,n.range=g,n.owner_id=a,n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"canAttack",value:function(e){var n=Object(_.a)(Object(l.a)(t.prototype),"canAttack",this).call(this);return n&&(n=null===this.owner_id||e.owner_id!==this.owner_id),n}},{key:"createPath",value:function(e){var t=E(e,this.targetPos,this.pos,8,this.range);this.path=t}},{key:"getAction",value:function(e){this.path||this.createPath(e);var t=this.path.length>0?this.path[0]:this.pos;return new fe({targetPos:t,game:e,actor:this,energyCost:100})}}]),t}(e)},xe,function(e){return function(e){function t(e){var n,r=e.isClone,a=void 0!==r&&r,i=e.cloneCount,c=void 0===i?0:i,s=e.clonePattern,p=void 0===s?L.square:s,h=Object(H.a)(e,["isClone","cloneCount","clonePattern"]);return Object(o.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,ve({},h)))).entityTypes=n.entityTypes.concat("GASEOUS"),n.isClone=a,n.cloneCount=c,n.clonePattern=Object(Y.cloneDeep)(p),n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"getAction",value:function(e){var n=this.clonePattern.positions.find(function(e){return!e.taken});if(!this.isClone&&n){n.taken=!0;var r=Object(Y.cloneDeepWith)(this,function(e,t){switch(t){case"id":case"game":case"engine":case"clones":return null;default:return}});if(r.game=e,r.id=K()(),this.hasOwnProperty("pos")){var a=this.pos;r.pos={x:a.x+n.x,y:a.y+n.y}}r.hasOwnProperty("path")&&(r.path=r.path.map(function(e){return{x:e.x+n.x,y:e.y+n.y}})),r.isClone=!0,this.cloneCount+=1,e.placeActorOnMap(r),e.engine.addActor(r),e.draw()}return Object(_.a)(Object(l.a)(t.prototype),"getAction",this).call(this,e)}}]),t}(e)})(me),F()(Oe,xe,be)(me)),Te=F()(Oe,je,function(e){return function(e){function t(e){var n,r=e.pos,a=void 0===r?{x:1,y:1}:r,i=e.direction,c=void 0===i?{x:0,y:0}:i,s=e.life,p=void 0===s?1:s,h=e.speed,f=void 0===h?1:h,y=e.type,g=void 0===y?q.directional:y,v=e.path,m=void 0===v?null:v,b=Object(H.a)(e,["pos","direction","life","speed","type","path"]);return Object(o.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,ve({},b)))).pos=a,n.direction=c,n.life=p,n.speed=f,n.type=g,n.path=m,n.entityTypes=n.entityTypes.concat("PARTICLE"),n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"getNextPos",value:function(e){switch(this.type){case q.directional:return{x:this.pos.x+this.direction.x*this.speed*e,y:this.pos.y+this.direction.y*this.speed*e};case q.path:var t=this.path.shift();return ve({},t||this.pos)}}},{key:"update",value:function(e){this.life-=e,this.life>0&&(this.pos=this.getNextPos(e))}}]),t}(e)})(me),Se=(F()(Oe,xe,be)(me),function(e){var t=e.engine.actors[e.engine.currentActor],n=P(e.map).coordinates,r=new Pe({targetEntity:t,pos:n,renderer:{character:k(["\u25c9","\u26e8"]),color:"white",background:""},name:"Ross",game:e,actions:[],durability:k([1]),speed:100});e.placeActorOnMap(r),e.engine.addActor(r),e.draw()});function Ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}var Ne={WAVE:0},Re=function(){function e(t){var n=t.engine,r=void 0===n?null:n,a=t.map,i=void 0===a?{}:a,c=t.display,s=void 0===c?new O.b({width:90,fontSize:24,bg:"#424242"}):c,u=t.tileKey,l=void 0===u?I:u,p=t.mode,h=void 0===p?{type:Ne.WAVE,data:{level:1}}:p;Object(o.a)(this,e),this.engine=r,this.map=i,this.display=s,this.tileKey=l,this.mode=h}return Object(s.a)(e,[{key:"initializeMode",value:function(){if(this.mode.type===Ne.WAVE)for(var e=0;e<Math.pow(this.mode.data.level,2);e++)Se(this)}},{key:"updateMode",value:function(){this.mode.type===Ne.WAVE&&(this.engine.actors.filter(function(e){return!e.entityTypes.includes("PLAYING")}).length||(this.nextModeLevel(),this.initializeMode()))}},{key:"setModeLevel",value:function(e){this.mode.data.level=e}},{key:"nextModeLevel",value:function(){this.setModeLevel(this.mode.data.level+1)}},{key:"resetMode",value:function(){this.setModeLevel(1),this.initializeMode()}},{key:"randomlyPlaceActorsOnMap",value:function(){var e=this;this.engine.actors.forEach(function(t){var n=P(e.map).coordinates,r=e.map[w(n)];t.pos=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ie(n,!0).forEach(function(t){Object(g.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ie(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},n),r.entities.push(t)})}},{key:"placeActorsOnMap",value:function(){var e=this;this.engine.actors.forEach(function(t){var n=e.map[w(t.pos)];n?n.entities.push(t):console.log("could not place ".concat(t.id,": ").concat(t.name," on map"))})}},{key:"placeActorOnMap",value:function(e){var t=this.map[w(e.pos)];return t?(t.entities.push(e),!0):(console.log("could not place ".concat(e.id,": ").concat(e.name," on map")),!1)}},{key:"removeActorFromMap",value:function(e){var t=this.map[w(e.pos)];return!!t&&(this.map[w(e.pos)].entities=t.entities.filter(function(t){return t.id!==e.id}),!0)}},{key:"createLevel",value:function(){var e=new O.d.Arena,t=[];e.create(function(e,n,r){if(!r){var a,i,c=e+","+n,o=0;I.GROUND.animation&&(a=0,i=I.GROUND.animation.length,a=Math.ceil(a),i=Math.floor(i),o=Math.floor(Math.random()*(i-a))+a),this.map[c]={type:"GROUND",currentFrame:o,entities:[]},t.push(c)}}.bind(this)),this.map["10,10"]={type:"WIN",entities:[]},this.randomlyPlaceActorsOnMap()}},{key:"canOccupyPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{passable:!1},n=!1,r=this.map[w(e)];if(r){var a=r.entities.filter(function(e){return!e.passable}).length>0;if(!a||t.passable){var i=this.map[w(e)];this.tileKey[i.type].passable&&(n=!0)}}return n}},{key:"cursorCanOccupyPosition",value:function(e){var t=!1;return this.map[w(e)]&&(t=!0),t}},{key:"show",value:function(){document.getElementById("display").appendChild(this.display.getContainer())}},{key:"draw",value:function(){for(var e in this.map){var t=e.split(","),n=parseInt(t[0]),r=parseInt(t[1]),a=this.map[e],i=this.tileKey[a.type],c=i.character,o=i.foreground,s=i.background;if(a.entities.length>0){var u=a.entities[a.entities.length-1];c=u.renderer.character,o=u.renderer.color,u.renderer.background&&(s=u.renderer.background)}this.display.draw(n,r,c,o,s)}}},{key:"addActor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.engine,n=this.placeActorOnMap(e);return!!n&&(t.actors.push(e),this.draw(),!0)}},{key:"placeAndDrawActor",value:function(e){this.placeActorsOnMap(),this.draw()}},{key:"removeActor",value:function(e){this.engine.actors=this.engine.actors.filter(function(t){return t.id!==e.id}),this.removeActorFromMap(e),console.log("remove actor"),this.draw()}},{key:"initialize",value:function(e){var t=this;this.engine.game=this,this.engine.actors.forEach(function(e){e.game=t}),this.show(),this.createLevel(),this.draw(),e.current.focus(),this.initializeMode()}}]),e}(),Me=function(e,t){if(!t.isRunning){var n=t.actors[t.currentActor].keymap,r=e.key;if(!(r in n))return;n[r].activate(),t.start()}};var Le=function(e){var t=e.color;return t||(t="grey"),a.a.createElement("button",{onClick:e.onClick,className:"btn ".concat(t," darken-3")},e.children)},Ge=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return a.a.createElement("div",{className:"Information UI"},a.a.createElement("div",{className:"flow-text"},"Information"),this.props.data&&this.props.data.map(function(e,t){return a.a.createElement(Le,{key:t,color:e.color,onClick:function(){return null}},"".concat(e.label,": ").concat(e.value))}))}}]),t}(a.a.Component),qe=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return a.a.createElement("div",{className:"Equipment UI"},a.a.createElement("div",{className:"flow-text"},"Equipment"),this.props.equipment&&this.props.equipment.map(function(e,t){return a.a.createElement(Le,{key:t,onClick:function(){return null}},e.name," ",e.item?e.item.renderer.character:"")}))}}]),t}(a.a.Component),Be=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return a.a.createElement("div",{className:"Inventory UI"},a.a.createElement("div",{className:"flow-text"},"Inventory"),this.props.inventory&&this.props.inventory.map(function(e,t){return a.a.createElement(Le,{key:t,onClick:function(){return null}},t," ",e.name," ",e.renderer.character)}))}}]),t}(a.a.Component),_e=n(16),Ue=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return a.a.createElement("div",{className:"Keymap UI"},a.a.createElement("div",{className:"flow-text"},"Keymap"),this.props.keymap&&Object.entries(this.props.keymap).map(function(e,t){var n=Object(_e.a)(e,2),r=n[0],i=n[1];return a.a.createElement(Le,{key:t,onClick:function(){return null}},r," ",i.label)}))}}]),t}(a.a.Component),He="Kunai",We=function(e){var t=e.engine,n=e.actor,r=e.targetPos,a=e.throwDirection,i=e.speed,c=e.structureType,o=e.createProjectile,s=L[c],u=s.positions.map(function(e){var i={x:n.pos.x+e.x+a.x*s.x_offset,y:n.pos.y+e.y+a.y*s.y_offset},c={x:r.x+e.x,y:r.y+e.y};return o(t,i,c)});return new Ce({game:t.game,passable:!0,speed:i,children:u})},Ke=function(e,t,n){return new De({game:e.game,targetPos:n,passable:!0,pos:{x:t.x,y:t.y},renderer:{character:"\ud83d\udde1\ufe0f",color:"white",background:""},name:He,speed:100,energy:0,range:30})},Ve=function(e,t,n){return new De({game:e.game,targetPos:n,passable:!0,pos:{x:t.x,y:t.y},renderer:{character:"\ud83d\udd25",color:"wheat",background:"tomato"},name:He,speed:100,energy:0,range:30})},Fe=function(e,t){var n=B.filter(function(t){return!Object.keys(e).includes(t)});e[n[0]]=t},ze=function(e,t){var n=e.actors[e.currentActor];e.game.removeActor(n),e.game[t]=null};function Ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ye(n,!0).forEach(function(t){Object(g.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ye(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Qe=function(e){var t=e.actors[e.currentActor];e.game.visibleInventory=t.container;var n=new Ee({initiatedBy:t,pos:Je({},t.pos),renderer:{character:"D",color:"white",background:""},name:"Drop",game:e.game});e.addActorAsPrevious(n),e.setActorToPrevious(n),e.game.placeActorOnMap(n),e.game.draw(),n.keymap=function(e,t){var n={Escape:{activate:function(){return ze(e,"visibleInventory")},label:"Close"}};return t.container.map(function(r,a){var i={activate:null,label:""};return i.activate=function(){console.log("setting action for ".concat(t.name," to drop ").concat(r.name)),t.setNextAction(new ne({item:r,game:e.game,actor:t,energyCost:100})),ze(e,"visibleInventory")},i.label="Drop ".concat(r.name),Fe(n,i),!0}),n}(e,t)};function Xe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function $e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xe(n,!0).forEach(function(t){Object(g.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xe(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Ze=function(e){var t=e.actors[e.currentActor];e.game.visibleEquipment=t.equipment;var n=new Ee({initiatedBy:t,pos:$e({},t.pos),renderer:{character:"E",color:"white",background:""},name:"Equipment",game:e.game});e.addActorAsPrevious(n),e.setActorToPrevious(n),e.game.placeActorOnMap(n),e.game.draw(),n.keymap=function(e,t){var n={Escape:{activate:function(){return ze(e,"visibleEquipment")},label:"Close"}};return t.equipment.filter(function(e){return e.item}).map(function(r){var a={activate:null,label:""};return a.activate=function(){console.log("setting action for ".concat(t.name," to unequip ").concat(r.item.name)),t.setNextAction(new te({item:r.item,game:e.game,actor:t})),ze(e,"visibleEquipment")},a.label="Unequip ".concat(r.name),Fe(n,a),!0}),n}(e,t)};function et(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function tt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?et(n,!0).forEach(function(t){Object(g.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):et(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var nt=function(e){var t=e.actors[e.currentActor];e.game.visibleInventory=t.container;var n=new Ee({initiatedBy:t,pos:tt({},t.pos),renderer:{character:"I",color:"white",background:""},name:"Inventory",game:e.game});e.addActorAsPrevious(n),e.setActorToPrevious(n),e.game.placeActorOnMap(n),e.game.draw(),n.keymap=function(e,t){var n={Escape:{activate:function(){return ze(e,"visibleInventory")},label:"Close"}};return t.container.map(function(r,a){var i={activate:null,label:""};return i.activate=function(){console.log("setting action for ".concat(t.name," to equip ").concat(r.name)),t.setNextAction(new ee({item:r,game:e.game,actor:t})),ze(e,"visibleInventory")},i.label="Equip ".concat(r.name),Fe(n,i),!0}),n}(e,t)},rt=function(e,t){var n=t.actors[t.currentActor],r=n.pos.x+e[0],a=n.pos.y+e[1];n.setNextAction(new ie({targetPos:{x:r,y:a},game:t.game,actor:n,energyCost:0}))};function at(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function it(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?at(n,!0).forEach(function(t){Object(g.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):at(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var ct=function(e,t){var n=e.actors[e.currentActor];n.active=!1;var r={x:Math.sign(n.pos.x-t.pos.x),y:Math.sign(n.pos.y-t.pos.y)};e.game.removeActor(n);var a=function(e){var t=e.engine,n=e.actor,r=e.targetPos,a=e.throwDirection;return We({engine:t,actor:n,targetPos:r,throwDirection:a,speed:500,structureType:"square",createProjectile:Ve})}({engine:e,actor:t,targetPos:it({},n.pos),throwDirection:r});a?(a.pos={x:t.pos.x+r.x,y:t.pos.y+r.y},e.actors.push(a),t.setNextAction(new Z({message:"I'll get you with these kunai!",game:e.game,actor:t,energyCost:100}))):console.log("I have no kunais left")},ot=function(e,t){return{w:{activate:function(){return rt(N.N,e)},label:"move"},d:{activate:function(){return rt(N.E,e)},label:"move"},s:{activate:function(){return rt(N.S,e)},label:"move"},a:{activate:function(){return rt(N.W,e)},label:"move"},t:{activate:function(){return ct(e,t)},label:"Throw Cloud"},y:{activate:function(){return function(e,t){var n=e.actors[e.currentActor];n.active=!1;var r=Math.sign(n.pos.x-t.pos.x),a=Math.sign(n.pos.y-t.pos.y);e.game.removeActor(n);var i=t.contains(He);i?(i.game=e.game,i.pos={x:t.pos.x+r,y:t.pos.y+a},i.targetPos=it({},n.pos),t.removeFromContainer(i),e.actors.push(i),i.createPath(e.game),e.game.placeActorsOnMap(),e.game.draw(),t.setNextAction(new Z({message:"I'll get you with this kunai!",game:e.game,actor:t,energyCost:100}))):console.log("I have no kunais left")}(e,t)},label:"Throw Kunai"}}},st=function(e){var t=e.game,n=e.actors[t.engine.currentActor],r=n.pos,a=new Ee({initiatedBy:n,pos:r,renderer:{character:"\u2588",color:"white",background:""},name:"Cursor",game:t,keymap:ot(e,n)});e.addActorAsPrevious(a),e.setActorToPrevious(a),e.game.placeActorOnMap(a),e.game.draw()},ut=function(e,t){var n=t.actors[t.currentActor],r=n.pos.x+e[0],a=n.pos.y+e[1];n.setNextAction(new ce({targetPos:{x:r,y:a},game:t.game,actor:n,energyCost:100}))},lt=function(e){var t=e.actors[e.currentActor],n=e.game.map[w(t.pos)].entities.filter(function(e){return e.id!==t.id});n.length>0?t.setNextAction(new re({item:k(n),game:e.game,actor:t,energyCost:100})):console.log("nothing to pickup.")};function pt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}var ht=function(e,t,n,r,a){var i=a.actors[a.currentActor];i.setNextAction(new ue({direction:e,stepCount:t,game:a.game,actor:i,additionalAttackDamage:r,energyCost:n,particleTemplate:G.leaf}))},ft=function(e){var t=e.actors[e.currentActor];t.keymap=function(e,t,n){var r=Math.floor(50),a=Math.floor(t.energy/r),i=a,c=function(){return t.keymap=n};return{Escape:{activate:c,label:"Close"},w:{activate:function(){ht(N.N,a,r,i,e),c()},label:"activate N"},d:{activate:function(){ht(N.E,a,r,i,e),c()},label:"activate E"},s:{activate:function(){ht(N.S,a,r,i,e),c()},label:"activate S"},a:{activate:function(){ht(N.W,a,r,i,e),c()},label:"activate W"}}}(e,t,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pt(n,!0).forEach(function(t){Object(g.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pt(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},t.keymap))},yt=function e(t){var n=t.game,r=t.actor,a=t.name,i=void 0===a?"Effect":a,c=t.lifespan,s=void 0===c?100:c,u=t.stepInterval,l=void 0===u?100:u,p=t.allowDuplicates,h=void 0===p||p,f=t.onStart,y=void 0===f?function(){return null}:f,g=t.onStep,v=void 0===g?function(){return null}:g,m=t.onStop,b=void 0===m?function(){return null}:m;Object(o.a)(this,e),this.game=n,this.actor=r,this.name=i,this.lifespan=s,this.timeToLive=s,this.stepInterval=l,this.allowDuplicates=h,this.timeSinceLastStep=0,this.onStart=y,this.onStep=v,this.onStop=b},gt=function(e,t){var n=t.actors[t.currentActor],r=Object(v.a)(e);if(Math.random()<.5){console.log("drunk misstep");for(var a=100;e[0]===r[0]&&e[1]===r[1]||a<0;)a-=1,e=N[k(Object.keys(N))];console.log(a)}var i=n.pos.x+e[0],c=n.pos.y+e[1];n.setNextAction(new ce({targetPos:{x:i,y:c},game:t.game,actor:n,energyCost:100}))};function vt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}var mt=new T({}),bt=function(e){var t=new Ae({pos:{x:23,y:7},renderer:{character:"R",color:"#e6e6e6",background:"#36635b"},name:"Rock Lee",actions:[],speed:400,durability:3,keymap:function(e){return{w:{activate:function(){return ut(N.N,e)},label:"walk"},d:{activate:function(){return ut(N.E,e)},label:"walk"},s:{activate:function(){return ut(N.S,e)},label:"walk"},a:{activate:function(){return ut(N.W,e)},label:"walk"},l:{activate:function(){return ft(e)},label:"Flying Lotus"},k:{activate:function(){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:600,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=e.actors[e.currentActor],a=new yt({game:e.game,actor:r,name:"Removed wraps (weights)",lifespan:1e3,stepInterval:100,allowDuplicates:!1,onStart:function(){r.speed+=t,r.attackDamage=Math.max(0,r.attackDamage-n),r.energy+=t,r.renderer.character="\u3023",console.log("".concat(r.name," removed weighted wraps."))},onStop:function(){r.speed-=t,r.attackDamage+=n,r.renderer.character="R",console.log("".concat(r.name," rewrapped weights."))}});r.setNextAction(new $({effect:a,actor:r,game:e.game,particleTemplate:{renderer:{color:"#424242",background:"#e6e6e6",character:"\u3023"}}}))}(e,200)},label:"Remove wraps"},j:{activate:function(){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=e.actors[e.currentActor],r=new yt({game:e.game,actor:n,name:"Drunk",lifespan:1e3,stepInterval:100,allowDuplicates:!1,onStart:function(){n.attackDamage+=t,n.renderer.character="?",console.log("".concat(n.name," took a sip of sake.")),n.keymap.w={activate:function(){return gt(N.N,e)},label:"drunken walk"},n.keymap.a={activate:function(){return gt(N.W,e)},label:"drunken walk"},n.keymap.s={activate:function(){return gt(N.S,e)},label:"drunken walk"},n.keymap.d={activate:function(){return gt(N.E,e)},label:"drunken walk"}},onStop:function(){n.attackDamage-=t,n.renderer.character="R",console.log("".concat(n.name," recovered from drunkeness.")),n.keymap.w={activate:function(){return ut(N.N,e)},label:"walk"},n.keymap.a={activate:function(){return ut(N.W,e)},label:"walk"},n.keymap.s={activate:function(){return ut(N.S,e)},label:"walk"},n.keymap.d={activate:function(){return ut(N.E,e)},label:"walk"}}});n.setNextAction(new $({effect:r,actor:n,game:e.game,processDelay:100,particleTemplate:{renderer:{color:"#c45ffd",background:"#424242",character:"?"}}}))}(e)},label:"Sip Sake"},h:{activate:function(){return function(e){var t=e.actors[e.currentActor],n=[{x:t.pos.x-1,y:t.pos.y},{x:t.pos.x-1,y:t.pos.y-1},{x:t.pos.x,y:t.pos.y-1},{x:t.pos.x+1,y:t.pos.y-1},{x:t.pos.x+1,y:t.pos.y},{x:t.pos.x+1,y:t.pos.y+1},{x:t.pos.x,y:t.pos.y+1},{x:t.pos.x-1,y:t.pos.y+1}];t.setNextAction(new pe({targetPositions:n,game:e.game,actor:t,energyCost:800,particleTemplate:G.leaf}))}(e)},label:"Leaf Whirlwind"},o:{activate:function(){return function(e){var t=e.actors[e.currentActor],n=t.setNextGate();if(n){var r=new yt({game:e.game,actor:t,name:n.name,lifespan:-1,stepInterval:100,allowDuplicates:!1,onStart:function(){t.speed+=n.speedBuff,t.energy+=n.speedBuff,t.attackDamage+=n.damageBuff,console.log("".concat(t.name," opened the ").concat(n.name,"."));var e=t.getNextGate();e?t.keymap.o.label=e.name:delete t.keymap.o},onStep:function(){t.decreaseDurability(n.durabilityDebuff),t.decreaseDurability(0),console.log("".concat(t.name," suffers ").concat(n.durabilityDebuff," damage from physical stress."))}});t.setNextAction(new $({effect:r,actor:t,game:e.game,processDelay:25,particleTemplate:{renderer:{color:"#3cc2bb",background:"#24fe88",character:"#"}}}))}}(e)},label:"Gate of Opening"},i:{activate:function(){return nt(e)},label:"Open Inventory"},q:{activate:function(){return Ze(e)},label:"Open Equipment"},g:{activate:function(){return Qe(e)},label:"Drop Item"},p:{activate:function(){return lt(e)},label:"Pickup"},t:{activate:function(){return st(e)},label:"Throw"},y:{activate:function(){return Se(e.game)},label:"Add NPC"}}}(e)});return t.container=Object(v.a)(Array(10).fill("").map(function(){return Ke(e,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vt(n,!0).forEach(function(t){Object(g.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vt(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},t.pos))})),t}(mt);mt.actors.push(bt);var dt=new Re({engine:mt}),Ot=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={game:dt},n.presserRef=a.a.createRef(),n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=Object(d.a)(b.a.mark(function e(){var t=this;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:dt.initialize(this.presserRef),dt.updateReact=function(e){t.setState({game:e})},mt.start();case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t,n,r=this,i=(this.state.game.engine.actors[this.state.game.engine.currentActor],[{label:"Wave",value:this.state.game.mode.data.level}]);return i=i.concat(Object(v.a)(this.state.game.engine.actors.map(function(e,t){var n=Object(g.a)({label:e.name,value:t},"value","HP: ".concat(e.durability,", En/Sp: ").concat(e.energy,"/").concat(e.speed));return t===r.state.game.engine.currentActor&&(n.color="red"),n}))),a.a.createElement("div",{className:"Level"},a.a.createElement("div",{className:"flow-text"},"Chunin Exams"),a.a.createElement("button",{className:"btn",onClick:function(){return r.props.setActiveScreen(y.TITLE)}},"Quit"),a.a.createElement("div",{className:"row"},a.a.createElement(Ge,{data:i}),a.a.createElement(qe,{equipment:this.state.game.visibleEquipment}),a.a.createElement(Be,{inventory:this.state.game.visibleInventory}),a.a.createElement(Ue,{keymap:this.state.game.visibleKeymap}),(e=this.presserRef,t=Me,n=mt,a.a.createElement("div",{id:"display",ref:e,onKeyDown:function(e){return t(e,n)},tabIndex:"0"}))))}}]),t}(a.a.Component),jt=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return a.a.createElement("div",{className:"Title"},a.a.createElement("div",{style:{width:"100vw",height:"100vh",backgroundColor:"#e2e2e2"}},a.a.createElement("div",{class:"flow-text"},"Hidden Leaf RL"),a.a.createElement("button",{class:"btn",onClick:function(){return e.props.setActiveScreen(y.LEVEL)}},"Play")))}}]),t}(a.a.Component),kt=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).call(this))).state={activeScreen:y.LEVEL},e}return Object(p.a)(t,e),Object(s.a)(t,[{key:"setActiveScreen",value:function(e){this.setState({activeScreen:e})}},{key:"getActiveScreen",value:function(){var e=a.a.createElement(jt,{key:y.TITLE,setActiveScreen:this.setActiveScreen.bind(this)}),t=a.a.createElement(Ot,{key:y.LEVEL,setActiveScreen:this.setActiveScreen.bind(this)});switch(this.state.activeScreen){case y.TITLE:return e;case y.LEVEL:return t;default:return e}}},{key:"render",value:function(){var e=this.getActiveScreen();return a.a.createElement("div",{className:"Nystrum"},a.a.createElement(f.a,{transitionName:"fade",transitionAppear:!0,transitionEnter:!0,transitionLeave:!0,transitionAppearTimeout:500,transitionEnterTimeout:500,transitionLeaveTimeout:300},e))}}]),t}(a.a.Component),wt=function(e,t){for(var n in e){var r=n.split(","),a=parseInt(r[0]),i=parseInt(r[1]),c=e[n],o={GROUND:{background:"#974",foreground:"#aaa",character:".",passable:!0}}[c.type],s=o.character,u=o.foreground,l=o.background;if(c.entities.length>0){var p=c.entities[c.entities.length-1];s=p.components.renderer.character,u=p.components.renderer.color,p.components.renderer.background&&(l=p.components.renderer.background)}t.draw(a,i,s,u,l)}},xt=function(e){return"".concat(e.x,",").concat(e.y)},Et=function(e){return e.filter(function(e){return e.components.hasOwnProperty("impasse")&&!e.components.impasse.passable})},Pt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return new Promise(function(t){return setTimeout(t,e)})};function At(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Dt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?At(n,!0).forEach(function(t){Object(g.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):At(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Ct=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Empty",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0,a={id:e,name:t,components:n,world:r,sendEvent:function(e,t,n){return Tt(e,t,n,r)}};return a},Tt=function(){var e=Object(d.a)(b.a.mark(function e(){var t,n,r,a,i,c,o,s=arguments;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=s.length>0&&void 0!==s[0]?s[0]:null,n=s.length>1&&void 0!==s[1]?s[1]:null,r=s.length>2&&void 0!==s[2]?s[2]:null,a=s.length>3&&void 0!==s[3]?s[3]:null,i=!1,e.t0=b.a.keys(t.components);case 6:if((e.t1=e.t0()).done){e.next=19;break}if(c=e.t1.value,!(o=t.components[c]).hasOwnProperty(n)){e.next=17;break}if(console.log("SUCCESSFUL EVENT: ",n),i=!0,"PREPARE_RENDER"===n){e.next=15;break}return e.next=15,Pt();case 15:o[n](Dt({},r,{self:t,component:o})),wt(a.map,a.display);case 17:e.next=6;break;case 19:i||console.log("FAILED EVENT");case 20:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();function St(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function It(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?St(n,!0).forEach(function(t){Object(g.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):St(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Nt=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{passable:e,MAKE_PASSABLE:function(e){e.component.passable=!0},MAKE_IMPASSABLE:function(e){e.component.passable=!1}}},Rt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0};return e?{pos:t,MOVE:function(t){var n=t.self,r=t.component,a=t.currentPos,i=t.targetPos;if(e.canOccupy(e.map,i)){r.pos=i;var c=e.map[xt(a)];e.map[xt(a)]=It({},c,{entities:[]}),n.sendEvent(n,"PREPARE_RENDER")}else console.log("can't move there")}}:(console.log("No world to occupy"),{})},Mt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return{durability:t,DECREASE_DURABILITY:function(e){var t=e.self,n=e.component,r=e.value;n.durability-=r,n.durability<=0&&t.sendEvent(t,"DESTROY")},INCREASE_DURABILITY:function(e){var t=e.component,n=e.value;t.durability+=n},DESTROY:function(t){var n=t.self,r=(t.component,t.value,e.map[xt(n.components.body.pos)]);e.map[xt(n.components.body.pos)].entities=r.entities.filter(function(e){return e.id!==n.id})}}},Lt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"white",r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return{character:t,color:n,background:r,PREPARE_RENDER:function(t){var n=t.self;n.components.hasOwnProperty("body")&&e.map[xt(n.components.body.pos)].entities.push(n)}}};function Gt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function qt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Gt(n,!0).forEach(function(t){Object(g.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gt(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Bt,_t,Ut=new O.g.Simple,Ht={canAct:!0,scheduler:Ut,engine:new O.c(Ut),map:{},display:new O.b({fontSize:24,bg:"#099"}),canOccupy:function(e,t){if(!e.hasOwnProperty(xt(t)))return!1;var n=e[xt(t)];return!(!{GROUND:{background:"#974",foreground:"#aaa",character:".",passable:!0}}[n.type].passable||0!==Et(n.entities).length)||void 0}},Wt=qt({},Ct(1,"Naruto",{reciever:(Bt={x:10,y:30},{responded:!1,RECIEVE:function(e){var t=e.self,n=e.component,r=e.message;console.log(r,Bt.x,Bt.y),n.responded||(n.responded=!0,t.sendEvent(e.sender,"hello","RECIEVE",{message:"copy",sender:t}))}}),body:Rt(Ht,{x:19,y:21}),renderer:Lt(Ht,"N","orange","black")},Ht)),Kt=qt({},Ct(2,"Box",{body:Rt(Ht,{x:22,y:21}),renderer:Lt(Ht,"#","black"),impasse:Nt(),destructible:Mt(Ht)},Ht)),Vt=qt({},Ct(2,"Box",{body:Rt(Ht,{x:22,y:19}),renderer:Lt(Ht,"#","black"),impasse:Nt(),destructible:Mt(Ht)},Ht)),Ft=qt({},Ct(2,"Box",{body:Rt(Ht,{x:22,y:17}),renderer:Lt(Ht,"#","black"),impasse:Nt(),destructible:Mt(Ht)},Ht)),zt=qt({},Ct(3,"Kunai",{body:Rt(Ht,{x:20,y:21}),renderer:Lt(Ht,"<>","black"),destructible:Mt(Ht),attack:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return{damage:e}}(),throwable:(_t=Ht,{THROW:function(e){var t=e.self,n=(e.component,e.direction),r=t.components.body.pos,a={x:r.x+n.x,y:r.y+n.y},i=_t.map[xt(a)];if(_t.canOccupy(_t.map,a))t.sendEvent(t,"MOVE",{currentPos:r,targetPos:a}),t.sendEvent(t,"THROW",{direction:n});else{if(_t.map.hasOwnProperty(xt(a))){var c=Et(i.entities).filter(function(e){return e.components.hasOwnProperty("destructible")});c.length>0&&t.sendEvent(c[0],"DECREASE_DURABILITY",{value:1})}t.sendEvent(t,"DECREASE_DURABILITY",{value:1})}}})},Ht)),Yt=(a.a.Component,function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return a.a.createElement("div",{className:"App container-fluid"},a.a.createElement(kt,null))}}]),t}(a.a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(a.a.createElement(Yt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},74:function(e,t,n){}},[[123,1,2]]]);
//# sourceMappingURL=main.89f0095c.chunk.js.map